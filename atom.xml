<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ã€‡</title>
  
  <subtitle>ä¸–ç•Œçš„æœ¬è´¨å³æ˜¯æ— é™çš„å¾ªç¯</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://rootreturn0.github.io/"/>
  <updated>2019-11-12T06:42:56.847Z</updated>
  <id>http://rootreturn0.github.io/</id>
  
  <author>
    <name>rootReturn0</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>è¿”å›é¡¶éƒ¨</title>
    <link href="http://rootreturn0.github.io/2019/11/12/%E8%BF%94%E5%9B%9E%E9%A1%B6%E9%83%A8/"/>
    <id>http://rootreturn0.github.io/2019/11/12/è¿”å›é¡¶éƒ¨/</id>
    <published>2019-11-12T05:50:12.000Z</published>
    <updated>2019-11-12T06:42:56.847Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡å‚è€ƒ<a href="http://yearito.cn/posts/hexo-theme-beautify.html" target="_blank" rel="noopener">yearito</a>çš„åšå®¢ã€‚</p><p>æœ€ç»ˆåœ¨åšå®¢ä¸­äº§ç”Ÿäº†è«åèŒçš„æ•ˆæœï¼ˆ</p><p>&lt;img src=&quot;è¿”å›é¡¶éƒ¨/DogAndCat.png&quot; width=&quot;100&quot; /&gt;</p><h2>ä¸‹è½½å›¾ç‰‡</h2><p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¯ä¸‹è½½æœ¬ç«™ä½¿ç”¨çš„å›¾ç‰‡ã€‚</p><p>&lt;a class=&quot;btn&quot; href=&quot;//rootreturn0.github.io/images/scroll.png&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;i class=&quot;fa fa-download fa-fw&quot;&gt;&lt;/i&gt;ä¸‹è½½å›¾ç‰‡&lt;/a&gt;</p><blockquote><p>å®é™…ä¸Šä»€ä¹ˆå›¾ç‰‡éƒ½å¯ä»¥ï¼Œæ”¾åˆ° <code>source\images\</code> ç›®å½•ä¸‹å³å¯</p></blockquote><h2>ä»£ç </h2><p>ç„¶ååœ¨è‡ªå®šä¹‰æ ·å¼æ–‡ä»¶ <code>themes\next\source\css\_custom\custom.styl</code> ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//è‡ªå®šä¹‰å›åˆ°é¡¶éƒ¨æ ·å¼</span><br><span class="line"><span class="selector-class">.back-to-top</span> &#123;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">60px</span>;</span><br><span class="line">  width: 70px;  //å›¾ç‰‡ç´ æå®½åº¦</span><br><span class="line">  height: 900px;  //å›¾ç‰‡ç´ æé«˜åº¦</span><br><span class="line">  <span class="selector-tag">top</span>: <span class="selector-tag">-900px</span>;</span><br><span class="line">  <span class="selector-tag">bottom</span>: <span class="selector-tag">unset</span>;</span><br><span class="line">  <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> <span class="selector-class">.5s</span> <span class="selector-tag">ease-in-out</span>;</span><br><span class="line">  background: url("/images/scroll.png");</span><br><span class="line"></span><br><span class="line">  //éšè—ç®­å¤´å›¾æ ‡</span><br><span class="line">  &gt; <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.back-to-top-on</span> &#123;</span><br><span class="line">    <span class="attribute">bottom</span>: unset;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">100vh</span> &lt; (<span class="number">900px</span> + <span class="number">200px</span>) ? <span class="built_in">calc</span>( 100vh - 900px - 200px ) : <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      ä¿®æ”¹è¿”å›é¡¶éƒ¨æ ·å¼ä¸ºçŒ«çŒ«ğŸ±
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>Androidå­¦ä¹ ç¬”è®°_UI</title>
    <link href="http://rootreturn0.github.io/2019/10/20/Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UI/"/>
    <id>http://rootreturn0.github.io/2019/10/20/Androidå­¦ä¹ ç¬”è®°-UI/</id>
    <published>2019-10-20T07:05:32.000Z</published>
    <updated>2019-10-20T11:14:09.078Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬”è®°åŸºäº<a href="https://me.csdn.net/sinyu890807" target="_blank" rel="noopener">éƒ­éœ–å¤§ç¥</a>æ‰€è‘—çš„<a href="https://blog.csdn.net/guolin_blog/article/details/52032038" target="_blank" rel="noopener">ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬äºŒç‰ˆ</a>ä¹‹ç¬¬3ç« ã€‚è¯¥ç³»åˆ—ç¬”è®°ä¸»è¦ç›®çš„åœ¨äºå¿«é€Ÿå¼€å‘ï¼Œéœ€è¦æ·±å…¥ç†è§£åŸç†æˆ–æŒæ¡æ›´å¤šæŠ€å·§å¯é˜…è¯»åŸè‘—ã€‚</p><p>&lt;!--more--&gt;</p><h1>æ§ä»¶</h1><p>Android ä¸­æ‰€æœ‰çš„æ§ä»¶éƒ½å…·æœ‰<code>android:layout_width</code>å’Œ<code>android:layout_height</code>è¿™ä¸¤ä¸ªå±æ€§ã€‚å¯é€‰å€¼ï¼š</p><ul><li>match_parent(fill_parent): ä¸çˆ¶å¸ƒå±€å¤§å°ä¸€æ ·</li><li>wrap_content: æ­£å¥½åŒ…ä½é‡Œé¢çš„å†…å®¹</li></ul><h2>æœªå®Œå¾…ç»­</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç¬”è®°åŸºäº&lt;a href=&quot;https://me.csdn.net/sinyu890807&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éƒ­éœ–å¤§ç¥&lt;/a&gt;æ‰€è‘—çš„&lt;a href=&quot;https://blog.csdn.net/guolin_blog/articl
      
    
    </summary>
    
      <category term="Android" scheme="http://rootreturn0.github.io/categories/Android/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>è¯„è®ºåŠŸèƒ½</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD/"/>
    <id>http://rootreturn0.github.io/2019/10/19/è¯„è®ºåŠŸèƒ½/</id>
    <published>2019-10-19T13:15:15.000Z</published>
    <updated>2019-10-19T13:22:36.202Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¸»é¢˜é…ç½®æ–‡ä»¶</h1><p>ğŸ”—<a href="https://valine.js.org/" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><p>é¦–å…ˆåœ¨<a href="https://leancloud.cn" target="_blank" rel="noopener">leancloud</a>æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚æ‰“å¼€<code>yourblog</code>-&gt;<code>themes</code>-&gt;<code>next</code>-&gt;<code>_config.yml</code>ï¼Œå°†è·å¾—çš„ appid å’Œ appkey å¡«å…¥ä¸‹æ–¹ä»£ç å¯¹åº”ä½ç½®ï¼Œenable æ”¹ä¸º trueã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Valine.</span></span><br><span class="line"><span class="comment"># You can get your appid and appkey from https://leancloud.cn</span></span><br><span class="line"><span class="comment"># more info please open https://valine.js.org</span></span><br><span class="line"><span class="attr">valine:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  appid:</span> <span class="string">yourid</span></span><br><span class="line"><span class="attr">  appkey:</span> <span class="string">yourkey</span></span><br><span class="line"><span class="attr">  notify:</span> <span class="literal">false</span> <span class="comment"># mail notifier , https://github.com/xCss/Valine/wiki</span></span><br><span class="line"><span class="attr">  verify:</span> <span class="literal">false</span> <span class="comment"># Verification code</span></span><br><span class="line"><span class="attr">  placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> <span class="comment"># comment box placeholder</span></span><br><span class="line"><span class="attr">  avatar:</span> <span class="string">mm</span> <span class="comment"># gravatar style</span></span><br><span class="line"><span class="attr">  guest_info:</span> <span class="string">nick,mail,link</span> <span class="comment"># custom comment header</span></span><br><span class="line"><span class="attr">  pageSize:</span> <span class="number">10</span> <span class="comment"># pagination size</span></span><br></pre></td></tr></table></figure></p><h1>é‚®ä»¶æ¨é€</h1><p>é…ç½®è¯·å‚ç…§<a href="https://cloud.tencent.com/developer/article/1142500" target="_blank" rel="noopener">ä½œè€…æ–‡æ¡£</a></p>]]></content>
    
    <summary type="html">
    
      åŸºäºValineåœ¨åšæ–‡åº•éƒ¨å¢åŠ è¯„è®ºåŠŸèƒ½
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“èµåŠŸèƒ½</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E6%89%93%E8%B5%8F/"/>
    <id>http://rootreturn0.github.io/2019/10/19/æ‰“èµ/</id>
    <published>2019-10-19T13:06:15.000Z</published>
    <updated>2019-10-19T13:14:51.160Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¸»é¢˜é…ç½®æ–‡ä»¶</h1><p>nextä¸»é¢˜ä¸­å†…ç½®äº†è¿™ä¸€åŠŸèƒ½ï¼Œæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œå°†å¦‚ä¸‹éƒ¨åˆ†æ³¨é‡Šå–æ¶ˆï¼š</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reward</span></span><br><span class="line"><span class="attr">reward_comment:</span> <span class="string">å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥è¯·æˆ‘å–æ¯å’–å•¡ï½</span></span><br><span class="line"><span class="attr">wechatpay:</span> <span class="string">/images/wechatpay.png</span></span><br><span class="line"><span class="attr">alipay:</span> <span class="string">/images/alipay.png</span></span><br><span class="line"><span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œåªç”¨åˆ°äº†å¾®ä¿¡å’Œæ”¯ä»˜å®ã€‚å°†æ”¶æ¬¾ç å›¾ç‰‡æ”¾å…¥<code>yourblog</code>-&gt;<code>themes</code>-&gt;<code>next</code>-&gt;<code>source</code>-&gt;<code>images</code>ï¼Œå‘½ååŒä¸Šã€‚</p><h1>æ ·å¼</h1><p>å¦‚æœç›´æ¥é‡‡ç”¨ä»å¾®ä¿¡å’Œæ”¯ä»˜å®ä¿å­˜ä¸‹æ¥çš„æ”¶æ¬¾ç ï¼Œå°†ä¼šäº§ç”Ÿä¸Šä¸‹ä¸å¯¹ç§°çš„æƒ…å†µï¼Œä¸”äºŒè€…å¤§å°ä¸ä¸€ã€‚è¿™é‡Œé‡‡ç”¨äº†ç®€å•ç²—æš´çš„å¤„ç†åŠæ³•ï¼š</p><ol><li>å°†å›¾ç‰‡è¦ä¿ç•™çš„å†…å®¹è£å‰ªæˆæ­£æ–¹å½¢ã€‚</li><li>æ‰“å¼€<code>yourblog</code>-&gt;<code>themes</code>-&gt;<code>next</code>-&gt;<code>source</code>-&gt;<code>css</code>-&gt;<code>_common</code>-&gt;<code>components</code>-&gt;<code>post</code>-&gt;<code>post-reward.styl</code>ï¼Œå°†é‡Œé¢çš„<code>#QR img</code>å—æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š</li></ol><p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#QR</span> img&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">180px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">180px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0.8em</span> <span class="number">2em</span> <span class="number">0</span> <span class="number">2em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      åœ¨æ–‡ç« æœ«å°¾å¢åŠ æ‰“èµæŒ‰é’®
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>ä¸Šä¼ æœ¬åœ°å›¾ç‰‡</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E4%B8%8A%E4%BC%A0%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87/"/>
    <id>http://rootreturn0.github.io/2019/10/19/ä¸Šä¼ æœ¬åœ°å›¾ç‰‡/</id>
    <published>2019-10-18T17:48:13.000Z</published>
    <updated>2019-10-18T17:55:45.562Z</updated>
    
    <content type="html"><![CDATA[<h1>å®‰è£…æ’ä»¶</h1><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d ä½ çš„hexoæ ¹ç›®å½•</span><br><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure></p><h1>ä¿®æ”¹é…ç½®æ–‡ä»¶</h1><p>æ‰“å¼€æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="attr">http://yourname.github.io</span></span><br></pre></td></tr></table></figure></p><h1>æ’å…¥å›¾ç‰‡</h1><p>è¿è¡Œ <code>hexo n &quot;yourblogname&quot;</code> ç”Ÿæˆåšæ–‡æ—¶ï¼Œ/source/_posts ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ªä¸ md åŒåçš„æ–‡ä»¶å¤¹ï¼Œå°†å›¾ç‰‡æ”¾äººè¯¥æ–‡ä»¶å¤¹ã€‚</p><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨![](yourblogname/picture.jpg)æ’å…¥å›¾ç‰‡å³å¯ã€‚</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      åœ¨å†™blogæ—¶æ’å…¥æœ¬åœ°å›¾ç‰‡ï¼Œå¹¶ä¸Šä¼ æ˜¾ç¤º
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>å¢åŠ é¡µé¢</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E5%A2%9E%E5%8A%A0%E9%A1%B5%E9%9D%A2/"/>
    <id>http://rootreturn0.github.io/2019/10/19/å¢åŠ é¡µé¢/</id>
    <published>2019-10-18T17:46:34.000Z</published>
    <updated>2019-10-18T17:57:34.098Z</updated>
    
    <content type="html"><![CDATA[<h1>æ ‡ç­¾</h1><p><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E6%A0%87%E7%AD%BE%E4%BA%91%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener">ğŸ”—å®˜æ–¹é“¾æ¥</a></p><p>æ–°å»ºä¸€ä¸ªé¡µé¢</p><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure></p><p>ç¼–è¾‘æ–°å»ºç•Œé¢ï¼Œå°†é¡µé¢ç±»å‹è®¾ç½®ä¸º tags ï¼Œä¸»é¢˜å°†ä¼šåœ¨è¿™ä¸ªé¡µé¢ä¸Šæ˜¾ç¤ºæ ‡ç­¾äº‘ã€‚</p><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Tags</span><br><span class="line">date: 2019-10-19 01:26:01</span><br><span class="line">type: "tags"</span><br><span class="line">---</span><br></pre></td></tr></table></figure></p><p>å»é™¤ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.yml</code> ä¸­ tags çš„æ³¨é‡Šã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">  home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">  tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">  categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">  archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure></p><h2>æ ‡ç­¾çš„ä½¿ç”¨</h2><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tags: xxx</span><br></pre></td></tr></table></figure></p><p>æˆ–</p><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tags:</span><br><span class="line"><span class="bullet">- </span>xxx</span><br><span class="line"><span class="bullet">- </span>xxx</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ—¶ï¼Œä¸ºå¹¶åˆ—æ ‡ç­¾ï¼Œæ— ç­‰çº§åŒºåˆ†ã€‚</p><h1>åˆ†ç±»</h1><p><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E5%88%9B%E5%BB%BA%E5%88%86%E7%B1%BB%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener">ğŸ”—å®˜æ–¹é“¾æ¥</a></p><p>æ–°å»ºä¸€ä¸ªé¡µé¢</p><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure></p><p>ç¼–è¾‘æ–°å»ºç•Œé¢ï¼Œå°†é¡µé¢ç±»å‹è®¾ç½®ä¸º categories ï¼Œä¸»é¢˜å°†ä¼šåœ¨è¿™ä¸ªé¡µé¢ä¸Šæ˜¾ç¤ºæ‰€æœ‰çš„åˆ†ç±»ã€‚</p><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Categories</span><br><span class="line">date: 2019-10-19 01:26:08</span><br><span class="line">type: "categories"</span><br><span class="line">---</span><br></pre></td></tr></table></figure></p><p>å»é™¤ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.yml</code> ä¸­ categories çš„æ³¨é‡Šã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">  home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">  tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">  categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">  archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure></p><h2>åˆ†ç±»çš„ä½¿ç”¨</h2><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">categories: xxx</span><br></pre></td></tr></table></figure></p><p>æˆ–</p><p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">categories:</span><br><span class="line"><span class="bullet">- </span>xxx</span><br><span class="line"><span class="bullet">- </span>xxx</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ—¶ï¼Œå¹¶éå¹¶åˆ—åˆ†ç±»ï¼Œè€Œæ˜¯åˆ†çº§åˆ†ç±»ã€‚å…¶ä¸­è¶Šé å‰çš„è¶Šé«˜çº§ã€‚</p>]]></content>
    
    <summary type="html">
    
      æ–°å»ºç•Œé¢ï¼Œè§£å†³è·³è½¬tagsç­‰404é—®é¢˜
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>Androidå­¦ä¹ ç¬”è®°_Activity</title>
    <link href="http://rootreturn0.github.io/2019/10/18/Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Activity/"/>
    <id>http://rootreturn0.github.io/2019/10/18/Androidå­¦ä¹ ç¬”è®°-Activity/</id>
    <published>2019-10-18T14:07:48.000Z</published>
    <updated>2019-10-19T14:51:36.903Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬”è®°åŸºäº<a href="https://me.csdn.net/sinyu890807" target="_blank" rel="noopener">éƒ­éœ–å¤§ç¥</a>æ‰€è‘—çš„<a href="https://blog.csdn.net/guolin_blog/article/details/52032038" target="_blank" rel="noopener">ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬äºŒç‰ˆ</a>ä¹‹ç¬¬2ç« ã€‚è¯¥ç³»åˆ—ç¬”è®°ä¸»è¦ç›®çš„åœ¨äºå¿«é€Ÿå¼€å‘ï¼Œéœ€è¦æ·±å…¥ç†è§£åŸç†æˆ–æŒæ¡æ›´å¤šæŠ€å·§å¯é˜…è¯»åŸè‘—ã€‚</p><p>å…¶ä¸­ï¼š</p><ul><li>ä½¿ç”¨çš„IDEï¼šAndroid Studio</li><li>ç¤ºä¾‹é¡¹ç›®åï¼šActivityTest</li><li>åŒ…åï¼šâ€œcom.example.avtivitytestâ€</li></ul><p>&lt;!--more--&gt;</p><h1>æ‰‹åŠ¨åˆ›å»ºæ´»åŠ¨</h1><p><em>æ–°å»ºé¡¹ç›®æ—¶é€‰æ‹©<code>Add No Activity</code></em></p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/åˆå§‹é¡¹ç›®ç»“æ„.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>åˆå§‹æ–‡ä»¶ç»“æ„&lt;/center&gt;</p><p>å³å‡»<code>com.example.activitytest</code>åŒ…-&gt;<code>New</code>-&gt;<code>Activity</code>-&gt;<code>Empty Activity</code>ï¼Œä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œå…¶ä¸­ Generate LayoutFile ä¼šåœ¨<code>app/src/main/res</code>ç›®å½•ä¸­ä¸ºè¯¥æ´»åŠ¨è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ layout çš„ xml æ–‡ä»¶ï¼›Launcher Activity ä¼šå°†è¯¥æ´»åŠ¨è®¾ç½®ä¸ºç¨‹åºè¿è¡Œæ—¶é¦–å…ˆåŠ è½½çš„æ´»åŠ¨ï¼Œå³å½“å‰é¡¹ç›®çš„ä¸»æ´»åŠ¨ã€‚</p><h1>åˆ›å»ºå’ŒåŠ è½½å¸ƒå±€</h1><p>å³å‡»<code>app/src/main/res</code>ç›®å½•-&gt;<code>New</code>-&gt;<code>Directory</code>ï¼Œå¯åˆ›å»ºä¸€ä¸ªåä¸º layout çš„ç›®å½•ï¼Œè€Œåå³å‡»è¯¥ç›®å½•ï¼Œå³å¯æ–°å»ºå¸ƒå±€æ–‡ä»¶ã€‚</p><h2>æ·»åŠ æŒ‰é’®</h2><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button_1"</span> // å®šä¹‰<span class="attr">id</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span> // è¡¨ç¤ºå’Œçˆ¶å…ƒç´ ä¸€æ ·å®½</span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> // è¡¨ç¤ºå½“å‰å…ƒç´ çš„é«˜åº¦æ°å¥½åŒ…å«é‡Œé¢å†…å®¹</span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button_1"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2>åŠ è½½</h2><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.activitytest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="comment">// æœ¬è¡Œå°†layoutçš„idä¼ å…¥ï¼Œä¸ºå½“å‰æ´»åŠ¨åŠ è½½å¸ƒå±€</span></span><br><span class="line">        setContentView(R.layout.thirt_layout); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2>åœ¨AndroidManifestæ–‡ä»¶æ³¨å†Œ</h2><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"com.example.activitytest"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">"@mipmap/ic_launcher_round"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">".FirstActivity"</span> // æŒ‡å®šæ³¨å†Œæ´»åŠ¨ </span></span><br><span class="line"><span class="tag">            <span class="attr">android:label</span>=<span class="string">"This is FirstActivity"</span> &gt;</span> // æŒ‡å®šæ´»åŠ¨æ ‡é¢˜æ å†…å®¹</span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">            // ä»¥ä¸‹ä¸¤è¡Œå°†æ´»åŠ¨é…ç½®ä¸ºä¸»æ´»åŠ¨</span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2>ToaståŠæŒ‰é’®å“åº”</h2><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Toast.makeText(FirstActivity.<span class="keyword">this</span>, <span class="string">"You clicked Button_1!"</span>,</span><br><span class="line">                    Toast.LENGTH_SHORT).show();            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ findViewById() æ–¹æ³•è·å–åˆ°å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰çš„å…ƒç´ ï¼Œè¿™é‡Œä¼ å…¥ R.id.button_1 æ¥å¾—åˆ°æŒ‰é’®çš„å®ä¾‹ï¼Œè€Œåæ³¨å†Œç›‘å¬å™¨ã€‚</p><p>Toast ä¸­ makeText æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ Contextï¼ˆæ´»åŠ¨æ˜¯ä¸€ç§ä¸Šä¸‹æ–‡ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ Toast æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æŒç»­æ—¶é•¿ã€‚æ³¨æ„ï¼Œåªæœ‰åŠ ä¸Šåé¢çš„ .show() ï¼ŒToast æ‰ä¼šæ˜¾ç¤ºã€‚</p><h2>Menu</h2><p>ä½¿ç”¨ Android æä¾›çš„æ–¹å¼åˆ›å»ºèœå•ã€‚èœå•é€šè¿‡åº”ç”¨å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹çš„å°æŒ‰é’®ï¼Œä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºã€‚</p><h3>åˆ›å»ºèœå•</h3><p>å³å‡»<code>app/src/main/res</code>ç›®å½•-&gt;<code>New</code>-&gt;<code>Directory</code>ï¼Œåˆ›å»ºåä¸º menu çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º main çš„èœå•æ–‡ä»¶ï¼ˆå³å‡»<code>menu</code>-&gt;<code>New</code>-&gt;<code>Menu resource file</code>ï¼‰ã€‚</p><p>åœ¨<code>main.xml</code>æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@+id/add_item"</span>// æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"Add"</span> // åç§°</span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@+id/remove_item"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"Remove"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­<code>item</code>æ ‡ç­¾ç”¨æ¥åˆ›å»ºå…·ä½“çš„èœå•é¡¹ã€‚</p><p>è€Œååœ¨<code>FirstActivity</code>ä¸­é‡å†™å‡½æ•°ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span></span>&#123;</span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºèµ„æºæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªæŒ‡å®šæ·»åŠ åˆ°çš„Menuå¯¹è±¡</span></span><br><span class="line">    getMenuInflater().inflate(R.menu.main, menu); </span><br><span class="line">    <span class="comment">// è¡¨ç¤ºæ˜¯å¦å…è®¸æ˜¾ç¤ºèœå•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>èœå•å“åº”</h3><p>åœ¨<code>FirstActivity</code>ä¸­é‡å†™å‡½æ•°ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(@NonNull MenuItem item)</span> </span>&#123;</span><br><span class="line"><span class="comment">// åˆ¤æ–­ç‚¹å‡»çš„èœå•é¡¹</span></span><br><span class="line">    <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">        <span class="keyword">case</span> R.id.add_item:</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">"You clicked Add"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> R.id.remove_item:</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">"You clicked Remove"</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2>é”€æ¯æ´»åŠ¨</h2><p>åœ¨æ¨¡æ‹Ÿå™¨ä¸­æŒ‰ä¸‹ Back é”®ï¼Œæˆ–è°ƒç”¨<code>finish()</code>æ–¹æ³•ã€‚</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            finish()            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1>ä½¿ç”¨Intentåˆ‡æ¢æ´»åŠ¨</h1><h2>æ˜¾å¼Intent</h2><p>åˆ›å»ºç¬¬äºŒä¸ªæ´»åŠ¨ï¼Œåä¸º SecondActivityã€‚</p><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¼ å…¥ FirstActivity.this ä½œä¸ºä¸Šä¸‹æ–‡ï¼ŒSecondActivity.classä¸ºç›®æ ‡æ´»åŠ¨</span></span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2>éšå¼Intent</h2><p>é€šè¿‡<code>AndroidManifest.xml</code>ä¸­çš„<code>activity</code>æ ‡ç­¾ä¸‹é…ç½®<code>&lt;intent-filter&gt;</code>å†…å®¹ï¼Œå¯ä»¥æŒ‡å®šå½“å‰æ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ action å’Œ categoryã€‚åªæœ‰<code>&lt;action&gt;</code>å’Œ<code>&lt;category&gt;</code>ä¸­çš„å†…å®¹èƒ½å¤ŸåŒæ—¶åŒ¹é… Intent æŒ‡å®šçš„å†…å®¹æ—¶ï¼Œæ´»åŠ¨æ‰èƒ½å“åº”ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".SecondActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.ACTION_START"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.example.activitytest.ACTION_START"</span>);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>å¢åŠ Category</h3><p>åœ¨<code>AndroidManifest</code>ä¸­é…ç½®å¦‚ä¸‹ï¼š</p><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".SecondActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.ACTION_START"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">        // ä¸æ·»åŠ ä¸‹è¡Œä»£ç å°†å¯¼è‡´ç¨‹åºå´©æºƒ</span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.MY_CATEGORY"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.example.activitytest.ACTION_START"</span>);</span><br><span class="line">            intent.addCategory(<span class="string">"com.example.activitytest.MY_CATEGORY"</span>);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2>å…¶ä»–Intentç”¨æ³•</h2><h3>å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åº</h3><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šâ€œhttp://â€ ä¸èƒ½çœç•¥</span></span><br><span class="line">            intent.setData(Uri.parse(<span class="string">"http://ww.baidu.com"</span>));</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶ç‚¹å‡»æŒ‰é’®å¯è·³è½¬è‡³æµè§ˆå™¨æ‰“å¼€ &quot;www.baidu.com&quot;ã€‚</p><p>åœ¨<code>AndroidManifest</code>ä¸­çš„<code>&lt;intent-filter&gt;</code>æ ‡ç­¾é…ç½®<code>&lt;data&gt;</code>æ ‡ç­¾ï¼Œå¯æŒ‡å®šæ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ç±»å‹æ•°æ®ã€‚<code>&lt;data&gt;</code>æ ‡ç­¾ä¸»è¦å¯é…ç½®ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>android:scheme åè®®ï¼Œå¦‚ http</li><li>android:host ä¸»æœºå</li><li>android:port ç«¯å£</li><li>android:path ä»¥ä¸Šä¹‹åçš„éƒ¨åˆ†</li><li>android:mimeType å¯å¤„ç†çš„æ•°æ®ç±»å‹</li></ul><p>ç¤ºä¾‹ï¼š</p><p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".ThirdActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.VIEW"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:scheme</span>=<span class="string">"http"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å½“å‰æ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ action æ˜¯ Intent.ACTION_VIEW çš„å¸¸é‡å€¼ï¼Œæ•°æ®åè®®å¿…é¡»æ˜¯ httpã€‚åœ¨ç‚¹å‡»æŒ‰é’®åï¼Œè¯¥æ´»åŠ¨ä¹Ÿèƒ½å“åº”Intentï¼š</p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/é€‰æ‹©å“åº”Intentçš„ç¨‹åº.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>é€‰æ‹©å“åº”Intentçš„ç¨‹åº&lt;/center&gt;</p><p><strong>ä»ç”¨æˆ·ä½“éªŒçš„è§’åº¦æ¥çœ‹ï¼Œå¦‚æœæ´»åŠ¨æœ¬èº«ä¸å…·å¤‡åŠ è½½å¹¶æ˜¾ç¤ºçš„ç½‘é¡µçš„åŠŸèƒ½ï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆç”¨å•Šï¼ï¼ï¼</strong></p><p>é™¤ http åè®®å¤–ï¼Œè¿˜æœ‰è®¸å¤š Uri åè®®ï¼Œå¸¸ç”¨çš„ Uri åè®®è§ <a href="https://blog.csdn.net/sinat_38239454/article/details/78937999" target="_blank" rel="noopener">&lt;&lt;Android å¸¸ç”¨URI å€¼å¾—è®°ä½&gt;&gt;</a>ã€‚</p><h2>ä¼ é€’æ•°æ®</h2><p>Intent ä¸­æä¾›äº†ä¸€ç³»åˆ— <code>putExtra()</code> æ–¹æ³•çš„é‡è½½ï¼Œå¯ä»¥å°†æƒ³è¦ä¼ é€’çš„æ•°æ®æš‚å­˜åœ¨ Intent ä¸­ã€‚å½“å¯åŠ¨å¦ä¸€ä¸ª Intent åï¼Œåªéœ€è¦æŠŠè¿™äº›æ•°æ®å†ä» Intent ä¸­å–å‡ºå³å¯ã€‚</p><h3>å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®</h3><p>å‡è®¾ FirstActivity ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç°åœ¨æƒ³æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¼ é€’åˆ° SecondActivity ä¸­ï¼Œå¯ä»¥è¿™æ ·ç¼–å†™ä»£ç ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        String data = <span class="string">"Hello SecondActivity"</span>;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”®ï¼Œç”¨äºä¹‹åå–å€¼ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦ä¼ é€’çš„æ•°æ®</span></span><br><span class="line">        intent.putExtra(<span class="string">"extra_data"</span>,data);</span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>SecondActivity ä¸­æ¥æ”¶ä»£ç ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_second);</span><br><span class="line">        <span class="comment">// è·å–ç”¨äºå¯åŠ¨ SecondActivity çš„Intent</span></span><br><span class="line">        Intent intent = getIntent();</span><br><span class="line">        <span class="comment">/** </span></span><br><span class="line"><span class="comment">         * getStringExtra() è·å–å­—ç¬¦ä¸²æ•°æ®ï¼›</span></span><br><span class="line"><span class="comment">         * å¦‚æœæ˜¯æ•´å‹æ•°æ®åˆ™ç”¨ getIntExtra()ï¼›</span></span><br><span class="line"><span class="comment">         * å¦‚æœæ˜¯å¸ƒå°”æ•°æ®åˆ™ç”¨ getBooleanExtra()ï¼›</span></span><br><span class="line"><span class="comment">         * ä»¥æ­¤ç±»æ¨ã€‚</span></span><br><span class="line"><span class="comment">         * /</span></span><br><span class="line"><span class="comment">        String data = intent.getStringExtra("extra_data");</span></span><br><span class="line"><span class="comment">        Log.d("SecondActivity",data);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure></p><h3>è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨</h3><p>Activity ä¸­è¿˜æœ‰ä¸€ä¸ª<code>startActivityForResult()</code>æ–¹æ³•ä¹Ÿå¯ä»¥å¯åŠ¨æ´»åŠ¨ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ–¹æ³•æœŸæœ›åœ¨æ´»åŠ¨é”€æ¯æ—¶èƒ½è¿‡è¿”å›ç»“æœç»™<strong>ä¸Šä¸€ä¸ªæ´»åŠ¨</strong>ã€‚è¦æƒ³è¿”å›æ•°æ®ï¼Œåˆ™éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">"extra_data"</span>,data);</span><br><span class="line">        <span class="comment">/** </span></span><br><span class="line"><span class="comment">         * ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯intentï¼›</span></span><br><span class="line"><span class="comment">         * ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯·æ±‚ç ï¼Œç”¨äºåœ¨ä¹‹åçš„å›è°ƒä¸­åˆ¤æ–­æ•°æ®çš„æ¥æºï¼Œ</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚ç åªè¦æ˜¯ä¸€ä¸ªå”¯ä¸€å€¼å°±è¡Œã€‚</span></span><br><span class="line"><span class="comment">         * /</span></span><br><span class="line"><span class="comment">        startActivityForResult(intent, 1);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;);</span></span><br></pre></td></tr></table></figure></p><p>åœ¨<strong>ä¸‹ä¸€ä¸ªæ´»åŠ¨</strong>ä¸­ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><ul><li>æŒ‰ä¸‹æŒ‰é’®è¿”å›æ—¶</li></ul><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">button2.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        intent.putExtra(<span class="string">"data_return"</span>,<span class="string">"Hello FirstActivity"</span>);</span><br><span class="line">        setResult(RESULT_OK,intent);</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">```    </span><br><span class="line"></span><br><span class="line">* æŒ‰ä¸‹ Back é”®è¿”å›æ—¶</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBackPressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.putExtra(<span class="string">"data_return"</span>,<span class="string">"Hello FirstActivity"</span>);</span><br><span class="line">setResult(RESULT_OK, intent);</span><br><span class="line">finish();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­<code>setResult</code>ååˆ†é‡è¦ï¼Œæ˜¯ä¸“é—¨ç”¨äºå‘ä¸Šä¸€ä¸ªæ´»åŠ¨è¿”å›æ•°æ®çš„ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºå‘ä¸Šä¸€ä¸ªæ´»åŠ¨è¿”å›å¤„ç†ç»“æœï¼Œä¸€èˆ¬åªä½¿ç”¨ RESULT_OK æˆ– RESULT_CANCELED è¿™ä¸¤ä¸ªå€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°åˆ™æŠŠå¸¦æœ‰æ•°æ®çš„Intentä¼ é€’å›å»ã€‚</p><p>å½“ä½¿ç”¨<code>startActivityForResult()</code>æ–¹æ³•å¯åŠ¨ä¸‹ä¸€ä¸ªæ´»åŠ¨æ—¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªæ´»åŠ¨è¢«é”€æ¯ä¼šå›è°ƒä¸Šä¸€ä¸ªæ´»åŠ¨çš„<code>onActivityResult</code>æ–¹æ³•ï¼Œå› æ­¤éœ€è¦<strong>åœ¨ä¸Šä¸€ä¸ªæ´»åŠ¨é‡å†™<code>onActivityResult</code>æ–¹æ³•</strong> æ¥è·å–æ•°æ®ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (requestCode)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> (resultCode==RESULT_OK)&#123;</span><br><span class="line">                String returnedData=data.getStringExtra(<span class="string">"data_return"</span>);</span><br><span class="line">                Log.d(<span class="string">"FirstActivity"</span>, returnedData);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯åŠ¨æ´»åŠ¨æ—¶ä¼ å…¥çš„è¯·æ±‚ç ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¿”å›æ•°æ®æ—¶ä¼ å…¥çš„å¤„ç†ç»“æœï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæºå¸¦ç€è¿”å›æ•°æ®çš„ Intentã€‚ç”±äºå®é™…ä½¿ç”¨æ—¶å¯èƒ½å¯åŠ¨ä¸æ­¢ä¸€ä¸ªæ´»åŠ¨ï¼Œæ•…ä½¿ç”¨ requestCode æ¥ç¡®å®šä¼ å›çš„æ´»åŠ¨ï¼ŒresultCode æ¥åˆ¤æ–­å¤„ç†ç»“æœæ˜¯å¦æˆåŠŸï¼Œæœ€åä» data å–å€¼ã€‚</p><h1>æ´»åŠ¨çš„ç”Ÿå‘½å‘¨æœŸä¸ä¸´æ—¶æ•°æ®</h1><h2>æ´»åŠ¨çš„ç”Ÿå­˜æœŸ</h2><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/æ´»åŠ¨çš„ç”Ÿå­˜æœŸ.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>æ´»åŠ¨çš„ä¸ƒå¤§ç”Ÿå­˜æœŸ&lt;/center&gt;</p><h2>ä¿å­˜æ´»åŠ¨çš„ä¸´æ—¶æ•°æ®</h2><p>å½“å†…å­˜ä¸è¶³æˆ–ç”±äºå…¶ä»–ä»€ä¹ˆåŸå› å¯¼è‡´æ´»åŠ¨è¢«å›æ”¶æ—¶ï¼Œæ´»åŠ¨ä¸­çš„ä¸´æ—¶æ•°æ®å°±å¯èƒ½æ¶ˆå¤±ï¼Œå½±å“ç”¨æˆ·ä½“éªŒæˆ–ç¨‹åºç®¡ç†ã€‚ä»¥ä¸‹ä»‹ç»åœ¨æ´»åŠ¨è¢«é”€æ¯åé‡æ–°åˆ›å»ºä¿ç•™æ•°æ®çš„æ–¹æ³•ï¼š</p><h3>ä¿å­˜</h3><p>Activity ä¸­æä¾›äº†åä¸º<code>onSaveInstanceState()</code>çš„å›è°ƒæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¿è¯æ´»åŠ¨åœ¨è¢«å›æ”¶ä¹‹å‰ä¸€å®šä¼šè¢«è°ƒç”¨ã€‚æ–¹æ³•ä¸­æºå¸¦çš„ Bundle ç±»å‹çš„å‚æ•°æä¾›äº†<code>putString()</code>å’Œ<code>putInt()</code>ç­‰æ–¹æ³•ä¿å­˜æ•°æ®ã€‚</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(Bundle outState)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>.onSaveInstanceState(outState);</span><br><span class="line">String tempData = <span class="string">"Something you just typed"</span>;</span><br><span class="line">outState.putString(<span class="string">"data_key"</span>, tempData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>æ¢å¤æ•°æ®</h3><p><code>onCreate()</code>æ–¹æ³•æœ¬èº«å¸¦æœ‰ Bundle ç±»å‹çš„å‚æ•°ã€‚å¦‚æœæ´»åŠ¨è¢«å›æ”¶å‰ä¿å­˜è¿‡æ•°æ®ï¼Œåˆ™è¿™ä¸ªå‚æ•°ä¸ä¼šä¸º<code>null</code>ï¼Œè€Œæ˜¯å¸¦æœ‰ä¹‹å‰çš„æ•°æ®ã€‚å› æ­¤ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°å¯ä»¥å–å‡ºä¹‹å‰ä¿å­˜çš„æ•°æ®ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">setContentView(R.layout.activity_main);</span><br><span class="line"><span class="comment">// å¦‚æœä¿å­˜è¿‡æ•°æ®</span></span><br><span class="line"><span class="keyword">if</span> (savedInstanceState != <span class="keyword">null</span>) &#123;</span><br><span class="line">String tempData = savedInstanceState.getString(<span class="string">"data_key"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Â·Â·Â·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em>Tipsï¼šIntentå¯ä»¥ç»“åˆBundleä¸€èµ·ä¼ é€’æ•°æ®ã€‚å¦‚ï¼šæ•°æ®-&gt;Bundle-&gt;Intentã€‚</em></p><h1>æ´»åŠ¨çš„å¯åŠ¨æ¨¡å¼</h1><p>æ´»åŠ¨çš„å¯åŠ¨æ¨¡å¼ä¸€å…±æœ‰4ç§ï¼šstandardã€singleTopã€singleTaskå’ŒsingleInstanceã€‚å¯ä»¥åœ¨ <code>AndroidManifest.xml</code>ä¸­é€šè¿‡ç»™<code>&lt;activity&gt;</code>æ ‡ç­¾æŒ‡å®š<code>android:launchMode</code>æ¥é€‰æ‹©å¯åŠ¨æ¨¡å¼ã€‚</p><h2>standard</h2><p>standard æ˜¯æ´»åŠ¨çš„é»˜è®¤å¯åŠ¨æ¨¡å¼ã€‚å¯¹äºè¯¥æ¨¡å¼çš„æ´»åŠ¨ï¼Œç³»ç»Ÿåœ¨æ¯æ¬¡åˆ›å»ºè¯¥æ´»åŠ¨æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/standard.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>standard æ¨¡å¼ç¤ºæ„å›¾&lt;/center&gt;</p><h2>singleTop</h2><p>å¯¹äºè¯¥æ¨¡å¼çš„æ´»åŠ¨ï¼Œè‹¥è¯¥æ´»åŠ¨å·²å¤„äºæ´»åŠ¨æ ˆçš„æ ˆé¡¶ï¼Œåˆ™ç³»ç»Ÿè®¤ä¸ºå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼›å¦åˆ™ç³»ç»Ÿå°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ã€‚</p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/singleTop.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>singleTop æ¨¡å¼ç¤ºæ„å›¾&lt;/center&gt;</p><h2>singleTask</h2><p>å¯¹äºè¯¥æ¨¡å¼çš„æ´»åŠ¨ï¼Œè‹¥è¯¥æ´»åŠ¨å·²å­˜åœ¨äºæ´»åŠ¨çš„è¿”å›æ ˆä¸­ï¼Œåˆ™ç³»ç»Ÿç›´æ¥ä½¿ç”¨ï¼Œå¹¶æŠŠåœ¨è¿™ä¸ªæ´»åŠ¨ä¹‹ä¸Šçš„æ‰€æœ‰æ´»åŠ¨ç»Ÿç»Ÿå‡ºæ ˆï¼Œä¸ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼›å¦åˆ™ç³»ç»Ÿå°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ã€‚</p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/singleTask.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>singleTask æ¨¡å¼ç¤ºæ„å›¾&lt;/center&gt;</p><h2>singleInstance</h2><p>å¯¹äºè¯¥æ¨¡å¼çš„æ´»åŠ¨ï¼Œä¼šæœ‰ä¸€ä¸ªå•ç‹¬çš„è¿”å›æ ˆæ¥ç®¡ç†è¿™ä¸ªæ´»åŠ¨ï¼Œæ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½å°†å…±ç”¨è¯¥è¿”å›æ ˆã€‚è¯¥æ¨¡å¼å¯è§£å†³ä¸åŒåº”ç”¨ç¨‹åºé—´å…±äº«æ´»åŠ¨å®ä¾‹çš„é—®é¢˜ã€‚</p><p>&lt;center&gt;&lt;img src=&quot;Androidå­¦ä¹ ç¬”è®°-Activity/singleInstance.png&quot; width=&quot;400&quot; hegiht=&quot;600&quot; align=center /&gt;</p><p>singleInstance æ¨¡å¼ç¤ºæ„å›¾&lt;/center&gt;</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç¬”è®°åŸºäº&lt;a href=&quot;https://me.csdn.net/sinyu890807&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éƒ­éœ–å¤§ç¥&lt;/a&gt;æ‰€è‘—çš„&lt;a href=&quot;https://blog.csdn.net/guolin_blog/articl
      
    
    </summary>
    
      <category term="Android" scheme="http://rootreturn0.github.io/categories/Android/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Haydn</title>
    <link href="http://rootreturn0.github.io/2019/10/08/Haydn/"/>
    <id>http://rootreturn0.github.io/2019/10/08/Haydn/</id>
    <published>2019-10-07T18:12:49.000Z</published>
    <updated>2019-10-18T17:10:41.363Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶å¹¶éæ¬¢å¿«åœ°è·³è·ƒç€çš„ã€‚</p><p>ä½†å´ä¾æ—§èˆ’ç¼“äººç–²æƒ«çš„å¿ƒçµã€‚</p><p>éå±±æ²³å£®é˜”ï¼Œ</p><p>éäººé—´æ˜Ÿç«ï¼Œ</p><p>éå¤©å¤–é£ä»™ã€‚</p><p>è€Œæ˜¯æµæ·Œåœ¨æ˜¥å¤©çš„ç”Ÿæ­»æ˜ç­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ‰æ—¶å¹¶éæ¬¢å¿«åœ°è·³è·ƒç€çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†å´ä¾æ—§èˆ’ç¼“äººç–²æƒ«çš„å¿ƒçµã€‚&lt;/p&gt;
&lt;p&gt;éå±±æ²³å£®é˜”ï¼Œ&lt;/p&gt;
&lt;p&gt;éäººé—´æ˜Ÿç«ï¼Œ&lt;/p&gt;
&lt;p&gt;éå¤©å¤–é£ä»™ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæ˜¯æµæ·Œåœ¨æ˜¥å¤©çš„ç”Ÿæ­»æ˜ç­ã€‚&lt;/p&gt;

      
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>H</title>
    <link href="http://rootreturn0.github.io/2019/10/07/H/"/>
    <id>http://rootreturn0.github.io/2019/10/07/H/</id>
    <published>2019-10-07T09:33:27.000Z</published>
    <updated>2019-10-18T17:56:40.503Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚" />    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      A normal dream
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>R</title>
    <link href="http://rootreturn0.github.io/2019/10/07/C/"/>
    <id>http://rootreturn0.github.io/2019/10/07/C/</id>
    <published>2019-10-07T09:28:19.000Z</published>
    <updated>2019-10-18T17:10:32.520Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ›¾ç»æœ€ä½è°·çš„æ—¶å€™ï¼ˆæå°å€¼ï¼‰ï¼Œ</p><p>å¥¹æ¿€åŠ±äº†æˆ‘ï¼›</p><p>åœ¨ç°åœ¨æœ€åº•è°·çš„æ—¶å€™ï¼ˆæå°å€¼ï¼‰ï¼Œ</p><p>å¥¹å®‰æ…°äº†æˆ‘ã€‚</p><p>&lt;br&gt;</p><p>æœç„¶æ˜¯æˆ‘ç”Ÿå‘½ä¸­é‡è¦çš„ä¸€ä¸ªäººï¼ˆç¬‘</p><p>&lt;br&gt;</p><p><strong><em>CAUSE AND CONSEQUENCE</em></strong></p>]]></content>
    
    <summary type="html">
    
      Important one.
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>çŸ¥è¶³å¸¸ä¹</title>
    <link href="http://rootreturn0.github.io/2019/10/07/About%20Alessa0/"/>
    <id>http://rootreturn0.github.io/2019/10/07/About Alessa0/</id>
    <published>2019-10-06T17:42:10.000Z</published>
    <updated>2019-10-18T17:16:31.144Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="English & You" />    <label for="pass">English & You</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Compare
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Soul-like</title>
    <link href="http://rootreturn0.github.io/2019/10/06/soul-like/"/>
    <id>http://rootreturn0.github.io/2019/10/06/soul-like/</id>
    <published>2019-10-05T16:24:23.000Z</published>
    <updated>2019-10-18T17:09:49.729Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚" />    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">U2FsdGVkX19sC0frszlhSKRFAj1FaaIZfH+6JbqDVGUMV7QGJD70aYWAa2sbDNLN5ORdDT/knr/A3oEQ/FkCjOPYO99WLcif8IruuykZ6TgHmSFHdlBXgea43W0Q33b1gZhftPZvvm0n40mLJXkPXJwaLUEfY4EChAYFKe5it2poiIzmHjdhoXadP6stHdih2xiADr7hainx5YYsSipDnz0fTiyH+o+XDt+hToixSkASZC1yI66O/Uko35HWVR/zZPLh8C3hGozz7m9bAiV0lWtm3ioNHeS6zPf7IZwm5j1PWyZL4e1fCuBiMpDdCDV1fZU8wsVsdIJ5U1pl6uSQrJw3UK0sOFuBGRBrnTo9R63jKwi1s2iSCrqnocNeVCz4s25aFBkkQ4hNhWoQg+4Bw/apF0OldQSHhK8lAeg2jmzjGtXkivtEA90dVw5G6avWGh68eW+4KrGl8RUZ3bfXDUFU/D/vcKy21OetrYUarkLeaQwlE5Wzds7ffZeYlZV7g9hIb6fIyAp1oZhNr8AxnasQvg17WFgxJAVmi99f/10YaYNQsAZJ0T1Rf64DF3rz8ybxvVj/M99LKuLzWfzSWqIa4bwUxCIlc6RycYyv5HFsRNDSnpr5Y1tc2BN5dGxeLor5ednw6bbPQoMIYzJshIhDUhLkCWfFc23Hg48kUiFxiBRCbSLGMdyFKVLWLeby</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Ashen one
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>xv6-è°ƒåº¦</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E8%B0%83%E5%BA%A6/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-è°ƒåº¦/</id>
    <published>2019-08-31T10:50:22.000Z</published>
    <updated>2019-10-18T17:14:32.392Z</updated>
    
    <content type="html"><![CDATA[<h2>è°ƒåº¦</h2><p>ç”±äºå¯èƒ½åŒæ—¶æœ‰å¤šä¸ªCPUè¯·æ±‚è¿›è¡Œè°ƒåº¦ï¼Œæ•…éœ€è¦è¿›ç¨‹è¡¨é”<code>ptable.lock</code>æ¥é¿å…ç«äº‰ã€‚</p><p>å› æ­¤ï¼Œè¿›ç¨‹åœ¨è®©å‡ºCPUå‰ï¼Œå¿…é¡»è¦è·å¾—è¿›ç¨‹è¡¨é”ï¼Œå¹¶é‡Šæ”¾å…¶æ‹¥æœ‰çš„å…¶ä»–é”ï¼ˆé¿å…åŒæ—¶æŒæœ‰å¤šä¸ªé”å¯¼è‡´æ­»é”ï¼‰ï¼Œä¿®æ”¹è‡ªå·±çš„çŠ¶æ€<code>proc-&gt;state</code>ï¼Œç„¶åè¿›è¡Œè°ƒåº¦ã€‚</p><h3>å‡½æ•°</h3><p>ä»¥ä¸‹å‡½æ•°ä½äºä»£ç æ–‡ä»¶<code>proc.c</code>ä¸­ã€‚</p><h4>sched</h4><p>è¿›ç¨‹è¿›å…¥è°ƒåº¦å™¨ï¼Œä¸”å¿…é¡»æŒæœ‰è¿›ç¨‹è¡¨é”å¹¶æ”¹å˜è¿›ç¨‹çŠ¶æ€ã€‚ç”±äºè¿›ç¨‹æ­¤æ—¶æŒæœ‰è¿›ç¨‹è¡¨é”ï¼Œæ‰€ä»¥CPUåº”è¯¥æ˜¯åœ¨å…³ä¸­æ–­çš„æƒ…å†µä¸‹è¿è¡Œã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">sched(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> intena;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">proc</span> *<span class="title">p</span> = <span class="title">myproc</span>();</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœªæŒæœ‰è¿›ç¨‹è¡¨é”ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holding(&amp;ptable.lock))</span><br><span class="line">    panic(<span class="string">"sched ptable.lock"</span>);</span><br><span class="line">  <span class="comment">// å¤„äºé”çŠ¶æ€ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(mycpu()-&gt;ncli != <span class="number">1</span>)</span><br><span class="line">    panic(<span class="string">"sched locks"</span>);</span><br><span class="line">  <span class="comment">// è¿›ç¨‹å¤„äºè¿è¡Œæ€ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(p-&gt;state == RUNNING)</span><br><span class="line">    panic(<span class="string">"sched running"</span>);</span><br><span class="line">  <span class="comment">// å¼€ä¸­æ–­ï¼Œä¸å¯æ‰§è¡Œmycpu()å‡½æ•°ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(readeflags()&amp;FL_IF)</span><br><span class="line">    panic(<span class="string">"sched interruptible"</span>);</span><br><span class="line">  intena = mycpu()-&gt;intena; <span class="comment">// æš‚å­˜çŠ¶æ€</span></span><br><span class="line">  swtch(&amp;p-&gt;context, mycpu()-&gt;scheduler); <span class="comment">// ä¿å­˜å½“å‰ä¸Šä¸‹æ–‡ï¼Œå¹¶åˆ‡æ¢åˆ°ä¹‹å‰ä¿å­˜çš„è°ƒåº¦å™¨çš„ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥è°ƒåº¦å™¨</span></span><br><span class="line">  mycpu()-&gt;intena = intena; <span class="comment">// æ¢å¤çŠ¶æ€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>yield</h4><p>åœ¨xv6ä¸­ï¼Œä½¿ç”¨æ—¶é—´ç‰‡è½®è½¬æ³•è¿›è¡Œè°ƒåº¦ã€‚å½“è¿›ç¨‹ç”¨å®Œå®ƒçš„CPUæ—¶é—´ç‰‡æ—¶ï¼Œæ—¶é’Ÿä¸­æ–­ä¼šè°ƒç”¨<code>yield</code>å‡½æ•°æ¥è®©å‡ºCPUç»™æ–°çš„è¿›ç¨‹ï¼Œ<code>yield</code>è°ƒç”¨<code>sched</code>å‡½æ•°ï¼Œ<code>sched</code>è°ƒç”¨<code>swtch</code>æ¥åˆ‡æ¢éƒ½è°ƒåº¦å™¨çº¿ç¨‹ï¼š</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">yield(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  acquire(&amp;ptable.lock);  <span class="comment">//DOC: yieldlock è¯·æ±‚è¿›ç¨‹è¡¨é”</span></span><br><span class="line">  myproc()-&gt;state = RUNNABLE; <span class="comment">// åˆ‡æ¢è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">  sched(); </span><br><span class="line">  release(&amp;ptable.lock); <span class="comment">// é‡Šæ”¾è¿›ç¨‹è¡¨é”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>scheduler</h4><p>æ¯ä¸ªCPUåœ¨è®¾ç½®å®Œæˆè‡ªå·±ä¹‹åè°ƒç”¨<code>scheduler</code>ã€‚</p><p>è°ƒåº¦å™¨<code>scheduler</code>æ°¸è¿œä¸ä¼šè¿”å›ï¼Œè€Œæ˜¯ä¸æ–­å¾ªç¯ã€‚å¾ªç¯æ­¥éª¤ä¸ºï¼š</p><ol><li>é€‰æ‹©è¦è¿è¡Œçš„æµç¨‹</li><li>swtchå¼€å§‹è¿è¡Œè¯¥è¿‡ç¨‹</li><li>æœ€ç»ˆè¯¥è¿‡ç¨‹é€šè¿‡swtchå°†æ§åˆ¶è½¬ç§»å›è°ƒåº¦ç¨‹åºã€‚</li></ol><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">scheduler(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">proc</span> *<span class="title">p</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">cpu</span> *<span class="title">c</span> = <span class="title">mycpu</span>();</span></span><br><span class="line">  c-&gt;proc = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä¸æ–­å¾ªç¯ï¼Œæ°¸ä¸åœæ­¢</span></span><br><span class="line">  <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">    <span class="comment">// å¼€ä¸­æ–­ï¼Œä»¥å…è®¸I/Oåˆ°è¾¾</span></span><br><span class="line">    sti();  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è¿›ç¨‹è¡¨ä¸Šä¸æ–­å¾ªç¯ï¼Œå¯»æ‰¾è¿›ç¨‹å¹¶è¿è¡Œ</span></span><br><span class="line">    acquire(&amp;ptable.lock); <span class="comment">// è¯·æ±‚è¿›ç¨‹è¡¨é”</span></span><br><span class="line">    <span class="keyword">for</span>(p = ptable.proc; p &lt; &amp;ptable.proc[NPROC]; p++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(p-&gt;state != RUNNABLE) <span class="comment">// è¿›ç¨‹ä¸å¯è¿è¡Œï¼Œè½¬åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Switch to chosen process.  It is the process's job</span></span><br><span class="line">      <span class="comment">// to release ptable.lock and then reacquire it</span></span><br><span class="line">      <span class="comment">// before jumping back to us.</span></span><br><span class="line">      <span class="comment">// åˆ‡æ¢åˆ°é€‰å®šçš„è¿›ç¨‹</span></span><br><span class="line">      c-&gt;proc = p;</span><br><span class="line">      switchuvm(p); <span class="comment">// åˆ‡æ¢åˆ°è¯¥è¿›ç¨‹çš„é¡µè¡¨</span></span><br><span class="line">      p-&gt;state = RUNNING;</span><br><span class="line"></span><br><span class="line">      swtch(&amp;(c-&gt;scheduler), p-&gt;context); <span class="comment">// åˆ‡æ¢åˆ°è¯¥è¿›ç¨‹è¿è¡Œ</span></span><br><span class="line">      switchkvm(); <span class="comment">// å½“æ²¡æœ‰è¿›ç¨‹æ­£åœ¨è¿è¡Œæ—¶ï¼Œå°†é¡µè¡¨å¯„å­˜å™¨åˆ‡æ¢åˆ°ä»…å†…æ ¸é¡µè¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// Process is done running for now.</span></span><br><span class="line">      <span class="comment">// It should have changed its p-&gt;state before coming back.</span></span><br><span class="line">      <span class="comment">// è¿›ç¨‹å·²ç»“æŸè¿è¡Œï¼Œæ”¹å˜è‡ªèº«çŠ¶æ€</span></span><br><span class="line">      c-&gt;proc = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    release(&amp;ptable.lock); <span class="comment">// é‡Šæ”¾è¿›ç¨‹è¡¨é”ï¼Œé˜²æ­¢å…¶ä»–CPUæ— æ³•è¿›è¡Œè°ƒåº¦</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>é”ä¸ä¸­æ–­</h3><h4>é”</h4><ul><li>ä¸ºä¿è¯è¿›ç¨‹çŠ¶æ€çš„ä¸Šä¸‹æ–‡åœ¨è¿è¡Œ<code>swtch</code>æ—¶ä¿æŒä¸å˜ï¼šè¿›ç¨‹è¡¨é”ç”±æ—§è¿›ç¨‹è·å¾—ï¼Œæ–°è¿›ç¨‹é‡Šæ”¾ã€‚</li><li>ä¸ºé˜²æ­¢å…¶ä»–CPUé—²ç½®æ—¶é”è¢«å½“å‰CPUå æœ‰è€Œæ— æ³•è°ƒåº¦ï¼Œå…¶ä»–CPUä¸Šè¿è¡Œè¿›ç¨‹æ— æ³•è®©å‡ºCPUï¼Œå¯¼è‡´æ­»é”çš„æƒ…å†µï¼šåœ¨éå†ä¸€æ¬¡è¿›ç¨‹è¡¨åæ€»è¦é‡Šæ”¾é”ã€‚</li></ul><h4>ä¸­æ–­</h4><ul><li>ä¸ºé˜²æ­¢æ‰€æœ‰è¿›ç¨‹éƒ½åœ¨ç­‰å¾…I/Oæ—¶å…³ä¸­æ–­å¯¼è‡´çš„I/Oæ— æ³•åˆ°è¾¾å¼•å‘çš„æ­»é”ï¼Œè°ƒåº¦å™¨åœ¨æ¯æ¬¡å¾ªåå¼€å§‹å‰è¿›è¡Œå¼€ä¸­æ–­ã€‚</li></ul><h2>ç¡çœ ä¸å”¤é†’</h2><p>å‡½æ•°<code>sleep</code>å’Œ<code>wakeup</code>ä½äºä»£ç æ–‡ä»¶<code>proc.c</code>ä¸­ã€‚</p><p>ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ æˆ–è¿›è¡Œå”¤é†’å‡éœ€è¦æ”¹å˜è¿›ç¨‹çŠ¶æ€ï¼Œæ•…éœ€è¦è¿›ç¨‹è¡¨é”ä»¥ä¿è¯çŠ¶æ€ä¿®æ”¹çš„åŸå­æ€§ã€‚å…¶ä¸­å‡½æ•°<code>sleep</code>è¦åœ¨ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ å‰è·å–è¿›ç¨‹è¡¨é”ï¼Œä»¥ä¿è¯åœ¨ä½¿å‡½æ•°è¿›å…¥ç¡çœ æ—¶è‡³å°‘æŒæœ‰ä¸€ä¸ªé”ï¼Œé˜²æ­¢<code>wakeup</code>åœ¨è¿›ç¨‹è¿›å…¥ç¡çœ å‰è¢«è°ƒç”¨å¯¼è‡´çš„æ­»é”ã€‚å½“<code>sleep</code>æœ¬èº«æŒæœ‰çš„é”ä¸ºè¿›ç¨‹è¡¨é”æ—¶ï¼Œåˆ™ç•¥è¿‡è¯·æ±‚è¿™ä¸€æ­¥ï¼Œé˜²æ­¢æ­»é”ã€‚</p><h2>å¯æ”¹è¿›ä¹‹å¤„</h2><h3>è°ƒåº¦</h3><ul><li>è½®è½¬æ³•æ— ä¼˜å…ˆçº§çš„åŒºåˆ†</li></ul><p>ä¼šå¯¼è‡´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹æ— æ³•ä¼˜å…ˆè¿è¡Œï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„å¢åŠ ï¼Œå½±å“ä½¿ç”¨è€…åœ¨å®é™…ä½¿ç”¨æ—¶çš„ä½“éªŒã€‚å¯ä½¿ç”¨å…¶ä»–è¾ƒä¸ºå¤æ‚çš„ç®—æ³•ï¼Œå¦‚é«˜å“åº”æ¯”ä¼˜å…ˆç®—æ³•ç­‰ä»¥æ”¹è¿›ä½“éªŒã€‚</p><h3>ç¡çœ ä¸å”¤é†’</h3><ul><li>å”¤é†’éœ€è¦éå†è¿›ç¨‹è¡¨</li></ul><p>åœ¨è¿›ç¨‹æ•°é‡å¤§çš„æ—¶å€™è¿™ç§åšæ³•æ•ˆç‡æä½ã€‚ä½¿ç”¨å¦ä¸€ä¸ªç»“æ„ä½“æ¥ç»´æŠ¤é“¾è¡¨å¯å¤§å¤§æé«˜æ•ˆç‡ã€‚</p><ul><li>å”¤é†’æ—¶ä¼šå”¤é†’é˜Ÿåˆ—ä¸­å…¨éƒ¨è¿›ç¨‹</li></ul><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŒä¸€æ—¶é—´éœ€è¦å”¤é†’çš„è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¸­æ˜¯å°‘æ•°éƒ¨åˆ†ï¼Œè®¸å¤šä»éœ€ç­‰å¾…çš„è¿›ç¨‹å°†ä¼šè¢«â€œè«åå…¶å¦™â€åœ°å”¤é†’å¹¶å†åº¦æ£€æŸ¥çŠ¶æ€é‡æ–°è¿›å…¥ç¡çœ ï¼Œå¯¼è‡´æ“ä½œç³»ç»Ÿéœ€è¦å¤„ç†è®¸å¤šæ–°çš„ä¸å¿…è¦çš„ä»»åŠ¡ã€‚</p><p>å”¤é†’æ—¶åº”åˆ†ä¸ºä¸ªä½“å”¤é†’ï¼ˆå”¤é†’å•ä¸ªè¿›ç¨‹ï¼‰å’Œç¾¤ä½“å”¤é†’ï¼ˆå”¤é†’æ‰€æœ‰è¿›ç¨‹ï¼‰ï¼Œå‡å°‘ç³»ç»Ÿè´Ÿæ‹…ã€‚</p>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹è°ƒåº¦æºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>xv6-ç®¡é“</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E7%AE%A1%E9%81%93/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-ç®¡é“/</id>
    <published>2019-08-31T00:29:38.000Z</published>
    <updated>2019-10-18T17:14:24.466Z</updated>
    
    <content type="html"><![CDATA[<h2>ç®¡é“</h2><p>ä»ç®¡é“çš„ä¸€ç«¯å†™å…¥æ•°æ®å­—èŠ‚ï¼Œç„¶åæ•°æ®è¢«æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºä¸­ï¼Œæ¥ç€è¿›ç¨‹å°±èƒ½ä»ç®¡é“çš„å¦ä¸€ç«¯è¯»å–æ•°æ®äº†ã€‚</p><p>åœ¨xv6ä¸­ï¼Œç®¡é“ä½¿ç”¨è¢«è¯»å–å­—èŠ‚æ•°<code>nread</code>å’Œè¢«å†™å…¥å­—èŠ‚æ•°<code>nwrite</code>çš„å·®å€¼åˆ¤æ–­ç®¡é“çŠ¶æ€ï¼š</p><ul><li>nwrite == nread åˆ™æ•°æ®æœªå†™å…¥æˆ–è¢«è¯»å–å®Œæ¯•ï¼Œç®¡é“ç©º</li><li>nwrite == nread + PIPESIZE åˆ™ç®¡é“æ»¡</li></ul><p>ç”±äºç®¡é“çš„è¯»å–ä¸å†™å…¥å‡éœ€è¦ä½¿ç”¨<code>nread</code>å’Œ<code>nwrite</code>ä»¥è·æ‚‰ç®¡é“çŠ¶æ€ï¼Œæ•…è¿™ä¸¤ä¸ªè®¡æ•°å‚æ•°ä¸èƒ½åœ¨æŸä¸€å‡½æ•°ï¼ˆå†™å…¥/è¯»å–ï¼‰æ¸…é›¶ï¼Œå¦åˆ™å°†å½±å“å¦ä¸€å‡½æ•°ï¼ˆè¯»å–/å†™å…¥ï¼‰çš„æ‰§è¡Œã€‚å› æ­¤ï¼Œxv6ä¸­ä½¿ç”¨<code>data[nread % PIPESIZE]</code>å’Œ<code>data[nwrite % PIPESIZE]</code>æ¥æ§åˆ¶è¯»å†™æ—¶çš„ç®¡é“æ•°æ®åç§»ï¼Œå³å¾ªç¯å†™/è¯»ï¼Œåœ¨<code>data[PIPESIZE-1]</code>åå†™å…¥çš„æ•°æ®å­˜æ”¾åœ¨<code>data[0]</code>ä¸­ã€‚</p><h3>æ•°æ®ç»“æ„</h3><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">spinlock</span> <span class="title">lock</span>;</span> <span class="comment">// é”</span></span><br><span class="line">  <span class="keyword">char</span> data[PIPESIZE]; <span class="comment">// ç®¡é“æ•°æ®</span></span><br><span class="line">  uint nread;     <span class="comment">// è¢«è¯»å–å­—èŠ‚æ•°ï¼Œä»ç¼“å†²åŒºä¸­è¯»å–</span></span><br><span class="line">  uint nwrite;    <span class="comment">// è¢«å†™å…¥å­—èŠ‚æ•°ï¼Œå†™å…¥ç¼“å†²åŒº</span></span><br><span class="line">  <span class="keyword">int</span> readopen;   <span class="comment">// è¯»æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦ä¾æ—§å¤„äºopençŠ¶æ€</span></span><br><span class="line">  <span class="keyword">int</span> writeopen;  <span class="comment">// å†™æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦ä¾æ—§å¤„äºopençŠ¶æ€</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h3>ç®¡é“å‡½æ•°</h3><p>ä»¥ä¸‹åˆ†æç®¡é“è¯»å†™å‡½æ•°ï¼Œå…¶ä»–å‡½æ•°ä»…åˆ—å‡ºå‡½æ•°ä½œç”¨ï¼Œè¯¦ç»†æ³¨é‡Šè§ä»£ç æ–‡ä»¶<code>pipe.c</code>ã€‚</p><h4>è¯»å†™</h4><p>ç®¡é“è¯»å†™æ“ä½œé€šè¿‡ç®¡é“é”å®ç°äº’æ–¥ï¼Œæ“ä½œè¿è¡Œæ—¶å¿…é¡»æŒæœ‰ç®¡é“é”ã€‚</p><p>ç®¡é“æ•°æ®å†™å…¥æ—¶é¦–å…ˆè·å–ç®¡é“é”è€Œåå†™å…¥æ•°æ®ï¼Œè‹¥è¾¾åˆ°ç®¡é“å®¹é‡ä¸Šé™ï¼Œåˆ™å†™æ“ä½œå”¤é†’è¯»æ“ä½œåè¿›å…¥ç¡çœ ç­‰å¾…å¹¶é‡Šæ”¾ç®¡é“é”ã€‚æ­¤æ—¶è¯»æ“ä½œå¯è·å¾—è¯·æ±‚çš„ç®¡é“é”ï¼Œåœ¨è¯»å–å®Œæ•°æ®åç®¡é“å˜ç©ºï¼Œåˆ™è¯»æ“ä½œå”¤é†’å†™æ“ä½œåè¿›å…¥ç¡çœ ç­‰å¾…å¹¶é‡Šæ”¾ç®¡é“é”ã€‚è€Œåç®¡é“å†™æ“ä½œå†æ¬¡è·å¾—ç®¡é“é”ï¼Œå¾ªç¯å¾€å¤ç›´è‡³æ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œå…¶ä¸­æœ€åä¸€æ¬¡ä¼ è¾“å¯èƒ½æœªå†™æ»¡ç®¡é“ã€‚</p><p>å½“ä½¿ç”¨ç®¡é“çš„æ“ä½œè¢«æ€åï¼Œç®¡é“è¯»å†™æ“ä½œéƒ½å°†ç»ˆæ­¢ï¼›å½“ç®¡é“ä¸å¯è¯»æ—¶ï¼Œç®¡é“å†™æ“ä½œå°†è¢«ç»ˆæ­¢ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®¡é“å†™</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">pipewrite(struct pipe *p, <span class="keyword">char</span> *addr, <span class="keyword">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">  acquire(&amp;p-&gt;lock); <span class="comment">// è¯·æ±‚è·å¾—ç®¡é“é”ï¼Œä»¥ä¿æŠ¤è®¡æ•°å™¨ã€æ•°æ®ä»¥åŠç›¸å…³ä¸å˜é‡</span></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(p-&gt;nwrite == p-&gt;nread + PIPESIZE)&#123;  <span class="comment">// ç®¡é“æ»¡</span></span><br><span class="line">      <span class="comment">// å¦‚æœç®¡é“æ–‡ä»¶ä¸å¯è¯»æˆ–è¿›ç¨‹è¢«æ€ï¼Œé‡Šæ”¾ç®¡é“é”å¹¶ç»ˆæ­¢ç®¡é“å†™æ“ä½œ</span></span><br><span class="line">      <span class="keyword">if</span>(p-&gt;readopen == <span class="number">0</span> || myproc()-&gt;killed)&#123;</span><br><span class="line">        release(&amp;p-&gt;lock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      wakeup(&amp;p-&gt;nread); <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„è¯»è€…ç¼“å†²åŒºä¸­æœ‰æ•°æ®å¯è¯»</span></span><br><span class="line">      sleep(&amp;p-&gt;nwrite, &amp;p-&gt;lock);  <span class="comment">// ç®¡é“å†™æ“ä½œè¿›å…¥ç¡çœ ç­‰å¾…ï¼ˆç¡çœ æ—¶å°†é‡Šæ”¾ç®¡é“é”ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;data[p-&gt;nwrite++ % PIPESIZE] = addr[i]; <span class="comment">// å°†æ‰€éœ€è¯»å–çš„å—å†…æ•°æ®èµ‹å€¼ç»™ç®¡é“æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line">  wakeup(&amp;p-&gt;nread);  <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„è¯»è€…ç¼“å†²åŒºä¸­æœ‰æ•°æ®å¯è¯»</span></span><br><span class="line">  release(&amp;p-&gt;lock); <span class="comment">// é‡Šæ”¾ç®¡é“é”</span></span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç®¡é“è¯»</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">piperead(struct pipe *p, <span class="keyword">char</span> *addr, <span class="keyword">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">  acquire(&amp;p-&gt;lock); <span class="comment">// è¯·æ±‚è·å¾—ç®¡é“é”ï¼Œä»¥ä¿æŠ¤è®¡æ•°å™¨ã€æ•°æ®ä»¥åŠç›¸å…³ä¸å˜é‡</span></span><br><span class="line">  <span class="keyword">while</span>(p-&gt;nread == p-&gt;nwrite &amp;&amp; p-&gt;writeopen)&#123;  <span class="comment">//DOC: ç®¡é“ä¸ºç©ºä¸”ç®¡é“å¯å†™ï¼Œåˆ™ç®¡é“è¯»æ“ä½œå¯è¿›å…¥ç¡çœ </span></span><br><span class="line">    <span class="comment">// è¿›ç¨‹è¢«æ€ï¼Œé‡Šæ”¾ç®¡é“é”ï¼Œç»ˆæ­¢ç®¡é“è¯»æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>(myproc()-&gt;killed)&#123;</span><br><span class="line">      release(&amp;p-&gt;lock);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sleep(&amp;p-&gt;nread, &amp;p-&gt;lock); <span class="comment">//DOC: piperead-sleep ç®¡é“è¯»æ“ä½œè¿›å…¥ç¡çœ ç­‰å¾…ï¼ˆç¡çœ æ—¶å°†é‡Šæ”¾ç®¡é“é”ï¼‰</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)&#123;  <span class="comment">// æ‹·è´æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span>(p-&gt;nread == p-&gt;nwrite) <span class="comment">// è¯»å–å­—èŠ‚æ•°ç­‰äºå†™å…¥å­—èŠ‚æ•°ï¼Œè¡¨ç¤ºè¯»å–å®Œæˆ</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    addr[i] = p-&gt;data[p-&gt;nread++ % PIPESIZE]; <span class="comment">// å°†æ‰€éœ€è¯»å–çš„ç®¡é“æ•°æ®èµ‹å€¼ç»™å—å†…æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line">  wakeup(&amp;p-&gt;nwrite);  <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„å†™è€…ç¼“å†²åŒºä¸­å¯å†™</span></span><br><span class="line">  release(&amp;p-&gt;lock);</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>å…¶ä»–</h4><ul><li>pipealloc ç®¡é“åˆ†é…ï¼Œå¹¶åˆå§‹åŒ–ç®¡é“ã€‚</li><li>pipeclose ç®¡é“å…³é—­ã€‚è‹¥è¯»å†™ä¸¤æ–¹å‡å…³é—­ï¼Œåˆ™é‡Šæ”¾å†…å­˜ï¼›å¦åˆ™å…³é—­ç®¡é“ä¸€ç«¯å¹¶å”¤é†’å¦ä¸€æ–¹ã€‚å½“å…³é—­å†™ç«¯æ—¶ï¼Œä»å¯è¿›è¡Œè¯»æ“ä½œï¼Œä½†å°†ç®¡é“å†…å‰©ä½™æ•°æ®è¯»å®Œåï¼Œå†æ¬¡è¿›è¡Œè¯»æ“ä½œä¾¿è¿”å›0ï¼Œç›¸å½“äºè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼›å½“å…³é—­è¯»æ®µæ—¶ï¼Œå†™æ“ä½œä¼šåœ¨è¿›è¡Œè¿‡ç¨‹ä¸­ä¸­æ–­ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹ç®¡é“æºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>xv6-æ–‡ä»¶ç³»ç»Ÿ</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-æ–‡ä»¶ç³»ç»Ÿ/</id>
    <published>2019-08-30T17:47:50.000Z</published>
    <updated>2019-10-18T17:14:13.038Z</updated>
    
    <content type="html"><![CDATA[<h2>æ–‡ä»¶ç³»ç»Ÿæ€»ä½“è®¾è®¡</h2><h3>æ–‡ä»¶ç³»ç»Ÿåˆ†å±‚</h3><p><img src="https://th0ar.gitbooks.io/xv6-chinese/content/pic/f6-1.png" alt="æ–‡ä»¶ç³»ç»Ÿå±‚"></p><p>å¦‚å›¾æ‰€ç¤ºxv6çš„æ–‡ä»¶ç³»ç»Ÿåˆ†6å±‚å®ç°ï¼š</p><ol><li>ç¬¬ä¸€å±‚ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰é€šè¿‡å—ç¼“å†²è¯»å†™ IDE ç¡¬ç›˜ï¼ŒåŒæ­¥å¯¹ç£ç›˜çš„è®¿é—®ï¼Œä¸”é€šè¿‡å—çš„é”ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªå†…æ ¸è¿›ç¨‹å¯ä»¥ä¿®æ”¹ç£ç›˜å—ï¼›</li><li>ç¬¬äºŒå±‚ä½¿å¾—æ›´é«˜å±‚çš„æ¥å£å¯ä»¥å°†å¯¹ç£ç›˜çš„æ›´æ–°æŒ‰ä¼šè¯æ‰“åŒ…ï¼Œé€šè¿‡ä¼šè¯çš„æ–¹å¼æ¥ä¿è¯è¿™äº›æ“ä½œæ˜¯åŸå­æ“ä½œã€‚</li><li>ç¬¬ä¸‰å±‚æä¾›æ— åæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶ç”±ä¸€ä¸ªinodeå’Œä¸€è¿ä¸²çš„æ•°æ®å—ç»„æˆã€‚</li><li>ç¬¬å››å±‚å°†ç›®å½•å®ç°ä¸ºä¸€ç§ç‰¹æ®Šçš„inodeï¼Œå†…å®¹æ˜¯ä¸€è¿ä¸²çš„ç›®å½•é¡¹ï¼Œæ¯ä¸€ä¸ªç›®å½•é¡¹åŒ…å«ä¸€ä¸ªæ–‡ä»¶åå’Œå¯¹åº”çš„inodeã€‚</li><li>ç¬¬äº”å±‚æä¾›äº†å±‚æ¬¡è·¯ç»åï¼ˆå¦‚/xx/xxxï¼‰ï¼Œè¿™ä¸€å±‚é€šè¿‡é€’å½’çš„æ–¹å¼æ¥æŸ¥è¯¢è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ã€‚</li><li>ç¬¬å…­å±‚å°†è®¸å¤šèµ„æºï¼ˆå¦‚ç®¡é“ï¼Œè®¾å¤‡ï¼Œæ–‡ä»¶ç­‰ï¼‰æŠ½è±¡ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„æ¥å£ï¼Œæå¤§åœ°ç®€åŒ–äº†ç¨‹åºå‘˜çš„å·¥ä½œã€‚</li></ol><h3>ç£ç›˜åˆ†å±‚</h3><p>ç£ç›˜åˆ†å±‚ä¸ºå¼•å¯¼å—ã€è¶…çº§å—ã€æ—¥å¿—å—ã€inodeå—ã€ç©ºé—²å—ä½å›¾å’Œæ•°æ®å—ç­‰ã€‚</p><p>æ–‡ä»¶ç³»ç»Ÿä¸ä½¿ç”¨å¼•å¯¼å—ï¼›è¶…çº§å—åŒ…å«äº†æ–‡ä»¶ç³»ç»Ÿçš„å…ƒä¿¡æ¯ï¼›æ—¥å¿—å—ä¸­çš„æ—¥å¿—ç»´æŠ¤äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŸå­æ€§ï¼Œé˜²æ­¢æ“ä½œè¿‡ç¨‹ä¸­å¼•å‘çš„ç³»ç»Ÿå´©æºƒè€Œå¯¼è‡´çš„æ•°æ®ä¸åŒæ­¥ï¼›inodeå—ç”¨äºå­˜æ”¾inodeï¼ˆä¸€ä¸ªå—å¯å­˜æ”¾å¤šä¸ªinodeï¼‰ï¼›ç©ºé—²å—ä½å›¾ä¾¿äºæŸ¥æ‰¾ç©ºé—²çš„å—ï¼›æ•°æ®å—ä¸­ä¿å­˜äº†æ–‡ä»¶å’Œç›®å½•ç­‰å†…å®¹ã€‚</p><h2>å—ç¼“å†²å±‚</h2><h3>éœ€è¦å®ç°çš„ç›®æ ‡</h3><ol><li>åŒæ­¥å¯¹ç£ç›˜çš„è®¿é—®ã€‚å¯¹äºä»»æ„ä¸€ä¸ªå—ï¼ŒåŒä¸€æ—¶é—´ä»…æœ‰ä¸€ä»½æ‹·è´æ”¾åœ¨å†…å­˜ä¸­ä¸”åªå…è®¸ä¸€ä¸ªå†…æ ¸çº¿ç¨‹å¯¹è¯¥æ‹·è´è¿›è¡Œä¿®æ”¹ã€‚</li><li>ç¼“å­˜å¸¸ç”¨çš„å—ä»¥å‡å°‘ç£ç›˜è¯»å–æ¬¡æ•°ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</li></ol><h3>å®ç°æ–¹æ¡ˆ</h3><p>ä»£ç å‚è§<code>bio.c</code>ã€‚</p><p>æ ¹æ®æ—¶é—´ä¸ç©ºé—´å±€éƒ¨æ€§åŸç†ï¼Œå°†æœ€è¿‘ç»å¸¸è®¿é—®çš„ç£ç›˜å—ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä½¿ç”¨LRUæ›¿æ¢ç­–ç•¥ã€‚</p><h4>ç»“æ„å®šä¹‰</h4><p>xv6å°†ç¼“å†²åŒºåˆ†ä¸ºä¸¤ç§çŠ¶æ€ï¼š</p><ol><li>B_VALID æ„å‘³ç€è¿™ä¸ªç¼“å†²åŒºæ‹¥æœ‰ç£ç›˜å—çš„æœ‰æ•ˆå†…å®¹ï¼›</li><li>B_DIRTY æ„å‘³ç€ç¼“å†²åŒºçš„å†…å®¹å·²ç»è¢«æ”¹å˜å¹¶ä¸”éœ€è¦å†™å›ç£ç›˜ï¼›</li></ol><p>ä¸æ—§ç‰ˆç›¸æ¯”ï¼ŒB_BUSY çŠ¶æ€åœ¨æœ€æ–°ç‰ˆä»£ç ä¸­è¢«åˆ å»ã€‚ä½†ç”±äºç¼“å­˜åŒºä¸­çš„å—çš„é”çš„å­˜åœ¨ï¼Œåªæœ‰æŒæœ‰é”æ‰èƒ½è®¿é—®è¯¥å—ï¼Œè€Œåœ¨å¦ä¸€çº¿ç¨‹æœªä½¿ç”¨å®Œæˆå‰ï¼Œè¯¥é”ä¸ä¼šè¢«é‡Šæ”¾ï¼Œæ­¤æ—¶åªèƒ½å¾ªç¯ç­‰å¾…é”çš„é‡Šæ”¾ï¼Œè·å¾—é”åæ–¹å¯è·å¾—å—ã€‚æ•…ä¾æ—§å¯ä¿æŒå—å†…å®¹çš„åŸå­æ€§ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†…å­˜ä¸­çš„ç£ç›˜å—ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">buf</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> flags; <span class="comment">// æ ‡è®°ç£ç›˜çŠ¶æ€ï¼Œvalid/dirty</span></span><br><span class="line">  uint dev; <span class="comment">// ç£ç›˜è®¾å¤‡å·</span></span><br><span class="line">  uint blockno; <span class="comment">// å—ç¼–å·</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sleeplock</span> <span class="title">lock</span>;</span></span><br><span class="line">  uint refcnt; <span class="comment">// å¼•ç”¨è®¡æ•°</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">prev</span>;</span> <span class="comment">// LRU cache list ä½¿ç”¨LRUæ›¿æ¢</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">next</span>;</span> <span class="comment">// é“¾å¼ç»“æ„è¿æ¥ç£ç›˜å—</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">qnext</span>;</span> <span class="comment">// ç£ç›˜é˜Ÿåˆ—</span></span><br><span class="line">  uchar data[BSIZE]; <span class="comment">// å—å¤§å°ä¸º512å­—èŠ‚</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å—ç¼“å†²åŒºç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">spinlock</span> <span class="title">lock</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> <span class="title">buf</span>[<span class="title">NBUF</span>];</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ prev/next è¿æ¥æ‰€æœ‰ç¼“å†²å—</span></span><br><span class="line">  <span class="comment">// å…¶ä¸­ head.next æ˜¯æœ€è¿‘æœ€å¸¸ä½¿ç”¨çš„å—.</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> <span class="title">head</span>;</span></span><br><span class="line">&#125; bcache;</span><br></pre></td></tr></table></figure></p><h4>åˆå§‹åŒ– binit</h4><p>ä»ä¸€ä¸ªé™æ€æ•°ç»„<code>buf</code>ä¸­æ„å»ºå‡ºä¸€ä¸ªæœ‰<code>NBUF</code>ä¸ªå…ƒç´ çš„åŒå‘é“¾è¡¨ã€‚æ‰€æœ‰å¯¹å—ç¼“å†²çš„è®¿é—®éƒ½é€šè¿‡é“¾è¡¨è€Œéé™æ€æ•°ç»„ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">binit(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–å—ç¼“å†²é”</span></span><br><span class="line">  initlock(&amp;bcache.lock, <span class="string">"bcache"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//PAGEBREAK!</span></span><br><span class="line">  <span class="comment">// æ„å»ºç¼“å†²åŒå‘é“¾è¡¨</span></span><br><span class="line">  bcache.head.prev = &amp;bcache.head;</span><br><span class="line">  bcache.head.next = &amp;bcache.head;</span><br><span class="line">  <span class="keyword">for</span>(b = bcache.buf; b &lt; bcache.buf+NBUF; b++)&#123;</span><br><span class="line">    b-&gt;next = bcache.head.next;</span><br><span class="line">    b-&gt;prev = &amp;bcache.head;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒºä¸­çš„å—çš„é”</span></span><br><span class="line">    initsleeplock(&amp;b-&gt;lock, <span class="string">"buffer"</span>);</span><br><span class="line">    bcache.head.next-&gt;prev = b;</span><br><span class="line">    bcache.head.next = b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>æŸ¥æ‰¾ bget</h4><p>æ‰«æç¼“å†²åŒºé“¾è¡¨ï¼Œé€šè¿‡ç»™å®šçš„è®¾å¤‡å·å’Œæ‰‡åŒºå·æ‰¾åˆ°å¯¹åº”çš„ç¼“å†²åŒºã€‚å¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™åˆ†é…ä¸€ä¸ªç¼“å†²åŒºï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªæŒæœ‰é”çš„ç¼“å†²åŒºã€‚ä»£ç ä¸­åœ¨åŒå‘é“¾è¡¨çš„æœç´¢ä¸­å‘æœ€è¿‘æœ€å¸¸ä½¿ç”¨æ–¹å‘æŸ¥æ‰¾ï¼Œè‹¥æœªæ‰¾åˆ°åˆ™å‘å¦ä¸€æ–¹å‘æŸ¥æ‰¾ç©ºé—²ç¼“å†²åŒºä»¥åˆ†é…ã€‚</p><p>å…¶ä¸­è‹¥æ‰¾åˆ°ç¼“å†²åŒºä¸­æŒ‡å®šçš„å—ï¼Œè¿”å›çš„ç»“æœä¹Ÿä¸ä¸€å®šæ˜¯æŒ‡å®šçš„å—ã€‚å› ä¸ºåœ¨è¯·æ±‚è¯¥å—çš„é”å‰å·²é‡Šæ”¾ç¼“å†²åŒºé”ï¼Œè‹¥è¯¥å—æœªæŒæœ‰é”ä¸”æ­£åœ¨è¢«ç”¨æ¥ç¼“å†²å¦å¤–ä¸€ä¸ªå—ï¼Œåˆ™é‡æ–°è·å¾—é”æ—¶å·²æ˜¯å¦ä¸€ä¸ªå—ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">buf</span>*</span></span><br><span class="line"><span class="class"><span class="title">bget</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">blockno</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;bcache.lock); <span class="comment">// è¯·æ±‚å—ç¼“å†²åŒºé”</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸èƒ½ä¿è¯ b ä»ç„¶æ˜¯å¯ç”¨çš„ç¼“å†²åŒºï¼šå®ƒæœ‰å¯èƒ½è¢«ç”¨æ¥ç¼“å†²å¦å¤–ä¸€ä¸ªå—ã€‚</span></span><br><span class="line">  <span class="keyword">for</span>(b = bcache.head.next; b != &amp;bcache.head; b = b-&gt;next)&#123;</span><br><span class="line">    <span class="keyword">if</span>(b-&gt;dev == dev &amp;&amp; b-&gt;blockno == blockno)&#123;</span><br><span class="line">      b-&gt;refcnt++; <span class="comment">// å¼•ç”¨è®¡æ•°åŠ ä¸€</span></span><br><span class="line">      release(&amp;bcache.lock); <span class="comment">// é‡Šæ”¾å—ç¼“å†²åŒºé”</span></span><br><span class="line">      acquiresleep(&amp;b-&gt;lock); <span class="comment">// è¯·æ±‚è¯¥å—çš„é”</span></span><br><span class="line">      <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Not cached; recycle an unused buffer. æœªæ‰¾åˆ°åˆ™é‡æ–°æŸ¥æ‰¾</span></span><br><span class="line">  <span class="comment">// Even if refcnt==0, B_DIRTY indicates a buffer is in use</span></span><br><span class="line">  <span class="comment">// because log.c has modified it but not yet committed it.</span></span><br><span class="line">  <span class="comment">// å³ä½¿refcntç­‰äº0ï¼Œä¹Ÿå¯é€šè¿‡B_DIRTYçŸ¥é“ç¼“å†²åŒºè¢«ä½¿ç”¨ï¼Œæ­¤æ—¶æ—¥å¿—å·²ä¿®æ”¹ä½†æœªæäº¤ </span></span><br><span class="line">  <span class="keyword">for</span>(b = bcache.head.prev; b != &amp;bcache.head; b = b-&gt;prev)&#123;</span><br><span class="line">    <span class="keyword">if</span>(b-&gt;refcnt == <span class="number">0</span> &amp;&amp; (b-&gt;flags &amp; B_DIRTY) == <span class="number">0</span>) &#123;</span><br><span class="line">      b-&gt;dev = dev;</span><br><span class="line">      b-&gt;blockno = blockno;</span><br><span class="line">      b-&gt;flags = <span class="number">0</span>;</span><br><span class="line">      b-&gt;refcnt = <span class="number">1</span>;</span><br><span class="line">      release(&amp;bcache.lock);</span><br><span class="line">      acquiresleep(&amp;b-&gt;lock);</span><br><span class="line">      <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœªæ‰¾åˆ°å—ä¸”æœªèƒ½åˆ†é…å—ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  panic(<span class="string">"bget: no buffers"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>è¯» bread</h4><p><code>bread</code>ä¼šé¦–å…ˆè°ƒç”¨<code>bget</code>ä»ç¼“å­˜ä¸­å»å¯»æ‰¾å—æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ç›´æ¥è¿”å›ï¼›å¦‚æœä¸å­˜åœ¨åˆ™è¯·æ±‚ç£ç›˜è¯»æ“ä½œï¼Œè¯»åˆ°ç¼“å­˜ä¸­åå†è¿”å›ç»“æœã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">buf</span>*</span></span><br><span class="line"><span class="class"><span class="title">bread</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">blockno</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ç¼“å†²åŒº</span></span><br><span class="line">  b = bget(dev, blockno);</span><br><span class="line">  <span class="comment">// å¦‚æœç¼“å†²åŒºä¸­ä¸å­˜åœ¨æŒ‡å®šçš„å—ï¼Œåˆ™ä»ç£ç›˜ä¸­è¯»å‡º</span></span><br><span class="line">  <span class="keyword">if</span>((b-&gt;flags &amp; B_VALID) == <span class="number">0</span>) &#123;</span><br><span class="line">    iderw(b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>å†™ bwrite</h4><p>è®¾ç½® B_DIRTY ä½å¹¶ä¸”è°ƒç”¨ iderw å°†ç¼“å†²åŒºçš„å†…å®¹å†™åˆ°ç£ç›˜ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">bwrite(struct buf *b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// è¯¥å—æœªé”ï¼Œå¯èƒ½å·²è¢«é‡Šæ”¾ï¼Œæ— æ³•å†™å…¥ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holdingsleep(&amp;b-&gt;lock))</span><br><span class="line">    panic(<span class="string">"bwrite"</span>);</span><br><span class="line">  b-&gt;flags |= B_DIRTY;</span><br><span class="line">  iderw(b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>é‡Šæ”¾ brelse</h4><p>å°†ä¸€å—ç¼“å†²åŒºç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼Œå”¤é†’ç¡çœ åœ¨è¿™å—ç¼“å†²åŒºä¸Šçš„è¿›ç¨‹ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å”¤é†’ç¡çœ åœ¨è¿™å—ç¼“å†²åŒºä¸Šçš„è¿›ç¨‹ï¼›å°†ä¸€å—ç¼“å†²åŒºç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ã€‚</span></span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">brelse(struct buf *b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ç¼“å†²åŒºæœªæŒæœ‰å—é”ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holdingsleep(&amp;b-&gt;lock))</span><br><span class="line">    panic(<span class="string">"brelse"</span>);</span><br><span class="line"></span><br><span class="line">  releasesleep(&amp;b-&gt;lock); <span class="comment">// é‡Šæ”¾å—é”</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;bcache.lock); <span class="comment">// è¯·æ±‚  ç¼“å†²åŒºé”</span></span><br><span class="line">  b-&gt;refcnt--; <span class="comment">//å¼•ç”¨è®¡æ•°å‡ä¸€</span></span><br><span class="line">  <span class="keyword">if</span> (b-&gt;refcnt == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// æ— è¿›ç¨‹ç­‰å¾…ä½¿ç”¨ï¼Œç§»åŠ¨åˆ°é“¾è¡¨å¤´éƒ¨</span></span><br><span class="line">    b-&gt;next-&gt;prev = b-&gt;prev;</span><br><span class="line">    b-&gt;prev-&gt;next = b-&gt;next;</span><br><span class="line">    b-&gt;next = bcache.head.next;</span><br><span class="line">    b-&gt;prev = &amp;bcache.head;</span><br><span class="line">    bcache.head.next-&gt;prev = b;</span><br><span class="line">    bcache.head.next = b;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  release(&amp;bcache.lock); <span class="comment">//é‡Šæ”¾ç¼“å†²åŒºé”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>æ—¥å¿—å±‚</h3><p>æ¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½å¯èƒ½åŒ…å«ä¸€ä¸ªå¿…é¡»ä»å¤´åˆ°å°¾åŸå­å®Œæˆçš„å†™æ“ä½œåºåˆ—ï¼Œç§°è¿™æ ·çš„ä¸€ä¸ªåºåˆ—ä¸ºä¸€ä¸ªä¼šè¯ã€‚ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ä¸€ä¸ªä¼šè¯ä¹‹ä¸­ï¼Œå…¶ä»–è¿›ç¨‹å¿…é¡»ç­‰å¾…å½“å‰ä¼šè¯ä¸­çš„è¿›ç¨‹ç»“æŸã€‚å› æ­¤åŒä¸€æ—¶åˆ»æ—¥å¿—æœ€å¤šåªè®°å½•ä¸€æ¬¡ä¼šè¯ã€‚</p><p>è¯¥å±‚ç”¨äºç»´æŠ¤ç³»ç»Ÿå´©æºƒååˆ°åŸå­æ€§ï¼Œå³ä¼šè¯è¦ä¹ˆå®Œæˆï¼Œè¦ä¹ˆç³»ç»Ÿæ¢å¤è‡³ä¼šè¯å¼€å§‹å‰çš„çŠ¶æ€ã€‚</p><h3>å—åˆ†é…å™¨</h3><p>æœ¬éƒ¨åˆ†æ¶‰åŠçš„å‡½æ•°ä½äº<code>fs.c</code>ã€‚</p><p>ç”±äº<code>bread</code>ä¸<code>brelse</code>å·²æœ‰é”è¿›è¡Œäº’æ–¥ï¼Œå—åˆ†é…å™¨æ— éœ€å†åŠ é”ã€‚</p><h4>åˆ†é…æ–°çš„ç£ç›˜å—</h4><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> uint</span><br><span class="line">balloc(uint dev)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> b, bi, m;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line"></span><br><span class="line">  bp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(b = <span class="number">0</span>; b &lt; sb.size; b += BPB)&#123; <span class="comment">// è¯»ä½å›¾æ¯ä¸€å—</span></span><br><span class="line">    bp = bread(dev, BBLOCK(b, sb));</span><br><span class="line">    <span class="keyword">for</span>(bi = <span class="number">0</span>; bi &lt; BPB &amp;&amp; b + bi &lt; sb.size; bi++)&#123; <span class="comment">// è¯»å—å†…æ¯ä¸€ä½</span></span><br><span class="line">      m = <span class="number">1</span> &lt;&lt; (bi % <span class="number">8</span>);</span><br><span class="line">      <span class="keyword">if</span>((bp-&gt;data[bi/<span class="number">8</span>] &amp; m) == <span class="number">0</span>)&#123;  <span class="comment">// åˆ¤æ–­å—æ˜¯å¦ç©ºé—²</span></span><br><span class="line">        bp-&gt;data[bi/<span class="number">8</span>] |= m;  <span class="comment">// å°†å—æ ‡è®°ä¸ºä½¿ç”¨ä¸­</span></span><br><span class="line">        log_write(bp);</span><br><span class="line">        brelse(bp); <span class="comment">// é‡Šæ”¾å—</span></span><br><span class="line">        bzero(dev, b + bi); <span class="comment">// æ¸…é›¶å—</span></span><br><span class="line">        <span class="keyword">return</span> b + bi;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    brelse(bp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¶…å‡ºå—èŒƒå›´ï¼Œå¼•å‘é”™è¯¯</span></span><br><span class="line">  panic(<span class="string">"balloc: out of blocks"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>é‡Šæ”¾ç£ç›˜å—</h4><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line">bfree(<span class="keyword">int</span> dev, uint b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="keyword">int</span> bi, m;</span><br><span class="line"></span><br><span class="line">  readsb(dev, &amp;sb);</span><br><span class="line">  bp = bread(dev, BBLOCK(b, sb));</span><br><span class="line">  bi = b % BPB;</span><br><span class="line">  m = <span class="number">1</span> &lt;&lt; (bi % <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span>((bp-&gt;data[bi/<span class="number">8</span>] &amp; m) == <span class="number">0</span>) <span class="comment">// é‡Šæ”¾ç©ºé—²å—ï¼Œé”™è¯¯</span></span><br><span class="line">    panic(<span class="string">"freeing free block"</span>);</span><br><span class="line">  bp-&gt;data[bi/<span class="number">8</span>] &amp;= ~m;</span><br><span class="line">  log_write(bp);</span><br><span class="line">  brelse(bp); <span class="comment">// é‡Šæ”¾å—</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3>inode</h3><p>inodeæœ‰ä¸¤ç§ç±»åˆ«ï¼š</p><ul><li><p>ç£ç›˜ä¸Šçš„è®°å½•æ–‡ä»¶å¤§å°ã€æ•°æ®å—æ‰‡åŒºå·çš„æ•°æ®ç»“æ„</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> &#123;</span></span><br><span class="line">  <span class="keyword">short</span> type;           <span class="comment">// åŒºåˆ†æ–‡ä»¶ã€ç›®å½•å’Œç‰¹æ®Šæ–‡ä»¶çš„ i èŠ‚ç‚¹ï¼Œ0è¡¨ç¤ºä¸ºç©ºé—²èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">short</span> major;          <span class="comment">// ä¸»è®¾å¤‡å·ï¼ˆä»…é™T_DEVï¼‰</span></span><br><span class="line">  <span class="keyword">short</span> minor;          <span class="comment">// è¾…è®¾å¤‡å·ï¼ˆä»…é™T_DEVï¼‰</span></span><br><span class="line">  <span class="keyword">short</span> nlink;          <span class="comment">// æ–‡ä»¶ç³»ç»Ÿä¸­çš„ièŠ‚ç‚¹è¿æ¥æ•°</span></span><br><span class="line">  uint size;            <span class="comment">// æ–‡ä»¶çš„å­—èŠ‚æ•°</span></span><br><span class="line">  uint addrs[NDIRECT+<span class="number">1</span>]; <span class="comment">// ç”¨äºè¿™ä¸ªæ–‡ä»¶çš„æ•°æ®å—çš„å—å·</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p></li><li><p>å†…å­˜ä¸­çš„ä¸€ä¸ª i èŠ‚ç‚¹ï¼ŒåŒ…å«ä¸€ä¸ªç£ç›˜ä¸Š i èŠ‚ç‚¹çš„æ‹·è´ï¼Œä»¥åŠä¸€äº›å†…æ ¸éœ€è¦çš„é™„åŠ ä¿¡æ¯</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span> &#123;</span></span><br><span class="line">  uint dev;           <span class="comment">// Device number è®¾å¤‡å·</span></span><br><span class="line">  uint inum;          <span class="comment">// Inode number inodeå·</span></span><br><span class="line">  <span class="keyword">int</span> ref;            <span class="comment">// Reference count å¼•ç”¨æ•°</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sleeplock</span> <span class="title">lock</span>;</span> <span class="comment">// protects everything below here ä¿æŠ¤ä»¥ä¸‹æ‰€æœ‰æ•°æ®</span></span><br><span class="line">  <span class="keyword">int</span> valid;          <span class="comment">// inode has been read from disk? ièŠ‚ç‚¹æ˜¯å¦å·²ä»ç£ç›˜ä¸­è¯»å–</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹å‡ä¸ºç£ç›˜ä¸Šçš„ièŠ‚ç‚¹ï¼Œå³dinodeï¼Œçš„æ‹·è´</span></span><br><span class="line">  <span class="keyword">short</span> type;         <span class="comment">// copy of disk inode</span></span><br><span class="line">  <span class="keyword">short</span> major;</span><br><span class="line">  <span class="keyword">short</span> minor;</span><br><span class="line">  <span class="keyword">short</span> nlink;</span><br><span class="line">  uint size;</span><br><span class="line">  uint addrs[NDIRECT+<span class="number">1</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p></li></ul><p>xv6ä¸­æœ‰inodeçš„ç¼“å†²åŒºï¼Œä½œç”¨ä¸å—ç¼“å†²åŒºç›¸ä¼¼ã€‚ä»¥ä¸‹å‡½æ•°åˆ†æä»…åŒ…å«è¿›è¡Œç‰¹æ®Šæ“ä½œæˆ–è¾ƒä¸ºå¤æ‚çš„å‡½æ•°ï¼Œå…¶ä½™å‡½æ•°ä»…å†™å‡ºä½œç”¨å’Œä½¿ç”¨æ¡ä»¶ï¼ˆå¦‚<code>iunlock</code>ï¼‰ã€‚å…¶ä¸­å‡½æ•°ä½äº<code>fs.c</code>ã€‚</p><h4>è·å–inode iget</h4><p><code>iget</code>è¿”å›çš„inodeçš„æŒ‡é’ˆå°†ä¿è¯è¿™ä¸ªinodeä¼šç•™åœ¨ç¼“å­˜ä¸­ï¼Œä¸ä¼šè¢«åˆ æ‰ä¸”ä¸ä¼šè¢«ç”¨äºç¼“å­˜å¦ä¸€ä¸ªæ–‡ä»¶ï¼ˆå³ä½¿æœªè¯»å…¥ç£ç›˜dinodeå†…å®¹ï¼‰ã€‚è‹¥ç£ç›˜å†…å®¹æœªè¯»å…¥ï¼Œåˆ™ä»¥ååœ¨è°ƒç”¨<code>ilock</code>æ—¶è¯»å…¥ã€‚</p><p>å…¶ä¸­<code>iget</code>è¿”å›çš„inodeçš„æ˜¯æœªè¢«é”çš„ã€‚åœ¨ç›®å½•å±‚çš„ç›®å½•æŸ¥æ‰¾ä¸­ï¼Œè°ƒç”¨è€…å·²ç»å¯¹dpä¸Šé”ï¼Œå¦‚æœåœ¨è°ƒç”¨<code>iget</code>è¿”å›ä¹‹å‰å°è¯•å»é”ä¸Šè¯¥ièŠ‚ç‚¹ä¼šæœ‰äºŒæ¬¡é”ä¸Šdpçš„å¯èƒ½ä»è€Œé€ æˆæ­»é”ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">iget</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">inum</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>, *<span class="title">empty</span>;</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;icache.lock);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨inodeçš„cacheä¸­å¯»æ‰¾ç›®æ ‡inode</span></span><br><span class="line">  empty = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ip = &amp;icache.inode[<span class="number">0</span>]; ip &lt; &amp;icache.inode[NINODE]; ip++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;ref &gt; <span class="number">0</span> &amp;&amp; ip-&gt;dev == dev &amp;&amp; ip-&gt;inum == inum)&#123;</span><br><span class="line">      ip-&gt;ref++;</span><br><span class="line">      release(&amp;icache.lock);</span><br><span class="line">      <span class="keyword">return</span> ip; <span class="comment">// æ­¤æ—¶è¿”å›çš„ièŠ‚ç‚¹å†…å®¹ä¸ä¸€å®šå·²ä»ç£ç›˜è¯»å…¥cache</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(empty == <span class="number">0</span> &amp;&amp; ip-&gt;ref == <span class="number">0</span>)    <span class="comment">// è®°å½•æ‰«æåˆ°çš„ç¬¬ä¸€ä¸ªç©ºæ§½</span></span><br><span class="line">      empty = ip;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¿æŒinodeå…¥å£ï¼Œä»¥ä¸‹æœªä»ç£ç›˜è¯»å…¥å†…å®¹</span></span><br><span class="line">  <span class="keyword">if</span>(empty == <span class="number">0</span>) <span class="comment">// cacheä¸­æ— ièŠ‚ç‚¹ç©ºé—²ï¼Œå‡ºé”™</span></span><br><span class="line">    panic(<span class="string">"iget: no inodes"</span>);</span><br><span class="line"></span><br><span class="line">  ip = empty;</span><br><span class="line">  ip-&gt;dev = dev;</span><br><span class="line">  ip-&gt;inum = inum;</span><br><span class="line">  ip-&gt;ref = <span class="number">1</span>;</span><br><span class="line">  ip-&gt;valid = <span class="number">0</span>;</span><br><span class="line">  release(&amp;icache.lock);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>åˆ†é…inode ialloc</h4><p>åœ¨è®¾å¤‡devä¸Šåˆ†é…inodeï¼šé€šè¿‡ç»™å®ƒç±»å‹ç±»å‹å°†å…¶æ ‡è®°ä¸ºå·²åˆ†é…ï¼Œè¿”å›æœªé”å®šä½†å·²åˆ†é…å’Œå¼•ç”¨çš„inodeã€‚è¿™é‡Œä¸<code>balloc</code>ç›¸ä¼¼ï¼Œå¯å‚ç…§å‰æ–‡ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">ialloc</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">short</span> <span class="title">type</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">int</span> inum;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> *<span class="title">dip</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(inum = <span class="number">1</span>; inum &lt; sb.ninodes; inum++)&#123;</span><br><span class="line">    bp = bread(dev, IBLOCK(inum, sb));</span><br><span class="line">    dip = (struct dinode*)bp-&gt;data + inum%IPB;</span><br><span class="line">    <span class="keyword">if</span>(dip-&gt;type == <span class="number">0</span>)&#123;  <span class="comment">// inodeæœªåˆ†é…</span></span><br><span class="line">      <span class="built_in">memset</span>(dip, <span class="number">0</span>, <span class="keyword">sizeof</span>(*dip)); <span class="comment">// åˆ†é…ç©ºé—´</span></span><br><span class="line">      dip-&gt;type = type;</span><br><span class="line">      log_write(bp);</span><br><span class="line">      brelse(bp);</span><br><span class="line">      <span class="keyword">return</span> iget(dev, inum);</span><br><span class="line">    &#125;</span><br><span class="line">    brelse(bp);</span><br><span class="line">  &#125;</span><br><span class="line">  panic(<span class="string">"ialloc: no inodes"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>é”inode ilock</h4><p>é”å®šç»™å®šçš„inodeã€‚å¦‚æœ‰å¿…è¦ï¼Œä»ç£ç›˜è¯»å–inodeã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">ilock(struct inode *ip)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> *<span class="title">dip</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(ip == <span class="number">0</span> || ip-&gt;ref &lt; <span class="number">1</span>)</span><br><span class="line">    panic(<span class="string">"ilock"</span>);</span><br><span class="line"></span><br><span class="line">  acquiresleep(&amp;ip-&gt;lock); <span class="comment">// è¯·æ±‚inodeé”</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(ip-&gt;valid == <span class="number">0</span>)&#123; <span class="comment">// inodeå†…å®¹æœªä»ç£ç›˜è¯»å–</span></span><br><span class="line">    bp = bread(ip-&gt;dev, IBLOCK(ip-&gt;inum, sb));</span><br><span class="line">    dip = (struct dinode*)bp-&gt;data + ip-&gt;inum%IPB;</span><br><span class="line">    ip-&gt;type = dip-&gt;type;</span><br><span class="line">    ip-&gt;major = dip-&gt;major;</span><br><span class="line">    ip-&gt;minor = dip-&gt;minor;</span><br><span class="line">    ip-&gt;nlink = dip-&gt;nlink;</span><br><span class="line">    ip-&gt;size = dip-&gt;size;</span><br><span class="line">    memmove(ip-&gt;addrs, dip-&gt;addrs, <span class="keyword">sizeof</span>(ip-&gt;addrs));</span><br><span class="line">    brelse(bp);</span><br><span class="line">    ip-&gt;valid = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;type == <span class="number">0</span>) <span class="comment">// inodeæœªè¢«åˆ†é…ï¼Œå‡ºé”™ï¼Œå¼•å‘ææ…Œ</span></span><br><span class="line">      panic(<span class="string">"ilock: no type"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>é‡Šæ”¾å¼•ç”¨ iput</h4><p>é‡Šæ”¾å¯¹å†…å­˜ä¸­çš„æŸä¸€inodeçš„å¼•ç”¨ï¼Œå³å¼•ç”¨æ•°å‡ä¸€ã€‚å¯¹iputï¼ˆï¼‰çš„æ‰€æœ‰è°ƒç”¨å¿…é¡»åœ¨ä¼šè¯å†…ï¼Œå› ä¸ºå®ƒå¯èƒ½é‡Šæ”¾inodeã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">iput(struct inode *ip)</span><br><span class="line">&#123;</span><br><span class="line">  acquiresleep(&amp;ip-&gt;lock); <span class="comment">// è¯·æ±‚inodeé”</span></span><br><span class="line">  <span class="comment">// å¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªå¼•ç”¨ï¼Œåˆ™å¯ä»¥å›æ”¶inodeç¼“å­˜æ¡ç›®ã€‚</span></span><br><span class="line">  <span class="keyword">if</span>(ip-&gt;valid &amp;&amp; ip-&gt;nlink == <span class="number">0</span>)&#123;</span><br><span class="line">    acquire(&amp;icache.lock);</span><br><span class="line">    <span class="keyword">int</span> r = ip-&gt;ref;</span><br><span class="line">    release(&amp;icache.lock);</span><br><span class="line">    <span class="keyword">if</span>(r == <span class="number">1</span>)&#123;</span><br><span class="line">      <span class="comment">// inode has no links and no other references: truncate and free.</span></span><br><span class="line">      <span class="comment">// å¦‚æœé‚£æ˜¯æœ€åä¸€ä¸ªå¼•ç”¨å¹¶ä¸”inodeæ²¡æœ‰è¿æ¥ï¼Œé‡Šæ”¾ç£ç›˜ä¸Šçš„inodeï¼ˆåŠå…¶å†…å®¹ï¼‰ã€‚</span></span><br><span class="line">      itrunc(ip);</span><br><span class="line">      ip-&gt;type = <span class="number">0</span>;</span><br><span class="line">      iupdate(ip);</span><br><span class="line">      ip-&gt;valid = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  releasesleep(&amp;ip-&gt;lock); <span class="comment">// é‡Šæ”¾ inode é”</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;icache.lock);</span><br><span class="line">  ip-&gt;ref--; <span class="comment">// å¼•ç”¨è®¡æ•°å‡ä¸€</span></span><br><span class="line">  release(&amp;icache.lock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4>å…¶ä»–å‡½æ•°</h4><ul><li>readsb è¯»è¶…çº§å—</li><li>bzero å°†å—å†…å®¹æ¸…é›¶</li><li>iupdate å°†ä¿®æ”¹åçš„å†…å­˜ä¸­inodeå¤åˆ¶åˆ°ç£ç›˜ï¼›å¿…é¡»åœ¨æ¯æ¬¡æ›´æ”¹ip-&gt; xxxå­—æ®µåè°ƒç”¨ï¼›å®ƒå­˜åœ¨äºç£ç›˜ä¸Šï¼Œå› ä¸ºi-nodeç¼“å­˜æ˜¯ç›´å†™å¼çš„ï¼›è°ƒç”¨è€…å¿…é¡»æŒæœ‰ièŠ‚ç‚¹é”ã€‚</li><li>iunlock å¯¹æŒ‡å®šinodeè§£é”</li><li>iunlockput iunlockå’Œiputçš„ç»“åˆã€‚ç”±äºä¸¤ç§å¸¸å¸¸ä¸€èµ·ä½¿ç”¨ï¼Œæ•…æ•´åˆã€‚</li><li>bmap è¿”å›inodeä¸­ç¬¬nä¸ªå—çš„ç£ç›˜å—åœ°å€ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„å—ï¼Œbmapä¼šåˆ†é…ä¸€ä¸ªã€‚</li><li>stati ä»inodeå¤åˆ¶å±æ€§ä¿¡æ¯ã€‚</li><li>readi ä»inodeè¯»æ•°æ®ï¼Œè°ƒç”¨è€…å¿…é¡»æŒæœ‰ip-&gt; lockã€‚</li><li>writei ç»™inodeå†™å…¥æ•°æ®ï¼Œè°ƒç”¨è€…å¿…é¡»æŒæœ‰ip-&gt; lockã€‚</li></ul><p><em>å…¶ä¸­readiå’Œwriteiå‡è¦æ±‚ç»™å®šçš„åç§»å’Œè¯»å‡ºçš„é‡ä¸è¶…å‡ºæ–‡ä»¶å¤§å°ã€‚</em></p><h3>ç›®å½•å±‚</h3><h4>æ•°æ®ç»“æ„</h4><p>ç›®å½•çš„ièŠ‚ç‚¹çš„ç±»å‹æ˜¯T_DIR,.ç›®å½•æœ¬èº«æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨åˆ°ç£ç›˜ä¸Šçš„ï¼Œå®ƒçš„æ•°æ®æ˜¯ä¸€ç³»åˆ—çš„ç›®å½•æ¡ç›®ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> &#123;</span></span><br><span class="line">  ushort inum; <span class="comment">// ièŠ‚ç‚¹å·</span></span><br><span class="line">  <span class="keyword">char</span> name[DIRSIZ]; <span class="comment">// ç›®å½•å</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h4>å‡½æ•°</h4><p>è¯¦ç»†æ³¨é‡Šä½äº<code>fs.c</code>ã€‚</p><ul><li>dirlookup æŸ¥æ‰¾ç›®å½•ä¸­æŒ‡å®šåå­—çš„æ¡ç›®</li><li>dirlink ä¼šå†™å…¥ä¸€ä¸ªæ–°çš„ç›®å½•æ¡ç›®åˆ°æŸä¸€ç›®å½•ä¸‹</li></ul><h3>è·¯å¾„</h3><h4>å‡½æ•°</h4><ul><li>namex</li></ul><p>æŸ¥æ‰¾å¹¶è¿”å›inodeä»¥è·å–è·¯å¾„åã€‚å¦‚æœparentï¼= 0ï¼Œåˆ™è¿”å›çˆ¶é¡¹çš„inodeå¹¶å¤åˆ¶æœ€ç»ˆé¡¹ã€‚è·¯å¾„å…ƒç´ åˆ°åç§°ï¼Œå¿…é¡»æœ‰DIRSIZå­—èŠ‚çš„ç©ºé—´ã€‚è¯¥å‡½æ•°å¿…é¡»åœ¨ä¼šè¯å†…éƒ¨è°ƒç”¨ï¼Œå› ä¸ºå®ƒè°ƒç”¨iputï¼ˆï¼‰ã€‚</p><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">namex</span>(<span class="title">char</span> *<span class="title">path</span>, <span class="title">int</span> <span class="title">nameiparent</span>, <span class="title">char</span> *<span class="title">name</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>, *<span class="title">next</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(*path == <span class="string">'/'</span>) <span class="comment">// è·¯å¾„ä»¥åæ–œæ å¼€å§‹ï¼Œåˆ™è§£æä»æ ¹ç›®å½•å¼€å§‹</span></span><br><span class="line">    ip = iget(ROOTDEV, ROOTINO);</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">// å…¶ä»–æƒ…å†µä¸‹åˆ™ä»å½“å‰ç›®å½•å¼€å§‹</span></span><br><span class="line">    ip = idup(myproc()-&gt;cwd);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>((path = skipelem(path, name)) != <span class="number">0</span>)&#123; <span class="comment">// è€ƒè™‘è·¯å¾„ä¸­çš„æ¯ä¸€ä¸ªéƒ¨åˆ†</span></span><br><span class="line">    ilock(ip); <span class="comment">// ç¡®ä¿ip-&gt;typeä»ç£ç›˜ä¸­åŠ è½½å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;type != T_DIR)&#123; <span class="comment">// ä¸æ˜¯ç›®å½•ï¼ŒæŸ¥æ‰¾å¤±è´¥</span></span><br><span class="line">      iunlockput(ip);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœ€åä¸€ä¸ªè·¯å¾„å…ƒç´ ï¼Œå¾ªç¯æå‰ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span>(nameiparent &amp;&amp; *path == <span class="string">'\0'</span>)&#123;</span><br><span class="line">      <span class="comment">// Stop one level early. </span></span><br><span class="line">      iunlock(ip);</span><br><span class="line">      <span class="keyword">return</span> ip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((next = dirlookup(ip, name, <span class="number">0</span>)) == <span class="number">0</span>)&#123; <span class="comment">// å¯»æ‰¾è·¯å¾„å…ƒç´ å¤±è´¥ï¼ŒæŸ¥æ‰¾å¤±è´¥</span></span><br><span class="line">      iunlockput(ip);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    iunlockput(ip);</span><br><span class="line">    ip = next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(nameiparent)&#123;</span><br><span class="line">    iput(ip);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>skipelem å°†è·¯å¾„ä¸­çš„ä¸‹ä¸€ä¸ªè·¯å¾„å…ƒç´ å¤åˆ¶åˆ°åç§°ä¸­ï¼Œè¿”å›æŒ‡å‘å¤åˆ¶åçš„å…ƒç´ çš„æŒ‡é’ˆã€‚</li><li>namei è§£æpathå¹¶è¿”å›å¯¹åº”çš„inodeã€‚</li><li>nameiparent è¿”å›ä¸Šçº§ç›®å½•çš„ièŠ‚ç‚¹å¹¶ä¸”æŠŠæœ€åä¸€ä¸ªå…ƒç´ æ‹·è´åˆ°nameä¸­ã€‚</li></ul><p><em>å‡½æ•°çš„è¯¦ç»†å†…å®¹ä½äº<code>fs.c</code></em></p><h3>æ–‡ä»¶æè¿°ç¬¦å±‚</h3><p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">file</span> &#123;</span></span><br><span class="line">  <span class="keyword">enum</span> &#123; FD_NONE, FD_PIPE, FD_INODE &#125; type; <span class="comment">// æ–‡ä»¶åˆ†ä¸ºç®¡é“æ–‡ä»¶å’Œæ™®é€šæ–‡ä»¶ç­‰ï¼ŒFD_NONEè¡¨ç¤ºæ–‡ä»¶æœªä½¿ç”¨</span></span><br><span class="line">  <span class="keyword">int</span> ref; <span class="comment">// reference count å¼•ç”¨è®¡æ•°</span></span><br><span class="line">  <span class="keyword">char</span> readable; <span class="comment">// å¯è¯»</span></span><br><span class="line">  <span class="keyword">char</span> writable; <span class="comment">// å¯å†™</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">pipe</span> *<span class="title">pipe</span>;</span> <span class="comment">// ç®¡é“</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>;</span> <span class="comment">// æŒ‡å‘ièŠ‚ç‚¹</span></span><br><span class="line">  uint off;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>xv6ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„æ‰“å¼€æ–‡ä»¶è¡¨ã€‚æ¯ä¸ªæ‰“å¼€æ–‡ä»¶å‡ç”±ä¸Šé¢çš„ç»“æ„ä½“è¡¨ç¤ºï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹ièŠ‚ç‚¹æˆ–è€…ç®¡é“å’Œæ–‡ä»¶åç§»çš„å°è£…ã€‚æ¯æ¬¡è°ƒç”¨<code>open</code>éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„fileç»“æ„ä½“ã€‚</p><p>å¦‚æœå¤šä¸ªè¿›ç¨‹ç›¸äº’ç‹¬ç«‹åœ°æ‰“å¼€äº†åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¸åŒçš„å®ä¾‹å°†æ‹¥æœ‰ä¸åŒçš„I/Oåç§»ã€‚è€Œä¸”åŒä¸€ä¸ªfileç»“æ„ä½“å¯ä»¥åœ¨ä¸€ä¸ªè¿›ç¨‹çš„æ–‡ä»¶è¡¨ä¸­å¤šæ¬¡å‡ºç°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨å¤šä¸ªè¿›ç¨‹çš„æ–‡ä»¶è¡¨ä¸­å‡ºç°ã€‚å¯¹æ¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥è¢«æ‰“å¼€ç”¨äºè¯»ã€å†™æˆ–è€…äºŒè€…ã€‚</p><p>ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ‰“å¼€æ–‡ä»¶éƒ½å­˜åœ¨äºä¸€ä¸ªå…¨å±€çš„æ–‡ä»¶è¡¨<code>ftable</code>ä¸­ã€‚</p><h4>å‡½æ•°</h4><p>è¯¥å±‚çš„å‡½æ•°ä½äº<code>file.c</code>ï¼Œè¯¦ç»†æ³¨é‡Šè§ä»£ç æ–‡ä»¶ã€‚</p><ul><li>filealloc åˆ†é…æ–‡ä»¶ï¼Œæ‰«ææ•´ä¸ªæ–‡ä»¶è¡¨å¯»æ‰¾æ²¡æœ‰è¢«å¼•ç”¨çš„æ–‡ä»¶å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å¼•ç”¨ã€‚</li><li>filedup é‡å¤å¼•ç”¨æ–‡ä»¶ï¼Œå¢åŠ å¼•ç”¨è®¡æ•°ã€‚</li><li>fileclose é‡Šæ”¾å¯¹æ–‡ä»¶å¼•ç”¨çš„å‡½æ•°ï¼Œå‡å°‘å¼•ç”¨è®¡æ•°ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶çš„å¼•ç”¨è®¡æ•°å˜ä¸º0çš„æ—¶å€™ï¼Œæ ¹æ®æ–‡ä»¶ç±»å‹çš„ä¸åŒ,é‡Šæ”¾æ‰å½“å‰çš„ç®¡é“æˆ–è€…ièŠ‚ç‚¹ã€‚</li><li>fileread è¯»æ–‡ä»¶ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>read</code>æ“ä½œ</li><li>filewrite å†™æ–‡ä»¶ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>write</code>æ“ä½œã€‚</li><li>filestat è·å–æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>stat</code>æ“ä½œï¼ˆåªå…è®¸ä½œç”¨åœ¨inodeï¼‰ã€‚</li></ul><h3>ç³»ç»Ÿè°ƒç”¨</h3><p>æš‚æ— å†…å®¹ã€‚</p><h2>æ–‡ä»¶ç³»ç»Ÿä¸­xv6å¯æ”¹è¿›ä¹‹å¤„</h2><h3>cache</h3><ol><li>ä½¿ç”¨çš„æ›¿æ¢ç­–ç•¥ä¸ºLRUï¼Œç®—æ³•è¾ƒä¸ºç®€å•ã€‚</li><li>é“¾è¡¨çš„ä½¿ç”¨è™½ç„¶å®ç°ç®€å•ï¼Œä½†æŸ¥æ‰¾æ•ˆç‡ä½ï¼Œæ—¶é—´å¤æ‚åº¦é«˜ã€‚è‹¥èƒ½ä½¿ç”¨å“ˆå¸Œè¡¨ç­‰å®ç°æŸ¥æ‰¾å¯æé«˜æ•ˆç‡ã€‚</li></ol><h3>ç›®å½•æŸ¥æ‰¾</h3><p>ç›®å½•æŸ¥æ‰¾ä¸ºçº¿æ€§æŸ¥æ‰¾ï¼Œåœ¨ç›®å½•æ•°é‡è¾ƒå¤šçš„æƒ…å†µä¸‹è€—æ—¶å·¨å¤§ã€‚è‹¥èƒ½ä½¿ç”¨æ ‘ç­‰ç»“æ„ï¼Œä¾¿èƒ½å¤§å¤§å‡å°æ—¶é—´å¤æ‚åº¦ã€‚</p><h3>å¤§å°å›ºå®š</h3><p>æ–‡ä»¶ç³»ç»Ÿçš„å¤§å°åœ¨xv6ä¸­æ˜¯ä¸æ”¹å˜çš„ï¼Œå›ºå®šåœ¨ä¸€ä¸ªç£ç›˜è®¾å¤‡ä¸Šã€‚è¿™ä¸€ç‚¹å¯¹äºä¸ªäººPCå½±å“ä¸å¤§ï¼Œä½†åœ¨éœ€è¦å­˜å‚¨å¤§é‡æ–‡ä»¶æˆ–è¶…å¤§æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œä¾¿æœ‰äº›æ‰è¥Ÿè§è‚˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹æ–‡ä»¶ç³»ç»Ÿæºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>GG</title>
    <link href="http://rootreturn0.github.io/2019/08/27/GG/"/>
    <id>http://rootreturn0.github.io/2019/08/27/GG/</id>
    <published>2019-08-26T18:12:49.000Z</published>
    <updated>2019-10-18T17:10:25.516Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚" />    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      What is that?
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ä¸–ç•Œ</title>
    <link href="http://rootreturn0.github.io/2019/08/06/HK/"/>
    <id>http://rootreturn0.github.io/2019/08/06/HK/</id>
    <published>2019-08-06T10:41:51.000Z</published>
    <updated>2019-10-18T17:11:47.476Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚" />    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      å¼±åŠ¿ç¾¤ä½“çš„å’Œå¹³æŠ—äº‰
    
    </summary>
    
      <category term="Thinking" scheme="http://rootreturn0.github.io/categories/Thinking/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>å»ºç«™åˆå§‹æ—¥å¿—</title>
    <link href="http://rootreturn0.github.io/2019/07/26/%E5%BB%BA%E7%AB%99%E5%88%9D%E5%A7%8B%E6%97%A5%E5%BF%97/"/>
    <id>http://rootreturn0.github.io/2019/07/26/å»ºç«™åˆå§‹æ—¥å¿—/</id>
    <published>2019-07-26T06:00:02.000Z</published>
    <updated>2019-11-11T08:59:07.289Z</updated>
    
    <content type="html"><![CDATA[<h1>ä¸»é¢˜Next</h1><p>ä¸€å¼€å§‹é€‰ç”¨çš„æ˜¯<a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">Yilia</a>,ä½†ç”±äº<a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">Yilia</a>å¼€å‘ä½¿ç”¨çš„webpackç‰ˆæœ¬è¾ƒè€ï¼Œå®šåˆ¶æ—¶æ˜“è¸©å‘ï¼Œæ•…æ”¹ç”¨<a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">Next</a>ã€‚æœ¬æ–‡æ ¹æ®å®˜æ–¹æ–‡æ¡£æ•´ç†ï¼Œå¹¶æ ¹æ®è‡ªå·±å–œå¥½åŠ å…¥äº†ä¸€äº›ç¬¬ä¸‰æ–¹æ’ä»¶å’Œä¿®æ”¹ã€‚æ‰€æœ‰ä¿®æ”¹å°†ä¼šé€æ­¥ç»™å‡ºï¼ŒNextçš„é…ç½®å®Œæ•´è¯´æ˜å¯å‚ç…§<a href="http://theme-next.iissnan.com" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>&lt;!--more--&gt;</p><h2>åŸºæœ¬é…ç½®</h2><h3>ä¸‹è½½</h3><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure></p><h3>å¯ç”¨</h3><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ›´æ”¹ <code>theme</code> ä¸º <code>next</code> ã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure></p><h3>é€‰æ‹©Scheme</h3><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œé€‰æ‹© <code>Muse</code> ã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br></pre></td></tr></table></figure></p><h3>åˆ‡æ¢è¯­è¨€</h3><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,è®¾ç½® <code>language</code> ä¸º <code>zh-Hans</code> ã€‚</p><h2>è‡ªå®šä¹‰</h2><h3>ä¸»é¡µæ–‡ç« é˜´å½±æ•ˆæœ</h3><p>æ‰“å¼€ <code>themes/next/source/css/_custom/custom.styl</code> ,å¢åŠ </p><p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ</span><br><span class="line"> <span class="selector-class">.post</span> &#123;</span><br><span class="line">   <span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line">   <span class="attribute">margin-bottom</span>: <span class="number">60px</span>;</span><br><span class="line">   <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">   <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">   <span class="attribute">-moz-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">   <span class="attribute">-o-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">   <span class="attribute">-ms-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">   <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ <code>-webkit-</code> ç­‰ä¸ºæµè§ˆå™¨å‰ç¼€ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯è‡ªè¡Œé€‚é…ï¼š</p><ul><li>-webkit- Chrome, Sarari</li><li>-moz- Firefox</li><li>-o- Opera</li><li>-ms- IE (IE9ä»¥ä¸Šä¼¼ä¹ä¸é€‚ç”¨ï¼Œç›´æ¥ä½¿ç”¨box-shadow)</li></ul><h3>ä¿®æ”¹æ ‡ç­¾</h3><p>æ‰“å¼€ <code>themes/next/layout/_macro/post.swig</code> ï¼Œæœç´¢ <code>rel=&quot;tag&quot;&gt;#</code>ï¼Œå°† <code>#</code> æ¢æˆ <code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code> ã€‚</p><h3>åŠ¨æ€èƒŒæ™¯</h3><p>æ‰“å¼€ <code>theme/next/layout/_layout.swig</code> ï¼Œåœ¨ &lt; /body&gt;ä¹‹å‰æ·»åŠ ä»£ç </p><p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.canvas_nest %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,å°† <code>canvas_next</code> ç½®ä¸º <code>true</code> ã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">canvas_nest:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p><p>--</p><p>11/11/2019æ›´æ–°</p><p>æ›´æ¢äº†åŠ¨ç”»ã€‚æ–°ç‰ˆæœ¬nextä¹Ÿè®¸ç›´æ¥åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>theme/next/_config.yml</code> ä¸­ä¿®æ”¹ä»¥ä¸‹ä»£ç å°±è¡Œã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Canvas-nest</span></span><br><span class="line"><span class="attr">canvas_nest:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># three_waves</span></span><br><span class="line"><span class="attr">three_waves:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># canvas_lines</span></span><br><span class="line"><span class="attr">canvas_lines:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># canvas_sphere</span></span><br><span class="line"><span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure></p><h3>çœ‹æ¿ç‹—</h3><p>å®‰è£…</p><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-helper-live2d --save</span><br><span class="line">npm install live2d-widget-model-wanko</span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,å¢åŠ ä»¥ä¸‹ä»£ç ã€‚å…¶ä¸­å¯¹ <code>display</code> éƒ¨åˆ†åšäº†ä¿®æ”¹ï¼Œä»¥é€‚åº”ç½‘é¡µå¸ƒå±€ã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># enable: false</span></span><br><span class="line"><span class="attr">  scriptFrom:</span> <span class="string">local</span> <span class="comment"># é»˜è®¤</span></span><br><span class="line"><span class="attr">  pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># æ’ä»¶åœ¨ç«™ç‚¹ä¸Šçš„æ ¹ç›®å½•(ç›¸å¯¹è·¯å¾„)</span></span><br><span class="line"><span class="attr">  pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># è„šæœ¬æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line"><span class="attr">  pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># æ¨¡å‹æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="comment"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line"><span class="attr">  tagMode:</span> <span class="literal">false</span> <span class="comment"># æ ‡ç­¾æ¨¡å¼, æ˜¯å¦ä»…æ›¿æ¢ live2d tagæ ‡ç­¾è€Œéæ’å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­</span></span><br><span class="line"><span class="attr">  debug:</span> <span class="literal">false</span> <span class="comment"># è°ƒè¯•, æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—</span></span><br><span class="line"><span class="attr">  model:</span></span><br><span class="line"><span class="attr">    use:</span> <span class="string">live2d-widget-model-wanko</span> <span class="comment"># npm-module package name</span></span><br><span class="line">    <span class="comment"># use: wanko # åšå®¢æ ¹ç›®å½•/live2d_models/ ä¸‹çš„ç›®å½•å</span></span><br><span class="line">    <span class="comment"># use: ./wives/wanko # ç›¸å¯¹äºåšå®¢æ ¹ç›®å½•çš„è·¯å¾„</span></span><br><span class="line">    <span class="comment"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line"><span class="attr">  display:</span></span><br><span class="line"><span class="attr">    position:</span> <span class="string">right</span></span><br><span class="line"><span class="attr">    width:</span> <span class="number">200</span></span><br><span class="line"><span class="attr">    height:</span> <span class="number">400</span></span><br><span class="line">    <span class="comment"># æ°´å¹³ä½ç½®</span></span><br><span class="line"><span class="attr">    hOffset:</span> <span class="number">40</span></span><br><span class="line">    <span class="comment"># å‚ç›´ä½ç½®</span></span><br><span class="line"><span class="attr">    vOffset:</span> <span class="bullet">-80</span></span><br><span class="line"><span class="attr">  mobile:</span></span><br><span class="line"><span class="attr">    show:</span> <span class="literal">true</span> <span class="comment"># æ‰‹æœºä¸­æ˜¯å¦å±•ç¤º</span></span><br></pre></td></tr></table></figure></p><h3>Github Corners</h3><p>æ‰“å¼€<a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">Github Corners</a>,å¤åˆ¶ä»£ç å¹¶ç²˜è´´ä»£ç åˆ° <code>themes/next/layout/_layout.swig</code> æ–‡ä»¶ä¸­(æ”¾åœ¨ <code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code> çš„ä¸‹é¢)ï¼Œå¹¶æŠŠ <code>href</code> æ”¹ä¸ºæ­£ç¡®çš„githubåœ°å€ã€‚</p><p>ç”±äºæ¯”è¾ƒå–œæ¬¢è¿™ä¸ªå°å®¶ä¼™ä¸€ç›´å‡ºç°ï¼Œæ•…æ›´æ”¹ä»£ç ä¸­çš„ <code>position: absolute</code> ä¸º <code>position: fixed</code> ã€‚</p><p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"headband"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">"https://github.com/RootReturn0"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"github-corner"</span> aria-label=<span class="string">"View source on GitHub"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"80"</span> <span class="attr">height</span>=<span class="string">"80"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 250 250"</span> <span class="attr">style</span>=<span class="string">"fill:#151513; color:#fff; position: fixed; top: 0; border: 0; right: 0;"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"</span> <span class="attr">fill</span>=<span class="string">"currentColor"</span> <span class="attr">style</span>=<span class="string">"transform-origin: 130px 106px;"</span> <span class="attr">class</span>=<span class="string">"octo-arm"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"</span> <span class="attr">fill</span>=<span class="string">"currentColor"</span> <span class="attr">class</span>=<span class="string">"octo-body"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;@<span class="keyword">keyframes</span> octocat-wave&#123;0%,100%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(0)&#125;20%,60%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(-25deg)&#125;40%,80%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(10deg)&#125;&#125;@<span class="keyword">media</span> (max-width:<span class="number">500px</span>)&#123;<span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:none&#125;<span class="selector-class">.github-corner</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h3>RSS</h3><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ·»åŠ </p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: http://hexo.io/plugins/</span></span><br><span class="line"><span class="attr">plugins:</span> <span class="string">hexo-generate-feed</span></span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,åœ¨ <code>rss</code> åæ·»åŠ  <code>/atom.xml</code></p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set rss to false to disable feed link.</span></span><br><span class="line"><span class="comment"># Leave rss as empty to use site's feed link.</span></span><br><span class="line"><span class="comment"># Set rss to specific value if you have burned your feed already.</span></span><br><span class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure></p><h2>åŠ å¯†</h2><p>æœ‰æ—¶å†™åšå®¢å¹¶ä¸å¸Œæœ›è®©æ‰€æœ‰äººçœ‹åˆ°ï¼Œæ•…åŠ å…¥äº†åŠ å¯†åŠŸèƒ½ã€‚Hexoæ˜¯ä¸€ä¸ªé™æ€åšå®¢ï¼Œè‡ªå·±å†™ä¸€ä¸ªjsè¿›è¡ŒåŠ å¯†è™½ä¸å›°éš¾ï¼Œä½†æ ·å¼å®åœ¨ä¸å¯æ­ç»´ã€‚è¿™é‡Œé‡‡ç”¨å¤§ç¥åšå‡ºçš„<a href="https://github.com/MikeCoder/hexo-blog-encrypt/blob/master/ReadMe.zh.md" target="_blank" rel="noopener">hexo-blog-encrypt</a>è¿›è¡ŒåŠ å¯†ã€‚</p><h3>å®‰è£…</h3><p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">npm install hexo-blog-encrypt --save</span><br></pre></td></tr></table></figure></p><h3>é…ç½®</h3><h4>æ ¹æœ¬é…ç½®</h4><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ·»åŠ </p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">encrypt:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p><h4>è‡ªå®šä¹‰é…ç½®</h4><p>ç„¶ååœ¨blogçš„å¤´éƒ¨æ·»åŠ ä¸Šå¯¹åº”çš„å­—æ®µï¼Œå¦‚password, abstract, messageã€‚</p><p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ–‡ç« åŠ å¯†</span><br><span class="line">date: 2019-08-06 19:00:02</span><br><span class="line">password: ä½ çš„å¯†ç </span><br><span class="line">abstract: æ˜¾ç¤ºåœ¨ç›®å½•é¡µæˆ–é¦–é¡µçš„å†…å®¹ç®€ä»‹ã€‚</span><br><span class="line">message:  æ­¤å¤„ä¸ºè¾“å…¥å¯†ç æ—¶çš„æç¤ºå†…å®¹ã€‚</span><br><span class="line">---</span><br></pre></td></tr></table></figure></p><h4>å…¨å±€é…ç½®</h4><p>å¸Œæœ›ä¿®æ”¹é»˜è®¤çš„æç¤ºå’Œæ‘˜è¦å†…å®¹æ—¶ï¼Œä½ å¯ä»¥æ·»åŠ å¦‚ä¸‹é…ç½®åœ¨æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">encrypt:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  default_abstract:</span> <span class="string">è¿™æ˜¯ä¸€ç¯‡åŠ å¯†æ–‡ç« ï¼Œå†…å®¹å¯èƒ½æ˜¯xxx</span></span><br><span class="line"><span class="attr">  default_message:</span> <span class="string">è¾“å…¥å¯†ç ï¼ŒæŸ¥çœ‹æ–‡ç« ã€‚</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1&gt;ä¸»é¢˜Next&lt;/h1&gt;
&lt;p&gt;ä¸€å¼€å§‹é€‰ç”¨çš„æ˜¯&lt;a href=&quot;https://github.com/litten/hexo-theme-yilia&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Yilia&lt;/a&gt;,ä½†ç”±äº&lt;a href=&quot;https://
      
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>hello world</title>
    <link href="http://rootreturn0.github.io/2019/07/25/hello-world/"/>
    <id>http://rootreturn0.github.io/2019/07/25/hello-world/</id>
    <published>2019-07-25T12:43:01.000Z</published>
    <updated>2019-07-26T14:28:49.946Z</updated>
    
    <content type="html"><![CDATA[<p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"Hello world!"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="title">print</span><span class="params">(<span class="string">'Hello world!'</span>)</span></span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span clas
      
    
    </summary>
    
    
  </entry>
  
</feed>
