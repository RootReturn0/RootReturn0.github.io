<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ã€‡</title>
  
  <subtitle>ä¸–ç•Œçš„æœ¬è´¨å³æ˜¯æ— é™çš„å¾ªç¯</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://rootreturn0.github.io/"/>
  <updated>2019-10-18T17:55:45.562Z</updated>
  <id>http://rootreturn0.github.io/</id>
  
  <author>
    <name>rootReturn0</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸Šä¼ æœ¬åœ°å›¾ç‰‡</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E4%B8%8A%E4%BC%A0%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87/"/>
    <id>http://rootreturn0.github.io/2019/10/19/ä¸Šä¼ æœ¬åœ°å›¾ç‰‡/</id>
    <published>2019-10-18T17:48:13.000Z</published>
    <updated>2019-10-18T17:55:45.562Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /d ä½ çš„hexoæ ¹ç›®å½•</span><br><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h1><p>æ‰“å¼€æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="attr">http://yourname.github.io</span></span><br></pre></td></tr></table></figure><h1 id="æ’å…¥å›¾ç‰‡"><a href="#æ’å…¥å›¾ç‰‡" class="headerlink" title="æ’å…¥å›¾ç‰‡"></a>æ’å…¥å›¾ç‰‡</h1><p>è¿è¡Œ <code>hexo n &quot;yourblogname&quot;</code> ç”Ÿæˆåšæ–‡æ—¶ï¼Œ/source/_posts ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ªä¸ md åŒåçš„æ–‡ä»¶å¤¹ï¼Œå°†å›¾ç‰‡æ”¾äººè¯¥æ–‡ä»¶å¤¹ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨![](yourblogname/picture.jpg)æ’å…¥å›¾ç‰‡å³å¯ã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      åœ¨å†™blogæ—¶æ’å…¥æœ¬åœ°å›¾ç‰‡ï¼Œå¹¶ä¸Šä¼ æ˜¾ç¤º
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>å¢åŠ é¡µé¢</title>
    <link href="http://rootreturn0.github.io/2019/10/19/%E5%A2%9E%E5%8A%A0%E9%A1%B5%E9%9D%A2/"/>
    <id>http://rootreturn0.github.io/2019/10/19/å¢åŠ é¡µé¢/</id>
    <published>2019-10-18T17:46:34.000Z</published>
    <updated>2019-10-18T17:57:34.098Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h1><p><a href="https://github.com/iissnan/hexo-theme-next/wiki/åˆ›å»ºæ ‡ç­¾äº‘é¡µé¢" target="_blank" rel="noopener">ğŸ”—å®˜æ–¹é“¾æ¥</a></p><p>æ–°å»ºä¸€ä¸ªé¡µé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘æ–°å»ºç•Œé¢ï¼Œå°†é¡µé¢ç±»å‹è®¾ç½®ä¸º tags ï¼Œä¸»é¢˜å°†ä¼šåœ¨è¿™ä¸ªé¡µé¢ä¸Šæ˜¾ç¤ºæ ‡ç­¾äº‘ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Tags</span><br><span class="line">date: 2019-10-19 01:26:01</span><br><span class="line">type: "tags"</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>å»é™¤ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.yml</code> ä¸­ tags çš„æ³¨é‡Šã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">  home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">  tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">  categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">  archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure><h2 id="æ ‡ç­¾çš„ä½¿ç”¨"><a href="#æ ‡ç­¾çš„ä½¿ç”¨" class="headerlink" title="æ ‡ç­¾çš„ä½¿ç”¨"></a>æ ‡ç­¾çš„ä½¿ç”¨</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tags: xxx</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tags:</span><br><span class="line"><span class="bullet">- </span>xxx</span><br><span class="line"><span class="bullet">- </span>xxx</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ—¶ï¼Œä¸ºå¹¶åˆ—æ ‡ç­¾ï¼Œæ— ç­‰çº§åŒºåˆ†ã€‚</p><h1 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h1><p><a href="https://github.com/iissnan/hexo-theme-next/wiki/åˆ›å»ºåˆ†ç±»é¡µé¢" target="_blank" rel="noopener">ğŸ”—å®˜æ–¹é“¾æ¥</a></p><p>æ–°å»ºä¸€ä¸ªé¡µé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>ç¼–è¾‘æ–°å»ºç•Œé¢ï¼Œå°†é¡µé¢ç±»å‹è®¾ç½®ä¸º categories ï¼Œä¸»é¢˜å°†ä¼šåœ¨è¿™ä¸ªé¡µé¢ä¸Šæ˜¾ç¤ºæ‰€æœ‰çš„åˆ†ç±»ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Categories</span><br><span class="line">date: 2019-10-19 01:26:08</span><br><span class="line">type: "categories"</span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>å»é™¤ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>_config.yml</code> ä¸­ categories çš„æ³¨é‡Šã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line"><span class="attr">  home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line"><span class="attr">  tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">  categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line"><span class="attr">  archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure><h2 id="åˆ†ç±»çš„ä½¿ç”¨"><a href="#åˆ†ç±»çš„ä½¿ç”¨" class="headerlink" title="åˆ†ç±»çš„ä½¿ç”¨"></a>åˆ†ç±»çš„ä½¿ç”¨</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">categories: xxx</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">categories:</span><br><span class="line"><span class="bullet">- </span>xxx</span><br><span class="line"><span class="bullet">- </span>xxx</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ—¶ï¼Œå¹¶éå¹¶åˆ—åˆ†ç±»ï¼Œè€Œæ˜¯åˆ†çº§åˆ†ç±»ã€‚å…¶ä¸­è¶Šé å‰çš„è¶Šé«˜çº§ã€‚</p>]]></content>
    
    <summary type="html">
    
      æ–°å»ºç•Œé¢ï¼Œè§£å†³è·³è½¬tagsç­‰404é—®é¢˜
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>Androidå­¦ä¹ ç¬”è®°_Activity</title>
    <link href="http://rootreturn0.github.io/2019/10/18/Android%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Activity/"/>
    <id>http://rootreturn0.github.io/2019/10/18/Androidå­¦ä¹ ç¬”è®°-Activity/</id>
    <published>2019-10-18T14:07:48.000Z</published>
    <updated>2019-10-19T05:49:13.732Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬”è®°åŸºäº<a href="https://me.csdn.net/sinyu890807" target="_blank" rel="noopener">éƒ­éœ–å¤§ç¥</a>æ‰€è‘—çš„<a href="https://blog.csdn.net/guolin_blog/article/details/52032038" target="_blank" rel="noopener">ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬äºŒç‰ˆ</a>ä¹‹ç¬¬2ç« ã€‚</p><p>å…¶ä¸­ï¼š</p><ul><li>ä½¿ç”¨çš„IDEï¼šAndroid Studio</li><li>ç¤ºä¾‹é¡¹ç›®åï¼šActivityTest</li><li>åŒ…åï¼šâ€œcom.example.avtivitytestâ€</li></ul><a id="more"></a><h2 id="æ‰‹åŠ¨åˆ›å»ºæ´»åŠ¨"><a href="#æ‰‹åŠ¨åˆ›å»ºæ´»åŠ¨" class="headerlink" title="æ‰‹åŠ¨åˆ›å»ºæ´»åŠ¨"></a>æ‰‹åŠ¨åˆ›å»ºæ´»åŠ¨</h2><p><em>æ–°å»ºé¡¹ç›®æ—¶é€‰æ‹©<code>Add No Activity</code></em></p><center><img src="//rootreturn0.github.io/2019/10/18/Androidå­¦ä¹ ç¬”è®°-Activity/åˆå§‹é¡¹ç›®ç»“æ„.png" width="400" hegiht="600" align="center"><p>åˆå§‹æ–‡ä»¶ç»“æ„</p></center><p>å³å‡»<code>com.example.activitytest</code>åŒ…-&gt;<code>New</code>-&gt;<code>Activity</code>-&gt;<code>Empty Activity</code>ï¼Œä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œå…¶ä¸­ Generate LayoutFile ä¼šåœ¨<code>app/src/main/res</code>ç›®å½•ä¸­ä¸ºè¯¥æ´»åŠ¨è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ layout çš„ xml æ–‡ä»¶ï¼›Launcher Activity ä¼šå°†è¯¥æ´»åŠ¨è®¾ç½®ä¸ºç¨‹åºè¿è¡Œæ—¶é¦–å…ˆåŠ è½½çš„æ´»åŠ¨ï¼Œå³å½“å‰é¡¹ç›®çš„ä¸»æ´»åŠ¨ã€‚</p><h2 id="åˆ›å»ºå’ŒåŠ è½½å¸ƒå±€"><a href="#åˆ›å»ºå’ŒåŠ è½½å¸ƒå±€" class="headerlink" title="åˆ›å»ºå’ŒåŠ è½½å¸ƒå±€"></a>åˆ›å»ºå’ŒåŠ è½½å¸ƒå±€</h2><p>å³å‡»<code>app/src/main/res</code>ç›®å½•-&gt;<code>New</code>-&gt;<code>Directory</code>ï¼Œå¯åˆ›å»ºä¸€ä¸ªåä¸º layout çš„ç›®å½•ï¼Œè€Œåå³å‡»è¯¥ç›®å½•ï¼Œå³å¯æ–°å»ºå¸ƒå±€æ–‡ä»¶ã€‚</p><h3 id="æ·»åŠ æŒ‰é’®"><a href="#æ·»åŠ æŒ‰é’®" class="headerlink" title="æ·»åŠ æŒ‰é’®"></a>æ·»åŠ æŒ‰é’®</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button_1"</span> // å®šä¹‰<span class="attr">id</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span> // è¡¨ç¤ºå’Œçˆ¶å…ƒç´ ä¸€æ ·å®½</span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> // è¡¨ç¤ºå½“å‰å…ƒç´ çš„é«˜åº¦æ°å¥½åŒ…å«é‡Œé¢å†…å®¹</span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Button_1"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.activitytest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="comment">// æœ¬è¡Œå°†layoutçš„idä¼ å…¥ï¼Œä¸ºå½“å‰æ´»åŠ¨åŠ è½½å¸ƒå±€</span></span><br><span class="line">        setContentView(R.layout.thirt_layout); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åœ¨AndroidManifestæ–‡ä»¶æ³¨å†Œ"><a href="#åœ¨AndroidManifestæ–‡ä»¶æ³¨å†Œ" class="headerlink" title="åœ¨AndroidManifestæ–‡ä»¶æ³¨å†Œ"></a>åœ¨AndroidManifestæ–‡ä»¶æ³¨å†Œ</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">package</span>=<span class="string">"com.example.activitytest"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">"@mipmap/ic_launcher_round"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">".FirstActivity"</span> // æŒ‡å®šæ³¨å†Œæ´»åŠ¨ </span></span><br><span class="line"><span class="tag">            <span class="attr">android:label</span>=<span class="string">"This is FirstActivity"</span> &gt;</span> // æŒ‡å®šæ´»åŠ¨æ ‡é¢˜æ å†…å®¹</span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">            // ä»¥ä¸‹ä¸¤è¡Œå°†æ´»åŠ¨é…ç½®ä¸ºä¸»æ´»åŠ¨</span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ToaståŠæŒ‰é’®å“åº”"><a href="#ToaståŠæŒ‰é’®å“åº”" class="headerlink" title="ToaståŠæŒ‰é’®å“åº”"></a>ToaståŠæŒ‰é’®å“åº”</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Toast.makeText(FirstActivity.<span class="keyword">this</span>, <span class="string">"You clicked Button_1!"</span>,</span><br><span class="line">                    Toast.LENGTH_SHORT).show();            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ findViewById() æ–¹æ³•è·å–åˆ°å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰çš„å…ƒç´ ï¼Œè¿™é‡Œä¼ å…¥ R.id.button_1 æ¥å¾—åˆ°æŒ‰é’®çš„å®ä¾‹ï¼Œè€Œåæ³¨å†Œç›‘å¬å™¨ã€‚</p><p>Toast ä¸­ makeText æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ Contextï¼ˆæ´»åŠ¨æ˜¯ä¸€ç§ä¸Šä¸‹æ–‡ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ Toast æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯æŒç»­æ—¶é•¿ã€‚æ³¨æ„ï¼Œåªæœ‰åŠ ä¸Šåé¢çš„ .show() ï¼ŒToast æ‰ä¼šæ˜¾ç¤ºã€‚</p><h3 id="Menu"><a href="#Menu" class="headerlink" title="Menu"></a>Menu</h3><p>ä½¿ç”¨ Android æä¾›çš„æ–¹å¼åˆ›å»ºèœå•ã€‚èœå•é€šè¿‡åº”ç”¨å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹çš„å°æŒ‰é’®ï¼Œä»¥åˆ—è¡¨å½¢å¼æ˜¾ç¤ºã€‚</p><h4 id="åˆ›å»ºèœå•"><a href="#åˆ›å»ºèœå•" class="headerlink" title="åˆ›å»ºèœå•"></a>åˆ›å»ºèœå•</h4><p>å³å‡»<code>app/src/main/res</code>ç›®å½•-&gt;<code>New</code>-&gt;<code>Directory</code>ï¼Œåˆ›å»ºåä¸º menu çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º main çš„èœå•æ–‡ä»¶ï¼ˆå³å‡»<code>menu</code>-&gt;<code>New</code>-&gt;<code>Menu resource file</code>ï¼‰ã€‚</p><p>åœ¨<code>main.xml</code>æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@+id/add_item"</span>// æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"Add"</span> // åç§°</span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@+id/remove_item"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"Remove"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>item</code>æ ‡ç­¾ç”¨æ¥åˆ›å»ºå…·ä½“çš„èœå•é¡¹ã€‚</p><p>è€Œååœ¨<code>FirstActivity</code>ä¸­é‡å†™å‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span></span>&#123;</span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºèµ„æºæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªæŒ‡å®šæ·»åŠ åˆ°çš„Menuå¯¹è±¡</span></span><br><span class="line">    getMenuInflater().inflate(R.menu.main, menu); </span><br><span class="line">    <span class="comment">// è¡¨ç¤ºæ˜¯å¦å…è®¸æ˜¾ç¤ºèœå•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="èœå•å“åº”"><a href="#èœå•å“åº”" class="headerlink" title="èœå•å“åº”"></a>èœå•å“åº”</h4><p>åœ¨<code>FirstActivity</code>ä¸­é‡å†™å‡½æ•°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onOptionsItemSelected</span><span class="params">(@NonNull MenuItem item)</span> </span>&#123;</span><br><span class="line"><span class="comment">// åˆ¤æ–­ç‚¹å‡»çš„èœå•é¡¹</span></span><br><span class="line">    <span class="keyword">switch</span> (item.getItemId())&#123;</span><br><span class="line">        <span class="keyword">case</span> R.id.add_item:</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">"You clicked Add"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> R.id.remove_item:</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">"You clicked Remove"</span>,Toast.LENGTH_LONG).show();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é”€æ¯æ´»åŠ¨"><a href="#é”€æ¯æ´»åŠ¨" class="headerlink" title="é”€æ¯æ´»åŠ¨"></a>é”€æ¯æ´»åŠ¨</h3><p>åœ¨æ¨¡æ‹Ÿå™¨ä¸­æŒ‰ä¸‹ Back é”®ï¼Œæˆ–è°ƒç”¨<code>finish()</code>æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            finish()            &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨Intentåˆ‡æ¢æ´»åŠ¨"><a href="#ä½¿ç”¨Intentåˆ‡æ¢æ´»åŠ¨" class="headerlink" title="ä½¿ç”¨Intentåˆ‡æ¢æ´»åŠ¨"></a>ä½¿ç”¨Intentåˆ‡æ¢æ´»åŠ¨</h2><h3 id="æ˜¾å¼Intent"><a href="#æ˜¾å¼Intent" class="headerlink" title="æ˜¾å¼Intent"></a>æ˜¾å¼Intent</h3><p>åˆ›å»ºç¬¬äºŒä¸ªæ´»åŠ¨ï¼Œåä¸º SecondActivityã€‚</p><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä¼ å…¥ FirstActivity.this ä½œä¸ºä¸Šä¸‹æ–‡ï¼ŒSecondActivity.classä¸ºç›®æ ‡æ´»åŠ¨</span></span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éšå¼Intent"><a href="#éšå¼Intent" class="headerlink" title="éšå¼Intent"></a>éšå¼Intent</h3><p>é€šè¿‡<code>AndroidManifest.xml</code>ä¸­çš„<code>activity</code>æ ‡ç­¾ä¸‹é…ç½®<code>&lt;intent-filter&gt;</code>å†…å®¹ï¼Œå¯ä»¥æŒ‡å®šå½“å‰æ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ action å’Œ categoryã€‚åªæœ‰<code>&lt;action&gt;</code>å’Œ<code>&lt;category&gt;</code>ä¸­çš„å†…å®¹èƒ½å¤ŸåŒæ—¶åŒ¹é… Intent æŒ‡å®šçš„å†…å®¹æ—¶ï¼Œæ´»åŠ¨æ‰èƒ½å“åº”ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".SecondActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.ACTION_START"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.example.activitytest.ACTION_START"</span>);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¢åŠ Category"><a href="#å¢åŠ Category" class="headerlink" title="å¢åŠ Category"></a>å¢åŠ Category</h4><p>åœ¨<code>AndroidManifest</code>ä¸­é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".SecondActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.ACTION_START"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">        // ä¸æ·»åŠ ä¸‹è¡Œä»£ç å°†å¯¼è‡´ç¨‹åºå´©æºƒ</span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"com.example.activitytest.MY_CATEGORY"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.example.activitytest.ACTION_START"</span>);</span><br><span class="line">            intent.addCategory(<span class="string">"com.example.activitytest.MY_CATEGORY"</span>);</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–Intentç”¨æ³•"><a href="#å…¶ä»–Intentç”¨æ³•" class="headerlink" title="å…¶ä»–Intentç”¨æ³•"></a>å…¶ä»–Intentç”¨æ³•</h3><h4 id="å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åº"><a href="#å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åº" class="headerlink" title="å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åº"></a>å¯åŠ¨å…¶ä»–åº”ç”¨ç¨‹åº</h4><p>ä¿®æ”¹<code>FirstActivity</code>ä¸­çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.first_layout);</span><br><span class="line">    Button button1 = (Button) findViewById(R.id.button_1);</span><br><span class="line">    button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">            Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šâ€œhttp://â€ ä¸èƒ½çœç•¥</span></span><br><span class="line">            intent.setData(Uri.parse(<span class="string">"http://ww.baidu.com"</span>));</span><br><span class="line">            startActivity(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç‚¹å‡»æŒ‰é’®å¯è·³è½¬è‡³æµè§ˆå™¨æ‰“å¼€ â€œ<a href="http://www.baidu.com&quot;ã€‚" target="_blank" rel="noopener">www.baidu.com&quot;ã€‚</a></p><p>åœ¨<code>AndroidManifest</code>ä¸­çš„<code>&lt;intent-filter&gt;</code>æ ‡ç­¾é…ç½®<code>&lt;data&gt;</code>æ ‡ç­¾ï¼Œå¯æŒ‡å®šæ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ç±»å‹æ•°æ®ã€‚<code>&lt;data&gt;</code>æ ‡ç­¾ä¸»è¦å¯é…ç½®ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>android:scheme åè®®ï¼Œå¦‚ http</li><li>android:host ä¸»æœºå</li><li>android:port ç«¯å£</li><li>android:path ä»¥ä¸Šä¹‹åçš„éƒ¨åˆ†</li><li>android:mimeType å¯å¤„ç†çš„æ•°æ®ç±»å‹</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".ThirdActivity"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.VIEW"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:scheme</span>=<span class="string">"http"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“å‰æ´»åŠ¨èƒ½å¤Ÿå“åº”çš„ action æ˜¯ Intent.ACTION_VIEW çš„å¸¸é‡å€¼ï¼Œæ•°æ®åè®®å¿…é¡»æ˜¯ httpã€‚åœ¨ç‚¹å‡»æŒ‰é’®åï¼Œè¯¥æ´»åŠ¨ä¹Ÿèƒ½å“åº”Intentï¼š</p><center><img src="//rootreturn0.github.io/2019/10/18/Androidå­¦ä¹ ç¬”è®°-Activity/é€‰æ‹©å“åº”Intentçš„ç¨‹åº.png" width="400" hegiht="600" align="center"><p>é€‰æ‹©å“åº”Intentçš„ç¨‹åº</p></center><p><strong>ä»ç”¨æˆ·ä½“éªŒçš„è§’åº¦æ¥çœ‹ï¼Œå¦‚æœæ´»åŠ¨æœ¬èº«ä¸å…·å¤‡åŠ è½½å¹¶æ˜¾ç¤ºçš„ç½‘é¡µçš„åŠŸèƒ½ï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆç”¨å•Šï¼ï¼ï¼</strong></p><p>é™¤ http åè®®å¤–ï¼Œè¿˜æœ‰è®¸å¤š Uri åè®®ï¼Œå¸¸ç”¨çš„ Uri åè®®è§ <a href="https://blog.csdn.net/sinat_38239454/article/details/78937999" target="_blank" rel="noopener">&lt;&lt;Android å¸¸ç”¨URI å€¼å¾—è®°ä½&gt;&gt;</a>ã€‚</p><h3 id="ä¼ é€’æ•°æ®"><a href="#ä¼ é€’æ•°æ®" class="headerlink" title="ä¼ é€’æ•°æ®"></a>ä¼ é€’æ•°æ®</h3><p>Intent ä¸­æä¾›äº†ä¸€ç³»åˆ— <code>putExtra()</code> æ–¹æ³•çš„é‡è½½ï¼Œå¯ä»¥å°†æƒ³è¦ä¼ é€’çš„æ•°æ®æš‚å­˜åœ¨ Intent ä¸­ã€‚å½“å¯åŠ¨å¦ä¸€ä¸ª Intent åï¼Œåªéœ€è¦æŠŠè¿™äº›æ•°æ®å†ä» Intent ä¸­å–å‡ºå³å¯ã€‚</p><h4 id="å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®"><a href="#å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®" class="headerlink" title="å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®"></a>å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®</h4><p>å‡è®¾ FirstActivity ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç°åœ¨æƒ³æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¼ é€’åˆ° SecondActivity ä¸­ï¼Œå¯ä»¥è¿™æ ·ç¼–å†™ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        String data = <span class="string">"Hello SecondActivity"</span>;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”®ï¼Œç”¨äºä¹‹åå–å€¼ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦ä¼ é€’çš„æ•°æ®</span></span><br><span class="line">        intent.putExtra(<span class="string">"extra_data"</span>,data);</span><br><span class="line">        startActivity(intent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>SecondActivity ä¸­æ¥æ”¶ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_second);</span><br><span class="line">        <span class="comment">// è·å–ç”¨äºå¯åŠ¨ SecondActivity çš„Intent</span></span><br><span class="line">        Intent intent = getIntent();</span><br><span class="line">        <span class="comment">/** </span></span><br><span class="line"><span class="comment">         * getStringExtra() è·å–å­—ç¬¦ä¸²æ•°æ®ï¼›</span></span><br><span class="line"><span class="comment">         * å¦‚æœæ˜¯æ•´å‹æ•°æ®åˆ™ç”¨ getIntExtra()ï¼›</span></span><br><span class="line"><span class="comment">         * å¦‚æœæ˜¯å¸ƒå°”æ•°æ®åˆ™ç”¨ getBooleanExtra()ï¼›</span></span><br><span class="line"><span class="comment">         * ä»¥æ­¤ç±»æ¨ã€‚</span></span><br><span class="line"><span class="comment">         * /</span></span><br><span class="line"><span class="comment">        String data = intent.getStringExtra("extra_data");</span></span><br><span class="line"><span class="comment">        Log.d("SecondActivity",data);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨"><a href="#è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨" class="headerlink" title="è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨"></a>è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨</h4><p>Activity ä¸­è¿˜æœ‰ä¸€ä¸ª<code>startActivityForResult()</code>æ–¹æ³•ä¹Ÿå¯ä»¥å¯åŠ¨æ´»åŠ¨ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ–¹æ³•æœŸæœ›åœ¨æ´»åŠ¨é”€æ¯æ—¶èƒ½è¿‡è¿”å›ç»“æœç»™ä¸Šä¸€ä¸ªæ´»åŠ¨ã€‚è¦æƒ³è¿”å›æ•°æ®ï¼Œåˆ™éœ€è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">button1.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(FirstActivity.<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">"extra_data"</span>,data);</span><br><span class="line">        <span class="comment">/** </span></span><br><span class="line"><span class="comment">         * ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯intentï¼›</span></span><br><span class="line"><span class="comment">         * ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯·æ±‚ç ï¼Œç”¨äºåœ¨ä¹‹åçš„å›è°ƒä¸­åˆ¤æ–­æ•°æ®çš„æ¥æºï¼Œ</span></span><br><span class="line"><span class="comment">         * è¯·æ±‚ç åªè¦æ˜¯ä¸€ä¸ªå”¯ä¸€å€¼å°±è¡Œã€‚</span></span><br><span class="line"><span class="comment">         * /</span></span><br><span class="line"><span class="comment">        startActivityForResult(intent, 1);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;);</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬”è®°åŸºäº&lt;a href=&quot;https://me.csdn.net/sinyu890807&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éƒ­éœ–å¤§ç¥&lt;/a&gt;æ‰€è‘—çš„&lt;a href=&quot;https://blog.csdn.net/guolin_blog/article/details/52032038&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬äºŒç‰ˆ&lt;/a&gt;ä¹‹ç¬¬2ç« ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨çš„IDEï¼šAndroid Studio&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹é¡¹ç›®åï¼šActivityTest&lt;/li&gt;
&lt;li&gt;åŒ…åï¼šâ€œcom.example.avtivitytestâ€&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Android" scheme="http://rootreturn0.github.io/categories/Android/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>Haydn</title>
    <link href="http://rootreturn0.github.io/2019/10/08/Haydn/"/>
    <id>http://rootreturn0.github.io/2019/10/08/Haydn/</id>
    <published>2019-10-07T18:12:49.000Z</published>
    <updated>2019-10-18T17:10:41.363Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶å¹¶éæ¬¢å¿«åœ°è·³è·ƒç€çš„ã€‚</p><p>ä½†å´ä¾æ—§èˆ’ç¼“äººç–²æƒ«çš„å¿ƒçµã€‚</p><p>éå±±æ²³å£®é˜”ï¼Œ</p><p>éäººé—´æ˜Ÿç«ï¼Œ</p><p>éå¤©å¤–é£ä»™ã€‚</p><p>è€Œæ˜¯æµæ·Œåœ¨æ˜¥å¤©çš„ç”Ÿæ­»æ˜ç­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ‰æ—¶å¹¶éæ¬¢å¿«åœ°è·³è·ƒç€çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†å´ä¾æ—§èˆ’ç¼“äººç–²æƒ«çš„å¿ƒçµã€‚&lt;/p&gt;
&lt;p&gt;éå±±æ²³å£®é˜”ï¼Œ&lt;/p&gt;
&lt;p&gt;éäººé—´æ˜Ÿç«ï¼Œ&lt;/p&gt;
&lt;p&gt;éå¤©å¤–é£ä»™ã€‚&lt;/p&gt;
&lt;p&gt;è€Œæ˜¯æµæ·Œåœ¨æ˜¥å¤©çš„ç”Ÿæ­»æ˜ç­ã€‚&lt;/p&gt;

      
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>H</title>
    <link href="http://rootreturn0.github.io/2019/10/07/H/"/>
    <id>http://rootreturn0.github.io/2019/10/07/H/</id>
    <published>2019-10-07T09:33:27.000Z</published>
    <updated>2019-10-18T17:56:40.503Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚">    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      A normal dream
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>R</title>
    <link href="http://rootreturn0.github.io/2019/10/07/C/"/>
    <id>http://rootreturn0.github.io/2019/10/07/C/</id>
    <published>2019-10-07T09:28:19.000Z</published>
    <updated>2019-10-18T17:10:32.520Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ›¾ç»æœ€ä½è°·çš„æ—¶å€™ï¼ˆæå°å€¼ï¼‰ï¼Œ</p><p>å¥¹æ¿€åŠ±äº†æˆ‘ï¼›</p><p>åœ¨ç°åœ¨æœ€åº•è°·çš„æ—¶å€™ï¼ˆæå°å€¼ï¼‰ï¼Œ</p><p>å¥¹å®‰æ…°äº†æˆ‘ã€‚</p><br><p>æœç„¶æ˜¯æˆ‘ç”Ÿå‘½ä¸­é‡è¦çš„ä¸€ä¸ªäººï¼ˆç¬‘</p><br><p><strong><em>CAUSE AND CONSEQUENCE</em></strong></p>]]></content>
    
    <summary type="html">
    
      Important one.
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>çŸ¥è¶³å¸¸ä¹</title>
    <link href="http://rootreturn0.github.io/2019/10/07/About%20Alessa0/"/>
    <id>http://rootreturn0.github.io/2019/10/07/About Alessa0/</id>
    <published>2019-10-06T17:42:10.000Z</published>
    <updated>2019-10-18T17:16:31.144Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="English & You">    <label for="pass">English & You</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Compare
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Soul-like</title>
    <link href="http://rootreturn0.github.io/2019/10/06/soul-like/"/>
    <id>http://rootreturn0.github.io/2019/10/06/soul-like/</id>
    <published>2019-10-05T16:24:23.000Z</published>
    <updated>2019-10-18T17:09:49.729Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚">    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">U2FsdGVkX1/RyHcEpBJKf9SMOR0SrMZ6ooOwNSGsgljtfGpRPglAmYArJIUpSlHsZkftAoTySAwi5IYPhha37tbm0st0T1Tq35xZK7pIXpyzuXkyzv6uMgKOiSKsR0890/ZVUSTMzNWv5i2SVHd3hmkFnip3L3SKi71MsrAClFUWLM1ieGaAyjHp53YYYjJqZS24zFJKEQ3O941j/v/EyG4A+dt0LwjDCyUTsrSzDnigrW8cW9TiwhvtznKM+2t0D6xW5HIRLlem6xfxOWY8uxSy4R7tkI8oYmS133VX2BjQsse7ATvo0xiU9DvrQZq2jk75qb5T/1qU0gpvSZYeymrv7ZKgSh5+4ib4qoac88/4SNE+Q1yyuy7RIWfU1tMPX/qdDqBmM/QrWKl+fxJuQEWirM7Iu2P/NttIWq492y9mez6sVyjR42q4vhCNYJ7h+jXkIqGt0ETNutl26VGAE5TjjiQE5l5BDrffYNyTblOmj0V346yXSSuoZ1dlPtjoZGk8jQO+ldXGwbROvOC1mI4oP8CB/YSruOO652wnoyArM+UKS7bRZPuqLcG5j5Af5QFim0b/q+XH6h8NLUUjgNdS5yV/UcayJweBWyygVZJvewLQDoGb/kaKZg7iIScfqMLWQtG77Ph4FkMBbbpuB33hN0Lhhh8mKz2FUw9CFPDJq1TtzpiqTc8rfeewkEXr2Dtr+HXEfp5iNsdxbQfj+Q==</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Ashen one
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>xv6-è°ƒåº¦</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E8%B0%83%E5%BA%A6/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-è°ƒåº¦/</id>
    <published>2019-08-31T10:50:22.000Z</published>
    <updated>2019-10-18T17:14:32.392Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è°ƒåº¦"><a href="#è°ƒåº¦" class="headerlink" title="è°ƒåº¦"></a>è°ƒåº¦</h2><p>ç”±äºå¯èƒ½åŒæ—¶æœ‰å¤šä¸ªCPUè¯·æ±‚è¿›è¡Œè°ƒåº¦ï¼Œæ•…éœ€è¦è¿›ç¨‹è¡¨é”<code>ptable.lock</code>æ¥é¿å…ç«äº‰ã€‚</p><p>å› æ­¤ï¼Œè¿›ç¨‹åœ¨è®©å‡ºCPUå‰ï¼Œå¿…é¡»è¦è·å¾—è¿›ç¨‹è¡¨é”ï¼Œå¹¶é‡Šæ”¾å…¶æ‹¥æœ‰çš„å…¶ä»–é”ï¼ˆé¿å…åŒæ—¶æŒæœ‰å¤šä¸ªé”å¯¼è‡´æ­»é”ï¼‰ï¼Œä¿®æ”¹è‡ªå·±çš„çŠ¶æ€<code>proc-&gt;state</code>ï¼Œç„¶åè¿›è¡Œè°ƒåº¦ã€‚</p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>ä»¥ä¸‹å‡½æ•°ä½äºä»£ç æ–‡ä»¶<code>proc.c</code>ä¸­ã€‚</p><h4 id="sched"><a href="#sched" class="headerlink" title="sched"></a>sched</h4><p>è¿›ç¨‹è¿›å…¥è°ƒåº¦å™¨ï¼Œä¸”å¿…é¡»æŒæœ‰è¿›ç¨‹è¡¨é”å¹¶æ”¹å˜è¿›ç¨‹çŠ¶æ€ã€‚ç”±äºè¿›ç¨‹æ­¤æ—¶æŒæœ‰è¿›ç¨‹è¡¨é”ï¼Œæ‰€ä»¥CPUåº”è¯¥æ˜¯åœ¨å…³ä¸­æ–­çš„æƒ…å†µä¸‹è¿è¡Œã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">sched(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> intena;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">proc</span> *<span class="title">p</span> = <span class="title">myproc</span>();</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœªæŒæœ‰è¿›ç¨‹è¡¨é”ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holding(&amp;ptable.lock))</span><br><span class="line">    panic(<span class="string">"sched ptable.lock"</span>);</span><br><span class="line">  <span class="comment">// å¤„äºé”çŠ¶æ€ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(mycpu()-&gt;ncli != <span class="number">1</span>)</span><br><span class="line">    panic(<span class="string">"sched locks"</span>);</span><br><span class="line">  <span class="comment">// è¿›ç¨‹å¤„äºè¿è¡Œæ€ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(p-&gt;state == RUNNING)</span><br><span class="line">    panic(<span class="string">"sched running"</span>);</span><br><span class="line">  <span class="comment">// å¼€ä¸­æ–­ï¼Œä¸å¯æ‰§è¡Œmycpu()å‡½æ•°ï¼Œä¸åº”è¿›å…¥è°ƒåº¦ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(readeflags()&amp;FL_IF)</span><br><span class="line">    panic(<span class="string">"sched interruptible"</span>);</span><br><span class="line">  intena = mycpu()-&gt;intena; <span class="comment">// æš‚å­˜çŠ¶æ€</span></span><br><span class="line">  swtch(&amp;p-&gt;context, mycpu()-&gt;scheduler); <span class="comment">// ä¿å­˜å½“å‰ä¸Šä¸‹æ–‡ï¼Œå¹¶åˆ‡æ¢åˆ°ä¹‹å‰ä¿å­˜çš„è°ƒåº¦å™¨çš„ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥è°ƒåº¦å™¨</span></span><br><span class="line">  mycpu()-&gt;intena = intena; <span class="comment">// æ¢å¤çŠ¶æ€</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="yield"><a href="#yield" class="headerlink" title="yield"></a>yield</h4><p>åœ¨xv6ä¸­ï¼Œä½¿ç”¨æ—¶é—´ç‰‡è½®è½¬æ³•è¿›è¡Œè°ƒåº¦ã€‚å½“è¿›ç¨‹ç”¨å®Œå®ƒçš„CPUæ—¶é—´ç‰‡æ—¶ï¼Œæ—¶é’Ÿä¸­æ–­ä¼šè°ƒç”¨<code>yield</code>å‡½æ•°æ¥è®©å‡ºCPUç»™æ–°çš„è¿›ç¨‹ï¼Œ<code>yield</code>è°ƒç”¨<code>sched</code>å‡½æ•°ï¼Œ<code>sched</code>è°ƒç”¨<code>swtch</code>æ¥åˆ‡æ¢éƒ½è°ƒåº¦å™¨çº¿ç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">yield(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  acquire(&amp;ptable.lock);  <span class="comment">//DOC: yieldlock è¯·æ±‚è¿›ç¨‹è¡¨é”</span></span><br><span class="line">  myproc()-&gt;state = RUNNABLE; <span class="comment">// åˆ‡æ¢è¿›ç¨‹çŠ¶æ€</span></span><br><span class="line">  sched(); </span><br><span class="line">  release(&amp;ptable.lock); <span class="comment">// é‡Šæ”¾è¿›ç¨‹è¡¨é”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="scheduler"><a href="#scheduler" class="headerlink" title="scheduler"></a>scheduler</h4><p>æ¯ä¸ªCPUåœ¨è®¾ç½®å®Œæˆè‡ªå·±ä¹‹åè°ƒç”¨<code>scheduler</code>ã€‚</p><p>è°ƒåº¦å™¨<code>scheduler</code>æ°¸è¿œä¸ä¼šè¿”å›ï¼Œè€Œæ˜¯ä¸æ–­å¾ªç¯ã€‚å¾ªç¯æ­¥éª¤ä¸ºï¼š</p><ol><li>é€‰æ‹©è¦è¿è¡Œçš„æµç¨‹</li><li>swtchå¼€å§‹è¿è¡Œè¯¥è¿‡ç¨‹</li><li>æœ€ç»ˆè¯¥è¿‡ç¨‹é€šè¿‡swtchå°†æ§åˆ¶è½¬ç§»å›è°ƒåº¦ç¨‹åºã€‚</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">scheduler(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">proc</span> *<span class="title">p</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">cpu</span> *<span class="title">c</span> = <span class="title">mycpu</span>();</span></span><br><span class="line">  c-&gt;proc = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// ä¸æ–­å¾ªç¯ï¼Œæ°¸ä¸åœæ­¢</span></span><br><span class="line">  <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">    <span class="comment">// å¼€ä¸­æ–­ï¼Œä»¥å…è®¸I/Oåˆ°è¾¾</span></span><br><span class="line">    sti();  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è¿›ç¨‹è¡¨ä¸Šä¸æ–­å¾ªç¯ï¼Œå¯»æ‰¾è¿›ç¨‹å¹¶è¿è¡Œ</span></span><br><span class="line">    acquire(&amp;ptable.lock); <span class="comment">// è¯·æ±‚è¿›ç¨‹è¡¨é”</span></span><br><span class="line">    <span class="keyword">for</span>(p = ptable.proc; p &lt; &amp;ptable.proc[NPROC]; p++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(p-&gt;state != RUNNABLE) <span class="comment">// è¿›ç¨‹ä¸å¯è¿è¡Œï¼Œè½¬åˆ°ä¸‹ä¸€ä¸ªè¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Switch to chosen process.  It is the process's job</span></span><br><span class="line">      <span class="comment">// to release ptable.lock and then reacquire it</span></span><br><span class="line">      <span class="comment">// before jumping back to us.</span></span><br><span class="line">      <span class="comment">// åˆ‡æ¢åˆ°é€‰å®šçš„è¿›ç¨‹</span></span><br><span class="line">      c-&gt;proc = p;</span><br><span class="line">      switchuvm(p); <span class="comment">// åˆ‡æ¢åˆ°è¯¥è¿›ç¨‹çš„é¡µè¡¨</span></span><br><span class="line">      p-&gt;state = RUNNING;</span><br><span class="line"></span><br><span class="line">      swtch(&amp;(c-&gt;scheduler), p-&gt;context); <span class="comment">// åˆ‡æ¢åˆ°è¯¥è¿›ç¨‹è¿è¡Œ</span></span><br><span class="line">      switchkvm(); <span class="comment">// å½“æ²¡æœ‰è¿›ç¨‹æ­£åœ¨è¿è¡Œæ—¶ï¼Œå°†é¡µè¡¨å¯„å­˜å™¨åˆ‡æ¢åˆ°ä»…å†…æ ¸é¡µè¡¨ã€‚</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// Process is done running for now.</span></span><br><span class="line">      <span class="comment">// It should have changed its p-&gt;state before coming back.</span></span><br><span class="line">      <span class="comment">// è¿›ç¨‹å·²ç»“æŸè¿è¡Œï¼Œæ”¹å˜è‡ªèº«çŠ¶æ€</span></span><br><span class="line">      c-&gt;proc = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    release(&amp;ptable.lock); <span class="comment">// é‡Šæ”¾è¿›ç¨‹è¡¨é”ï¼Œé˜²æ­¢å…¶ä»–CPUæ— æ³•è¿›è¡Œè°ƒåº¦</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é”ä¸ä¸­æ–­"><a href="#é”ä¸ä¸­æ–­" class="headerlink" title="é”ä¸ä¸­æ–­"></a>é”ä¸ä¸­æ–­</h3><h4 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h4><ul><li>ä¸ºä¿è¯è¿›ç¨‹çŠ¶æ€çš„ä¸Šä¸‹æ–‡åœ¨è¿è¡Œ<code>swtch</code>æ—¶ä¿æŒä¸å˜ï¼šè¿›ç¨‹è¡¨é”ç”±æ—§è¿›ç¨‹è·å¾—ï¼Œæ–°è¿›ç¨‹é‡Šæ”¾ã€‚</li><li>ä¸ºé˜²æ­¢å…¶ä»–CPUé—²ç½®æ—¶é”è¢«å½“å‰CPUå æœ‰è€Œæ— æ³•è°ƒåº¦ï¼Œå…¶ä»–CPUä¸Šè¿è¡Œè¿›ç¨‹æ— æ³•è®©å‡ºCPUï¼Œå¯¼è‡´æ­»é”çš„æƒ…å†µï¼šåœ¨éå†ä¸€æ¬¡è¿›ç¨‹è¡¨åæ€»è¦é‡Šæ”¾é”ã€‚</li></ul><h4 id="ä¸­æ–­"><a href="#ä¸­æ–­" class="headerlink" title="ä¸­æ–­"></a>ä¸­æ–­</h4><ul><li>ä¸ºé˜²æ­¢æ‰€æœ‰è¿›ç¨‹éƒ½åœ¨ç­‰å¾…I/Oæ—¶å…³ä¸­æ–­å¯¼è‡´çš„I/Oæ— æ³•åˆ°è¾¾å¼•å‘çš„æ­»é”ï¼Œè°ƒåº¦å™¨åœ¨æ¯æ¬¡å¾ªåå¼€å§‹å‰è¿›è¡Œå¼€ä¸­æ–­ã€‚</li></ul><h2 id="ç¡çœ ä¸å”¤é†’"><a href="#ç¡çœ ä¸å”¤é†’" class="headerlink" title="ç¡çœ ä¸å”¤é†’"></a>ç¡çœ ä¸å”¤é†’</h2><p>å‡½æ•°<code>sleep</code>å’Œ<code>wakeup</code>ä½äºä»£ç æ–‡ä»¶<code>proc.c</code>ä¸­ã€‚</p><p>ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ æˆ–è¿›è¡Œå”¤é†’å‡éœ€è¦æ”¹å˜è¿›ç¨‹çŠ¶æ€ï¼Œæ•…éœ€è¦è¿›ç¨‹è¡¨é”ä»¥ä¿è¯çŠ¶æ€ä¿®æ”¹çš„åŸå­æ€§ã€‚å…¶ä¸­å‡½æ•°<code>sleep</code>è¦åœ¨ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ å‰è·å–è¿›ç¨‹è¡¨é”ï¼Œä»¥ä¿è¯åœ¨ä½¿å‡½æ•°è¿›å…¥ç¡çœ æ—¶è‡³å°‘æŒæœ‰ä¸€ä¸ªé”ï¼Œé˜²æ­¢<code>wakeup</code>åœ¨è¿›ç¨‹è¿›å…¥ç¡çœ å‰è¢«è°ƒç”¨å¯¼è‡´çš„æ­»é”ã€‚å½“<code>sleep</code>æœ¬èº«æŒæœ‰çš„é”ä¸ºè¿›ç¨‹è¡¨é”æ—¶ï¼Œåˆ™ç•¥è¿‡è¯·æ±‚è¿™ä¸€æ­¥ï¼Œé˜²æ­¢æ­»é”ã€‚</p><h2 id="å¯æ”¹è¿›ä¹‹å¤„"><a href="#å¯æ”¹è¿›ä¹‹å¤„" class="headerlink" title="å¯æ”¹è¿›ä¹‹å¤„"></a>å¯æ”¹è¿›ä¹‹å¤„</h2><h3 id="è°ƒåº¦-1"><a href="#è°ƒåº¦-1" class="headerlink" title="è°ƒåº¦"></a>è°ƒåº¦</h3><ul><li>è½®è½¬æ³•æ— ä¼˜å…ˆçº§çš„åŒºåˆ†</li></ul><p>ä¼šå¯¼è‡´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹æ— æ³•ä¼˜å…ˆè¿è¡Œï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¿è¡Œæ—¶é—´çš„å¢åŠ ï¼Œå½±å“ä½¿ç”¨è€…åœ¨å®é™…ä½¿ç”¨æ—¶çš„ä½“éªŒã€‚å¯ä½¿ç”¨å…¶ä»–è¾ƒä¸ºå¤æ‚çš„ç®—æ³•ï¼Œå¦‚é«˜å“åº”æ¯”ä¼˜å…ˆç®—æ³•ç­‰ä»¥æ”¹è¿›ä½“éªŒã€‚</p><h3 id="ç¡çœ ä¸å”¤é†’-1"><a href="#ç¡çœ ä¸å”¤é†’-1" class="headerlink" title="ç¡çœ ä¸å”¤é†’"></a>ç¡çœ ä¸å”¤é†’</h3><ul><li>å”¤é†’éœ€è¦éå†è¿›ç¨‹è¡¨</li></ul><p>åœ¨è¿›ç¨‹æ•°é‡å¤§çš„æ—¶å€™è¿™ç§åšæ³•æ•ˆç‡æä½ã€‚ä½¿ç”¨å¦ä¸€ä¸ªç»“æ„ä½“æ¥ç»´æŠ¤é“¾è¡¨å¯å¤§å¤§æé«˜æ•ˆç‡ã€‚</p><ul><li>å”¤é†’æ—¶ä¼šå”¤é†’é˜Ÿåˆ—ä¸­å…¨éƒ¨è¿›ç¨‹</li></ul><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŒä¸€æ—¶é—´éœ€è¦å”¤é†’çš„è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¸­æ˜¯å°‘æ•°éƒ¨åˆ†ï¼Œè®¸å¤šä»éœ€ç­‰å¾…çš„è¿›ç¨‹å°†ä¼šè¢«â€œè«åå…¶å¦™â€åœ°å”¤é†’å¹¶å†åº¦æ£€æŸ¥çŠ¶æ€é‡æ–°è¿›å…¥ç¡çœ ï¼Œå¯¼è‡´æ“ä½œç³»ç»Ÿéœ€è¦å¤„ç†è®¸å¤šæ–°çš„ä¸å¿…è¦çš„ä»»åŠ¡ã€‚</p><p>å”¤é†’æ—¶åº”åˆ†ä¸ºä¸ªä½“å”¤é†’ï¼ˆå”¤é†’å•ä¸ªè¿›ç¨‹ï¼‰å’Œç¾¤ä½“å”¤é†’ï¼ˆå”¤é†’æ‰€æœ‰è¿›ç¨‹ï¼‰ï¼Œå‡å°‘ç³»ç»Ÿè´Ÿæ‹…ã€‚</p>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹è°ƒåº¦æºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>xv6-ç®¡é“</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E7%AE%A1%E9%81%93/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-ç®¡é“/</id>
    <published>2019-08-31T00:29:38.000Z</published>
    <updated>2019-10-18T17:14:24.466Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h2><p>ä»ç®¡é“çš„ä¸€ç«¯å†™å…¥æ•°æ®å­—èŠ‚ï¼Œç„¶åæ•°æ®è¢«æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºä¸­ï¼Œæ¥ç€è¿›ç¨‹å°±èƒ½ä»ç®¡é“çš„å¦ä¸€ç«¯è¯»å–æ•°æ®äº†ã€‚</p><p>åœ¨xv6ä¸­ï¼Œç®¡é“ä½¿ç”¨è¢«è¯»å–å­—èŠ‚æ•°<code>nread</code>å’Œè¢«å†™å…¥å­—èŠ‚æ•°<code>nwrite</code>çš„å·®å€¼åˆ¤æ–­ç®¡é“çŠ¶æ€ï¼š</p><ul><li>nwrite == nread åˆ™æ•°æ®æœªå†™å…¥æˆ–è¢«è¯»å–å®Œæ¯•ï¼Œç®¡é“ç©º</li><li>nwrite == nread + PIPESIZE åˆ™ç®¡é“æ»¡</li></ul><p>ç”±äºç®¡é“çš„è¯»å–ä¸å†™å…¥å‡éœ€è¦ä½¿ç”¨<code>nread</code>å’Œ<code>nwrite</code>ä»¥è·æ‚‰ç®¡é“çŠ¶æ€ï¼Œæ•…è¿™ä¸¤ä¸ªè®¡æ•°å‚æ•°ä¸èƒ½åœ¨æŸä¸€å‡½æ•°ï¼ˆå†™å…¥/è¯»å–ï¼‰æ¸…é›¶ï¼Œå¦åˆ™å°†å½±å“å¦ä¸€å‡½æ•°ï¼ˆè¯»å–/å†™å…¥ï¼‰çš„æ‰§è¡Œã€‚å› æ­¤ï¼Œxv6ä¸­ä½¿ç”¨<code>data[nread % PIPESIZE]</code>å’Œ<code>data[nwrite % PIPESIZE]</code>æ¥æ§åˆ¶è¯»å†™æ—¶çš„ç®¡é“æ•°æ®åç§»ï¼Œå³å¾ªç¯å†™/è¯»ï¼Œåœ¨<code>data[PIPESIZE-1]</code>åå†™å…¥çš„æ•°æ®å­˜æ”¾åœ¨<code>data[0]</code>ä¸­ã€‚</p><h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pipe</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">spinlock</span> <span class="title">lock</span>;</span> <span class="comment">// é”</span></span><br><span class="line">  <span class="keyword">char</span> data[PIPESIZE]; <span class="comment">// ç®¡é“æ•°æ®</span></span><br><span class="line">  uint nread;     <span class="comment">// è¢«è¯»å–å­—èŠ‚æ•°ï¼Œä»ç¼“å†²åŒºä¸­è¯»å–</span></span><br><span class="line">  uint nwrite;    <span class="comment">// è¢«å†™å…¥å­—èŠ‚æ•°ï¼Œå†™å…¥ç¼“å†²åŒº</span></span><br><span class="line">  <span class="keyword">int</span> readopen;   <span class="comment">// è¯»æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦ä¾æ—§å¤„äºopençŠ¶æ€</span></span><br><span class="line">  <span class="keyword">int</span> writeopen;  <span class="comment">// å†™æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦ä¾æ—§å¤„äºopençŠ¶æ€</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ç®¡é“å‡½æ•°"><a href="#ç®¡é“å‡½æ•°" class="headerlink" title="ç®¡é“å‡½æ•°"></a>ç®¡é“å‡½æ•°</h3><p>ä»¥ä¸‹åˆ†æç®¡é“è¯»å†™å‡½æ•°ï¼Œå…¶ä»–å‡½æ•°ä»…åˆ—å‡ºå‡½æ•°ä½œç”¨ï¼Œè¯¦ç»†æ³¨é‡Šè§ä»£ç æ–‡ä»¶<code>pipe.c</code>ã€‚</p><h4 id="è¯»å†™"><a href="#è¯»å†™" class="headerlink" title="è¯»å†™"></a>è¯»å†™</h4><p>ç®¡é“è¯»å†™æ“ä½œé€šè¿‡ç®¡é“é”å®ç°äº’æ–¥ï¼Œæ“ä½œè¿è¡Œæ—¶å¿…é¡»æŒæœ‰ç®¡é“é”ã€‚</p><p>ç®¡é“æ•°æ®å†™å…¥æ—¶é¦–å…ˆè·å–ç®¡é“é”è€Œåå†™å…¥æ•°æ®ï¼Œè‹¥è¾¾åˆ°ç®¡é“å®¹é‡ä¸Šé™ï¼Œåˆ™å†™æ“ä½œå”¤é†’è¯»æ“ä½œåè¿›å…¥ç¡çœ ç­‰å¾…å¹¶é‡Šæ”¾ç®¡é“é”ã€‚æ­¤æ—¶è¯»æ“ä½œå¯è·å¾—è¯·æ±‚çš„ç®¡é“é”ï¼Œåœ¨è¯»å–å®Œæ•°æ®åç®¡é“å˜ç©ºï¼Œåˆ™è¯»æ“ä½œå”¤é†’å†™æ“ä½œåè¿›å…¥ç¡çœ ç­‰å¾…å¹¶é‡Šæ”¾ç®¡é“é”ã€‚è€Œåç®¡é“å†™æ“ä½œå†æ¬¡è·å¾—ç®¡é“é”ï¼Œå¾ªç¯å¾€å¤ç›´è‡³æ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œå…¶ä¸­æœ€åä¸€æ¬¡ä¼ è¾“å¯èƒ½æœªå†™æ»¡ç®¡é“ã€‚</p><p>å½“ä½¿ç”¨ç®¡é“çš„æ“ä½œè¢«æ€åï¼Œç®¡é“è¯»å†™æ“ä½œéƒ½å°†ç»ˆæ­¢ï¼›å½“ç®¡é“ä¸å¯è¯»æ—¶ï¼Œç®¡é“å†™æ“ä½œå°†è¢«ç»ˆæ­¢ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®¡é“å†™</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">pipewrite(struct pipe *p, <span class="keyword">char</span> *addr, <span class="keyword">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">  acquire(&amp;p-&gt;lock); <span class="comment">// è¯·æ±‚è·å¾—ç®¡é“é”ï¼Œä»¥ä¿æŠ¤è®¡æ•°å™¨ã€æ•°æ®ä»¥åŠç›¸å…³ä¸å˜é‡</span></span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(p-&gt;nwrite == p-&gt;nread + PIPESIZE)&#123;  <span class="comment">// ç®¡é“æ»¡</span></span><br><span class="line">      <span class="comment">// å¦‚æœç®¡é“æ–‡ä»¶ä¸å¯è¯»æˆ–è¿›ç¨‹è¢«æ€ï¼Œé‡Šæ”¾ç®¡é“é”å¹¶ç»ˆæ­¢ç®¡é“å†™æ“ä½œ</span></span><br><span class="line">      <span class="keyword">if</span>(p-&gt;readopen == <span class="number">0</span> || myproc()-&gt;killed)&#123;</span><br><span class="line">        release(&amp;p-&gt;lock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      wakeup(&amp;p-&gt;nread); <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„è¯»è€…ç¼“å†²åŒºä¸­æœ‰æ•°æ®å¯è¯»</span></span><br><span class="line">      sleep(&amp;p-&gt;nwrite, &amp;p-&gt;lock);  <span class="comment">// ç®¡é“å†™æ“ä½œè¿›å…¥ç¡çœ ç­‰å¾…ï¼ˆç¡çœ æ—¶å°†é‡Šæ”¾ç®¡é“é”ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;data[p-&gt;nwrite++ % PIPESIZE] = addr[i]; <span class="comment">// å°†æ‰€éœ€è¯»å–çš„å—å†…æ•°æ®èµ‹å€¼ç»™ç®¡é“æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line">  wakeup(&amp;p-&gt;nread);  <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„è¯»è€…ç¼“å†²åŒºä¸­æœ‰æ•°æ®å¯è¯»</span></span><br><span class="line">  release(&amp;p-&gt;lock); <span class="comment">// é‡Šæ”¾ç®¡é“é”</span></span><br><span class="line">  <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç®¡é“è¯»</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">piperead(struct pipe *p, <span class="keyword">char</span> *addr, <span class="keyword">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">  acquire(&amp;p-&gt;lock); <span class="comment">// è¯·æ±‚è·å¾—ç®¡é“é”ï¼Œä»¥ä¿æŠ¤è®¡æ•°å™¨ã€æ•°æ®ä»¥åŠç›¸å…³ä¸å˜é‡</span></span><br><span class="line">  <span class="keyword">while</span>(p-&gt;nread == p-&gt;nwrite &amp;&amp; p-&gt;writeopen)&#123;  <span class="comment">//DOC: ç®¡é“ä¸ºç©ºä¸”ç®¡é“å¯å†™ï¼Œåˆ™ç®¡é“è¯»æ“ä½œå¯è¿›å…¥ç¡çœ </span></span><br><span class="line">    <span class="comment">// è¿›ç¨‹è¢«æ€ï¼Œé‡Šæ”¾ç®¡é“é”ï¼Œç»ˆæ­¢ç®¡é“è¯»æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>(myproc()-&gt;killed)&#123;</span><br><span class="line">      release(&amp;p-&gt;lock);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sleep(&amp;p-&gt;nread, &amp;p-&gt;lock); <span class="comment">//DOC: piperead-sleep ç®¡é“è¯»æ“ä½œè¿›å…¥ç¡çœ ç­‰å¾…ï¼ˆç¡çœ æ—¶å°†é‡Šæ”¾ç®¡é“é”ï¼‰</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; n; i++)&#123;  <span class="comment">// æ‹·è´æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span>(p-&gt;nread == p-&gt;nwrite) <span class="comment">// è¯»å–å­—èŠ‚æ•°ç­‰äºå†™å…¥å­—èŠ‚æ•°ï¼Œè¡¨ç¤ºè¯»å–å®Œæˆ</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    addr[i] = p-&gt;data[p-&gt;nread++ % PIPESIZE]; <span class="comment">// å°†æ‰€éœ€è¯»å–çš„ç®¡é“æ•°æ®èµ‹å€¼ç»™å—å†…æ•°æ®</span></span><br><span class="line">  &#125;</span><br><span class="line">  wakeup(&amp;p-&gt;nwrite);  <span class="comment">// é€šçŸ¥ç¡çœ ä¸­çš„å†™è€…ç¼“å†²åŒºä¸­å¯å†™</span></span><br><span class="line">  release(&amp;p-&gt;lock);</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ul><li>pipealloc ç®¡é“åˆ†é…ï¼Œå¹¶åˆå§‹åŒ–ç®¡é“ã€‚</li><li>pipeclose ç®¡é“å…³é—­ã€‚è‹¥è¯»å†™ä¸¤æ–¹å‡å…³é—­ï¼Œåˆ™é‡Šæ”¾å†…å­˜ï¼›å¦åˆ™å…³é—­ç®¡é“ä¸€ç«¯å¹¶å”¤é†’å¦ä¸€æ–¹ã€‚å½“å…³é—­å†™ç«¯æ—¶ï¼Œä»å¯è¿›è¡Œè¯»æ“ä½œï¼Œä½†å°†ç®¡é“å†…å‰©ä½™æ•°æ®è¯»å®Œåï¼Œå†æ¬¡è¿›è¡Œè¯»æ“ä½œä¾¿è¿”å›0ï¼Œç›¸å½“äºè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼›å½“å…³é—­è¯»æ®µæ—¶ï¼Œå†™æ“ä½œä¼šåœ¨è¿›è¡Œè¿‡ç¨‹ä¸­ä¸­æ–­ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹ç®¡é“æºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>xv6-æ–‡ä»¶ç³»ç»Ÿ</title>
    <link href="http://rootreturn0.github.io/2019/08/31/xv6-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    <id>http://rootreturn0.github.io/2019/08/31/xv6-æ–‡ä»¶ç³»ç»Ÿ/</id>
    <published>2019-08-30T17:47:50.000Z</published>
    <updated>2019-10-18T17:14:13.038Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ–‡ä»¶ç³»ç»Ÿæ€»ä½“è®¾è®¡"><a href="#æ–‡ä»¶ç³»ç»Ÿæ€»ä½“è®¾è®¡" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿæ€»ä½“è®¾è®¡"></a>æ–‡ä»¶ç³»ç»Ÿæ€»ä½“è®¾è®¡</h2><h3 id="æ–‡ä»¶ç³»ç»Ÿåˆ†å±‚"><a href="#æ–‡ä»¶ç³»ç»Ÿåˆ†å±‚" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿåˆ†å±‚"></a>æ–‡ä»¶ç³»ç»Ÿåˆ†å±‚</h3><p><img src="https://th0ar.gitbooks.io/xv6-chinese/content/pic/f6-1.png" alt="æ–‡ä»¶ç³»ç»Ÿå±‚"></p><p>å¦‚å›¾æ‰€ç¤ºxv6çš„æ–‡ä»¶ç³»ç»Ÿåˆ†6å±‚å®ç°ï¼š</p><ol><li>ç¬¬ä¸€å±‚ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰é€šè¿‡å—ç¼“å†²è¯»å†™ IDE ç¡¬ç›˜ï¼ŒåŒæ­¥å¯¹ç£ç›˜çš„è®¿é—®ï¼Œä¸”é€šè¿‡å—çš„é”ä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªå†…æ ¸è¿›ç¨‹å¯ä»¥ä¿®æ”¹ç£ç›˜å—ï¼›  </li><li>ç¬¬äºŒå±‚ä½¿å¾—æ›´é«˜å±‚çš„æ¥å£å¯ä»¥å°†å¯¹ç£ç›˜çš„æ›´æ–°æŒ‰ä¼šè¯æ‰“åŒ…ï¼Œé€šè¿‡ä¼šè¯çš„æ–¹å¼æ¥ä¿è¯è¿™äº›æ“ä½œæ˜¯åŸå­æ“ä½œã€‚</li><li>ç¬¬ä¸‰å±‚æä¾›æ— åæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶ç”±ä¸€ä¸ªinodeå’Œä¸€è¿ä¸²çš„æ•°æ®å—ç»„æˆã€‚</li><li>ç¬¬å››å±‚å°†ç›®å½•å®ç°ä¸ºä¸€ç§ç‰¹æ®Šçš„inodeï¼Œå†…å®¹æ˜¯ä¸€è¿ä¸²çš„ç›®å½•é¡¹ï¼Œæ¯ä¸€ä¸ªç›®å½•é¡¹åŒ…å«ä¸€ä¸ªæ–‡ä»¶åå’Œå¯¹åº”çš„inodeã€‚</li><li>ç¬¬äº”å±‚æä¾›äº†å±‚æ¬¡è·¯ç»åï¼ˆå¦‚/xx/xxxï¼‰ï¼Œè¿™ä¸€å±‚é€šè¿‡é€’å½’çš„æ–¹å¼æ¥æŸ¥è¯¢è·¯å¾„å¯¹åº”çš„æ–‡ä»¶ã€‚</li><li>ç¬¬å…­å±‚å°†è®¸å¤šèµ„æºï¼ˆå¦‚ç®¡é“ï¼Œè®¾å¤‡ï¼Œæ–‡ä»¶ç­‰ï¼‰æŠ½è±¡ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„æ¥å£ï¼Œæå¤§åœ°ç®€åŒ–äº†ç¨‹åºå‘˜çš„å·¥ä½œã€‚</li></ol><h3 id="ç£ç›˜åˆ†å±‚"><a href="#ç£ç›˜åˆ†å±‚" class="headerlink" title="ç£ç›˜åˆ†å±‚"></a>ç£ç›˜åˆ†å±‚</h3><p>ç£ç›˜åˆ†å±‚ä¸ºå¼•å¯¼å—ã€è¶…çº§å—ã€æ—¥å¿—å—ã€inodeå—ã€ç©ºé—²å—ä½å›¾å’Œæ•°æ®å—ç­‰ã€‚  </p><p>æ–‡ä»¶ç³»ç»Ÿä¸ä½¿ç”¨å¼•å¯¼å—ï¼›è¶…çº§å—åŒ…å«äº†æ–‡ä»¶ç³»ç»Ÿçš„å…ƒä¿¡æ¯ï¼›æ—¥å¿—å—ä¸­çš„æ—¥å¿—ç»´æŠ¤äº†æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„åŸå­æ€§ï¼Œé˜²æ­¢æ“ä½œè¿‡ç¨‹ä¸­å¼•å‘çš„ç³»ç»Ÿå´©æºƒè€Œå¯¼è‡´çš„æ•°æ®ä¸åŒæ­¥ï¼›inodeå—ç”¨äºå­˜æ”¾inodeï¼ˆä¸€ä¸ªå—å¯å­˜æ”¾å¤šä¸ªinodeï¼‰ï¼›ç©ºé—²å—ä½å›¾ä¾¿äºæŸ¥æ‰¾ç©ºé—²çš„å—ï¼›æ•°æ®å—ä¸­ä¿å­˜äº†æ–‡ä»¶å’Œç›®å½•ç­‰å†…å®¹ã€‚</p><h2 id="å—ç¼“å†²å±‚"><a href="#å—ç¼“å†²å±‚" class="headerlink" title="å—ç¼“å†²å±‚"></a>å—ç¼“å†²å±‚</h2><h3 id="éœ€è¦å®ç°çš„ç›®æ ‡"><a href="#éœ€è¦å®ç°çš„ç›®æ ‡" class="headerlink" title="éœ€è¦å®ç°çš„ç›®æ ‡"></a>éœ€è¦å®ç°çš„ç›®æ ‡</h3><ol><li>åŒæ­¥å¯¹ç£ç›˜çš„è®¿é—®ã€‚å¯¹äºä»»æ„ä¸€ä¸ªå—ï¼ŒåŒä¸€æ—¶é—´ä»…æœ‰ä¸€ä»½æ‹·è´æ”¾åœ¨å†…å­˜ä¸­ä¸”åªå…è®¸ä¸€ä¸ªå†…æ ¸çº¿ç¨‹å¯¹è¯¥æ‹·è´è¿›è¡Œä¿®æ”¹ã€‚</li><li>ç¼“å­˜å¸¸ç”¨çš„å—ä»¥å‡å°‘ç£ç›˜è¯»å–æ¬¡æ•°ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</li></ol><h3 id="å®ç°æ–¹æ¡ˆ"><a href="#å®ç°æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ–¹æ¡ˆ"></a>å®ç°æ–¹æ¡ˆ</h3><p>ä»£ç å‚è§<code>bio.c</code>ã€‚</p><p>æ ¹æ®æ—¶é—´ä¸ç©ºé—´å±€éƒ¨æ€§åŸç†ï¼Œå°†æœ€è¿‘ç»å¸¸è®¿é—®çš„ç£ç›˜å—ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä½¿ç”¨LRUæ›¿æ¢ç­–ç•¥ã€‚</p><h4 id="ç»“æ„å®šä¹‰"><a href="#ç»“æ„å®šä¹‰" class="headerlink" title="ç»“æ„å®šä¹‰"></a>ç»“æ„å®šä¹‰</h4><p>xv6å°†ç¼“å†²åŒºåˆ†ä¸ºä¸¤ç§çŠ¶æ€ï¼š</p><ol><li>B_VALID æ„å‘³ç€è¿™ä¸ªç¼“å†²åŒºæ‹¥æœ‰ç£ç›˜å—çš„æœ‰æ•ˆå†…å®¹ï¼›</li><li>B_DIRTY æ„å‘³ç€ç¼“å†²åŒºçš„å†…å®¹å·²ç»è¢«æ”¹å˜å¹¶ä¸”éœ€è¦å†™å›ç£ç›˜ï¼›</li></ol><p>ä¸æ—§ç‰ˆç›¸æ¯”ï¼ŒB_BUSY çŠ¶æ€åœ¨æœ€æ–°ç‰ˆä»£ç ä¸­è¢«åˆ å»ã€‚ä½†ç”±äºç¼“å­˜åŒºä¸­çš„å—çš„é”çš„å­˜åœ¨ï¼Œåªæœ‰æŒæœ‰é”æ‰èƒ½è®¿é—®è¯¥å—ï¼Œè€Œåœ¨å¦ä¸€çº¿ç¨‹æœªä½¿ç”¨å®Œæˆå‰ï¼Œè¯¥é”ä¸ä¼šè¢«é‡Šæ”¾ï¼Œæ­¤æ—¶åªèƒ½å¾ªç¯ç­‰å¾…é”çš„é‡Šæ”¾ï¼Œè·å¾—é”åæ–¹å¯è·å¾—å—ã€‚æ•…ä¾æ—§å¯ä¿æŒå—å†…å®¹çš„åŸå­æ€§ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†…å­˜ä¸­çš„ç£ç›˜å—ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">buf</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> flags; <span class="comment">// æ ‡è®°ç£ç›˜çŠ¶æ€ï¼Œvalid/dirty</span></span><br><span class="line">  uint dev; <span class="comment">// ç£ç›˜è®¾å¤‡å·</span></span><br><span class="line">  uint blockno; <span class="comment">// å—ç¼–å·</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sleeplock</span> <span class="title">lock</span>;</span></span><br><span class="line">  uint refcnt; <span class="comment">// å¼•ç”¨è®¡æ•°</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">prev</span>;</span> <span class="comment">// LRU cache list ä½¿ç”¨LRUæ›¿æ¢</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">next</span>;</span> <span class="comment">// é“¾å¼ç»“æ„è¿æ¥ç£ç›˜å—</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">qnext</span>;</span> <span class="comment">// ç£ç›˜é˜Ÿåˆ—</span></span><br><span class="line">  uchar data[BSIZE]; <span class="comment">// å—å¤§å°ä¸º512å­—èŠ‚</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å—ç¼“å†²åŒºç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">spinlock</span> <span class="title">lock</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> <span class="title">buf</span>[<span class="title">NBUF</span>];</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ prev/next è¿æ¥æ‰€æœ‰ç¼“å†²å—</span></span><br><span class="line">  <span class="comment">// å…¶ä¸­ head.next æ˜¯æœ€è¿‘æœ€å¸¸ä½¿ç”¨çš„å—.</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> <span class="title">head</span>;</span></span><br><span class="line">&#125; bcache;</span><br></pre></td></tr></table></figure><h4 id="åˆå§‹åŒ–-binit"><a href="#åˆå§‹åŒ–-binit" class="headerlink" title="åˆå§‹åŒ– binit"></a>åˆå§‹åŒ– binit</h4><p>ä»ä¸€ä¸ªé™æ€æ•°ç»„<code>buf</code>ä¸­æ„å»ºå‡ºä¸€ä¸ªæœ‰<code>NBUF</code>ä¸ªå…ƒç´ çš„åŒå‘é“¾è¡¨ã€‚æ‰€æœ‰å¯¹å—ç¼“å†²çš„è®¿é—®éƒ½é€šè¿‡é“¾è¡¨è€Œéé™æ€æ•°ç»„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">binit(<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–å—ç¼“å†²é”</span></span><br><span class="line">  initlock(&amp;bcache.lock, <span class="string">"bcache"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//PAGEBREAK!</span></span><br><span class="line">  <span class="comment">// æ„å»ºç¼“å†²åŒå‘é“¾è¡¨</span></span><br><span class="line">  bcache.head.prev = &amp;bcache.head;</span><br><span class="line">  bcache.head.next = &amp;bcache.head;</span><br><span class="line">  <span class="keyword">for</span>(b = bcache.buf; b &lt; bcache.buf+NBUF; b++)&#123;</span><br><span class="line">    b-&gt;next = bcache.head.next;</span><br><span class="line">    b-&gt;prev = &amp;bcache.head;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç¼“å†²åŒºä¸­çš„å—çš„é”</span></span><br><span class="line">    initsleeplock(&amp;b-&gt;lock, <span class="string">"buffer"</span>);</span><br><span class="line">    bcache.head.next-&gt;prev = b;</span><br><span class="line">    bcache.head.next = b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥æ‰¾-bget"><a href="#æŸ¥æ‰¾-bget" class="headerlink" title="æŸ¥æ‰¾ bget"></a>æŸ¥æ‰¾ bget</h4><p>æ‰«æç¼“å†²åŒºé“¾è¡¨ï¼Œé€šè¿‡ç»™å®šçš„è®¾å¤‡å·å’Œæ‰‡åŒºå·æ‰¾åˆ°å¯¹åº”çš„ç¼“å†²åŒºã€‚å¦‚æœæœªæ‰¾åˆ°ï¼Œåˆ™åˆ†é…ä¸€ä¸ªç¼“å†²åŒºï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªæŒæœ‰é”çš„ç¼“å†²åŒºã€‚ä»£ç ä¸­åœ¨åŒå‘é“¾è¡¨çš„æœç´¢ä¸­å‘æœ€è¿‘æœ€å¸¸ä½¿ç”¨æ–¹å‘æŸ¥æ‰¾ï¼Œè‹¥æœªæ‰¾åˆ°åˆ™å‘å¦ä¸€æ–¹å‘æŸ¥æ‰¾ç©ºé—²ç¼“å†²åŒºä»¥åˆ†é…ã€‚</p><p>å…¶ä¸­è‹¥æ‰¾åˆ°ç¼“å†²åŒºä¸­æŒ‡å®šçš„å—ï¼Œè¿”å›çš„ç»“æœä¹Ÿä¸ä¸€å®šæ˜¯æŒ‡å®šçš„å—ã€‚å› ä¸ºåœ¨è¯·æ±‚è¯¥å—çš„é”å‰å·²é‡Šæ”¾ç¼“å†²åŒºé”ï¼Œè‹¥è¯¥å—æœªæŒæœ‰é”ä¸”æ­£åœ¨è¢«ç”¨æ¥ç¼“å†²å¦å¤–ä¸€ä¸ªå—ï¼Œåˆ™é‡æ–°è·å¾—é”æ—¶å·²æ˜¯å¦ä¸€ä¸ªå—ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">buf</span>*</span></span><br><span class="line"><span class="class"><span class="title">bget</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">blockno</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;bcache.lock); <span class="comment">// è¯·æ±‚å—ç¼“å†²åŒºé”</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸èƒ½ä¿è¯ b ä»ç„¶æ˜¯å¯ç”¨çš„ç¼“å†²åŒºï¼šå®ƒæœ‰å¯èƒ½è¢«ç”¨æ¥ç¼“å†²å¦å¤–ä¸€ä¸ªå—ã€‚</span></span><br><span class="line">  <span class="keyword">for</span>(b = bcache.head.next; b != &amp;bcache.head; b = b-&gt;next)&#123;</span><br><span class="line">    <span class="keyword">if</span>(b-&gt;dev == dev &amp;&amp; b-&gt;blockno == blockno)&#123;</span><br><span class="line">      b-&gt;refcnt++; <span class="comment">// å¼•ç”¨è®¡æ•°åŠ ä¸€</span></span><br><span class="line">      release(&amp;bcache.lock); <span class="comment">// é‡Šæ”¾å—ç¼“å†²åŒºé”</span></span><br><span class="line">      acquiresleep(&amp;b-&gt;lock); <span class="comment">// è¯·æ±‚è¯¥å—çš„é”</span></span><br><span class="line">      <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Not cached; recycle an unused buffer. æœªæ‰¾åˆ°åˆ™é‡æ–°æŸ¥æ‰¾</span></span><br><span class="line">  <span class="comment">// Even if refcnt==0, B_DIRTY indicates a buffer is in use</span></span><br><span class="line">  <span class="comment">// because log.c has modified it but not yet committed it.</span></span><br><span class="line">  <span class="comment">// å³ä½¿refcntç­‰äº0ï¼Œä¹Ÿå¯é€šè¿‡B_DIRTYçŸ¥é“ç¼“å†²åŒºè¢«ä½¿ç”¨ï¼Œæ­¤æ—¶æ—¥å¿—å·²ä¿®æ”¹ä½†æœªæäº¤ </span></span><br><span class="line">  <span class="keyword">for</span>(b = bcache.head.prev; b != &amp;bcache.head; b = b-&gt;prev)&#123;</span><br><span class="line">    <span class="keyword">if</span>(b-&gt;refcnt == <span class="number">0</span> &amp;&amp; (b-&gt;flags &amp; B_DIRTY) == <span class="number">0</span>) &#123;</span><br><span class="line">      b-&gt;dev = dev;</span><br><span class="line">      b-&gt;blockno = blockno;</span><br><span class="line">      b-&gt;flags = <span class="number">0</span>;</span><br><span class="line">      b-&gt;refcnt = <span class="number">1</span>;</span><br><span class="line">      release(&amp;bcache.lock);</span><br><span class="line">      acquiresleep(&amp;b-&gt;lock);</span><br><span class="line">      <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœªæ‰¾åˆ°å—ä¸”æœªèƒ½åˆ†é…å—ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  panic(<span class="string">"bget: no buffers"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¯»-bread"><a href="#è¯»-bread" class="headerlink" title="è¯» bread"></a>è¯» bread</h4><p><code>bread</code>ä¼šé¦–å…ˆè°ƒç”¨<code>bget</code>ä»ç¼“å­˜ä¸­å»å¯»æ‰¾å—æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ç›´æ¥è¿”å›ï¼›å¦‚æœä¸å­˜åœ¨åˆ™è¯·æ±‚ç£ç›˜è¯»æ“ä½œï¼Œè¯»åˆ°ç¼“å­˜ä¸­åå†è¿”å›ç»“æœã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">buf</span>*</span></span><br><span class="line"><span class="class"><span class="title">bread</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">blockno</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">b</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–ç¼“å†²åŒº</span></span><br><span class="line">  b = bget(dev, blockno);</span><br><span class="line">  <span class="comment">// å¦‚æœç¼“å†²åŒºä¸­ä¸å­˜åœ¨æŒ‡å®šçš„å—ï¼Œåˆ™ä»ç£ç›˜ä¸­è¯»å‡º</span></span><br><span class="line">  <span class="keyword">if</span>((b-&gt;flags &amp; B_VALID) == <span class="number">0</span>) &#123;</span><br><span class="line">    iderw(b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å†™-bwrite"><a href="#å†™-bwrite" class="headerlink" title="å†™ bwrite"></a>å†™ bwrite</h4><p>è®¾ç½® B_DIRTY ä½å¹¶ä¸”è°ƒç”¨ iderw å°†ç¼“å†²åŒºçš„å†…å®¹å†™åˆ°ç£ç›˜ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">bwrite(struct buf *b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// è¯¥å—æœªé”ï¼Œå¯èƒ½å·²è¢«é‡Šæ”¾ï¼Œæ— æ³•å†™å…¥ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holdingsleep(&amp;b-&gt;lock))</span><br><span class="line">    panic(<span class="string">"bwrite"</span>);</span><br><span class="line">  b-&gt;flags |= B_DIRTY;</span><br><span class="line">  iderw(b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é‡Šæ”¾-brelse"><a href="#é‡Šæ”¾-brelse" class="headerlink" title="é‡Šæ”¾ brelse"></a>é‡Šæ”¾ brelse</h4><p>å°†ä¸€å—ç¼“å†²åŒºç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼Œå”¤é†’ç¡çœ åœ¨è¿™å—ç¼“å†²åŒºä¸Šçš„è¿›ç¨‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å”¤é†’ç¡çœ åœ¨è¿™å—ç¼“å†²åŒºä¸Šçš„è¿›ç¨‹ï¼›å°†ä¸€å—ç¼“å†²åŒºç§»åŠ¨åˆ°é“¾è¡¨çš„å¤´éƒ¨ã€‚</span></span><br><span class="line"><span class="keyword">void</span></span><br><span class="line">brelse(struct buf *b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ç¼“å†²åŒºæœªæŒæœ‰å—é”ï¼Œå¼•å‘å†…æ ¸é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span>(!holdingsleep(&amp;b-&gt;lock))</span><br><span class="line">    panic(<span class="string">"brelse"</span>);</span><br><span class="line"></span><br><span class="line">  releasesleep(&amp;b-&gt;lock); <span class="comment">// é‡Šæ”¾å—é”</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;bcache.lock); <span class="comment">// è¯·æ±‚  ç¼“å†²åŒºé”</span></span><br><span class="line">  b-&gt;refcnt--; <span class="comment">//å¼•ç”¨è®¡æ•°å‡ä¸€</span></span><br><span class="line">  <span class="keyword">if</span> (b-&gt;refcnt == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// æ— è¿›ç¨‹ç­‰å¾…ä½¿ç”¨ï¼Œç§»åŠ¨åˆ°é“¾è¡¨å¤´éƒ¨</span></span><br><span class="line">    b-&gt;next-&gt;prev = b-&gt;prev;</span><br><span class="line">    b-&gt;prev-&gt;next = b-&gt;next;</span><br><span class="line">    b-&gt;next = bcache.head.next;</span><br><span class="line">    b-&gt;prev = &amp;bcache.head;</span><br><span class="line">    bcache.head.next-&gt;prev = b;</span><br><span class="line">    bcache.head.next = b;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  release(&amp;bcache.lock); <span class="comment">//é‡Šæ”¾ç¼“å†²åŒºé”</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—å±‚"><a href="#æ—¥å¿—å±‚" class="headerlink" title="æ—¥å¿—å±‚"></a>æ—¥å¿—å±‚</h3><p>æ¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½å¯èƒ½åŒ…å«ä¸€ä¸ªå¿…é¡»ä»å¤´åˆ°å°¾åŸå­å®Œæˆçš„å†™æ“ä½œåºåˆ—ï¼Œç§°è¿™æ ·çš„ä¸€ä¸ªåºåˆ—ä¸ºä¸€ä¸ªä¼šè¯ã€‚ä»»ä½•æ—¶å€™åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ä¸€ä¸ªä¼šè¯ä¹‹ä¸­ï¼Œå…¶ä»–è¿›ç¨‹å¿…é¡»ç­‰å¾…å½“å‰ä¼šè¯ä¸­çš„è¿›ç¨‹ç»“æŸã€‚å› æ­¤åŒä¸€æ—¶åˆ»æ—¥å¿—æœ€å¤šåªè®°å½•ä¸€æ¬¡ä¼šè¯ã€‚</p><p>è¯¥å±‚ç”¨äºç»´æŠ¤ç³»ç»Ÿå´©æºƒååˆ°åŸå­æ€§ï¼Œå³ä¼šè¯è¦ä¹ˆå®Œæˆï¼Œè¦ä¹ˆç³»ç»Ÿæ¢å¤è‡³ä¼šè¯å¼€å§‹å‰çš„çŠ¶æ€ã€‚</p><h3 id="å—åˆ†é…å™¨"><a href="#å—åˆ†é…å™¨" class="headerlink" title="å—åˆ†é…å™¨"></a>å—åˆ†é…å™¨</h3><p>æœ¬éƒ¨åˆ†æ¶‰åŠçš„å‡½æ•°ä½äº<code>fs.c</code>ã€‚</p><p>ç”±äº<code>bread</code>ä¸<code>brelse</code>å·²æœ‰é”è¿›è¡Œäº’æ–¥ï¼Œå—åˆ†é…å™¨æ— éœ€å†åŠ é”ã€‚</p><h4 id="åˆ†é…æ–°çš„ç£ç›˜å—"><a href="#åˆ†é…æ–°çš„ç£ç›˜å—" class="headerlink" title="åˆ†é…æ–°çš„ç£ç›˜å—"></a>åˆ†é…æ–°çš„ç£ç›˜å—</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> uint</span><br><span class="line">balloc(uint dev)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> b, bi, m;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line"></span><br><span class="line">  bp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(b = <span class="number">0</span>; b &lt; sb.size; b += BPB)&#123; <span class="comment">// è¯»ä½å›¾æ¯ä¸€å—</span></span><br><span class="line">    bp = bread(dev, BBLOCK(b, sb));</span><br><span class="line">    <span class="keyword">for</span>(bi = <span class="number">0</span>; bi &lt; BPB &amp;&amp; b + bi &lt; sb.size; bi++)&#123; <span class="comment">// è¯»å—å†…æ¯ä¸€ä½</span></span><br><span class="line">      m = <span class="number">1</span> &lt;&lt; (bi % <span class="number">8</span>);</span><br><span class="line">      <span class="keyword">if</span>((bp-&gt;data[bi/<span class="number">8</span>] &amp; m) == <span class="number">0</span>)&#123;  <span class="comment">// åˆ¤æ–­å—æ˜¯å¦ç©ºé—²</span></span><br><span class="line">        bp-&gt;data[bi/<span class="number">8</span>] |= m;  <span class="comment">// å°†å—æ ‡è®°ä¸ºä½¿ç”¨ä¸­</span></span><br><span class="line">        log_write(bp);</span><br><span class="line">        brelse(bp); <span class="comment">// é‡Šæ”¾å—</span></span><br><span class="line">        bzero(dev, b + bi); <span class="comment">// æ¸…é›¶å—</span></span><br><span class="line">        <span class="keyword">return</span> b + bi;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    brelse(bp);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¶…å‡ºå—èŒƒå›´ï¼Œå¼•å‘é”™è¯¯</span></span><br><span class="line">  panic(<span class="string">"balloc: out of blocks"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é‡Šæ”¾ç£ç›˜å—"><a href="#é‡Šæ”¾ç£ç›˜å—" class="headerlink" title="é‡Šæ”¾ç£ç›˜å—"></a>é‡Šæ”¾ç£ç›˜å—</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line">bfree(<span class="keyword">int</span> dev, uint b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="keyword">int</span> bi, m;</span><br><span class="line"></span><br><span class="line">  readsb(dev, &amp;sb);</span><br><span class="line">  bp = bread(dev, BBLOCK(b, sb));</span><br><span class="line">  bi = b % BPB;</span><br><span class="line">  m = <span class="number">1</span> &lt;&lt; (bi % <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span>((bp-&gt;data[bi/<span class="number">8</span>] &amp; m) == <span class="number">0</span>) <span class="comment">// é‡Šæ”¾ç©ºé—²å—ï¼Œé”™è¯¯</span></span><br><span class="line">    panic(<span class="string">"freeing free block"</span>);</span><br><span class="line">  bp-&gt;data[bi/<span class="number">8</span>] &amp;= ~m;</span><br><span class="line">  log_write(bp);</span><br><span class="line">  brelse(bp); <span class="comment">// é‡Šæ”¾å—</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="inode"><a href="#inode" class="headerlink" title="inode"></a>inode</h3><p>inodeæœ‰ä¸¤ç§ç±»åˆ«ï¼š</p><ul><li><p>ç£ç›˜ä¸Šçš„è®°å½•æ–‡ä»¶å¤§å°ã€æ•°æ®å—æ‰‡åŒºå·çš„æ•°æ®ç»“æ„</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> &#123;</span></span><br><span class="line">  <span class="keyword">short</span> type;           <span class="comment">// åŒºåˆ†æ–‡ä»¶ã€ç›®å½•å’Œç‰¹æ®Šæ–‡ä»¶çš„ i èŠ‚ç‚¹ï¼Œ0è¡¨ç¤ºä¸ºç©ºé—²èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">short</span> major;          <span class="comment">// ä¸»è®¾å¤‡å·ï¼ˆä»…é™T_DEVï¼‰</span></span><br><span class="line">  <span class="keyword">short</span> minor;          <span class="comment">// è¾…è®¾å¤‡å·ï¼ˆä»…é™T_DEVï¼‰</span></span><br><span class="line">  <span class="keyword">short</span> nlink;          <span class="comment">// æ–‡ä»¶ç³»ç»Ÿä¸­çš„ièŠ‚ç‚¹è¿æ¥æ•°</span></span><br><span class="line">  uint size;            <span class="comment">// æ–‡ä»¶çš„å­—èŠ‚æ•°</span></span><br><span class="line">  uint addrs[NDIRECT+<span class="number">1</span>]; <span class="comment">// ç”¨äºè¿™ä¸ªæ–‡ä»¶çš„æ•°æ®å—çš„å—å·</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>å†…å­˜ä¸­çš„ä¸€ä¸ª i èŠ‚ç‚¹ï¼ŒåŒ…å«ä¸€ä¸ªç£ç›˜ä¸Š i èŠ‚ç‚¹çš„æ‹·è´ï¼Œä»¥åŠä¸€äº›å†…æ ¸éœ€è¦çš„é™„åŠ ä¿¡æ¯</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span> &#123;</span></span><br><span class="line">  uint dev;           <span class="comment">// Device number è®¾å¤‡å·</span></span><br><span class="line">  uint inum;          <span class="comment">// Inode number inodeå·</span></span><br><span class="line">  <span class="keyword">int</span> ref;            <span class="comment">// Reference count å¼•ç”¨æ•°</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sleeplock</span> <span class="title">lock</span>;</span> <span class="comment">// protects everything below here ä¿æŠ¤ä»¥ä¸‹æ‰€æœ‰æ•°æ®</span></span><br><span class="line">  <span class="keyword">int</span> valid;          <span class="comment">// inode has been read from disk? ièŠ‚ç‚¹æ˜¯å¦å·²ä»ç£ç›˜ä¸­è¯»å–</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹å‡ä¸ºç£ç›˜ä¸Šçš„ièŠ‚ç‚¹ï¼Œå³dinodeï¼Œçš„æ‹·è´</span></span><br><span class="line">  <span class="keyword">short</span> type;         <span class="comment">// copy of disk inode</span></span><br><span class="line">  <span class="keyword">short</span> major;</span><br><span class="line">  <span class="keyword">short</span> minor;</span><br><span class="line">  <span class="keyword">short</span> nlink;</span><br><span class="line">  uint size;</span><br><span class="line">  uint addrs[NDIRECT+<span class="number">1</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul><p>xv6ä¸­æœ‰inodeçš„ç¼“å†²åŒºï¼Œä½œç”¨ä¸å—ç¼“å†²åŒºç›¸ä¼¼ã€‚ä»¥ä¸‹å‡½æ•°åˆ†æä»…åŒ…å«è¿›è¡Œç‰¹æ®Šæ“ä½œæˆ–è¾ƒä¸ºå¤æ‚çš„å‡½æ•°ï¼Œå…¶ä½™å‡½æ•°ä»…å†™å‡ºä½œç”¨å’Œä½¿ç”¨æ¡ä»¶ï¼ˆå¦‚<code>iunlock</code>ï¼‰ã€‚å…¶ä¸­å‡½æ•°ä½äº<code>fs.c</code>ã€‚</p><h4 id="è·å–inode-iget"><a href="#è·å–inode-iget" class="headerlink" title="è·å–inode iget"></a>è·å–inode iget</h4><p><code>iget</code>è¿”å›çš„inodeçš„æŒ‡é’ˆå°†ä¿è¯è¿™ä¸ªinodeä¼šç•™åœ¨ç¼“å­˜ä¸­ï¼Œä¸ä¼šè¢«åˆ æ‰ä¸”ä¸ä¼šè¢«ç”¨äºç¼“å­˜å¦ä¸€ä¸ªæ–‡ä»¶ï¼ˆå³ä½¿æœªè¯»å…¥ç£ç›˜dinodeå†…å®¹ï¼‰ã€‚è‹¥ç£ç›˜å†…å®¹æœªè¯»å…¥ï¼Œåˆ™ä»¥ååœ¨è°ƒç”¨<code>ilock</code>æ—¶è¯»å…¥ã€‚</p><p>å…¶ä¸­<code>iget</code>è¿”å›çš„inodeçš„æ˜¯æœªè¢«é”çš„ã€‚åœ¨ç›®å½•å±‚çš„ç›®å½•æŸ¥æ‰¾ä¸­ï¼Œè°ƒç”¨è€…å·²ç»å¯¹dpä¸Šé”ï¼Œå¦‚æœåœ¨è°ƒç”¨<code>iget</code>è¿”å›ä¹‹å‰å°è¯•å»é”ä¸Šè¯¥ièŠ‚ç‚¹ä¼šæœ‰äºŒæ¬¡é”ä¸Šdpçš„å¯èƒ½ä»è€Œé€ æˆæ­»é”ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">iget</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">uint</span> <span class="title">inum</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>, *<span class="title">empty</span>;</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;icache.lock);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨inodeçš„cacheä¸­å¯»æ‰¾ç›®æ ‡inode</span></span><br><span class="line">  empty = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ip = &amp;icache.inode[<span class="number">0</span>]; ip &lt; &amp;icache.inode[NINODE]; ip++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;ref &gt; <span class="number">0</span> &amp;&amp; ip-&gt;dev == dev &amp;&amp; ip-&gt;inum == inum)&#123;</span><br><span class="line">      ip-&gt;ref++;</span><br><span class="line">      release(&amp;icache.lock);</span><br><span class="line">      <span class="keyword">return</span> ip; <span class="comment">// æ­¤æ—¶è¿”å›çš„ièŠ‚ç‚¹å†…å®¹ä¸ä¸€å®šå·²ä»ç£ç›˜è¯»å…¥cache</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(empty == <span class="number">0</span> &amp;&amp; ip-&gt;ref == <span class="number">0</span>)    <span class="comment">// è®°å½•æ‰«æåˆ°çš„ç¬¬ä¸€ä¸ªç©ºæ§½</span></span><br><span class="line">      empty = ip;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¿æŒinodeå…¥å£ï¼Œä»¥ä¸‹æœªä»ç£ç›˜è¯»å…¥å†…å®¹</span></span><br><span class="line">  <span class="keyword">if</span>(empty == <span class="number">0</span>) <span class="comment">// cacheä¸­æ— ièŠ‚ç‚¹ç©ºé—²ï¼Œå‡ºé”™</span></span><br><span class="line">    panic(<span class="string">"iget: no inodes"</span>);</span><br><span class="line"></span><br><span class="line">  ip = empty;</span><br><span class="line">  ip-&gt;dev = dev;</span><br><span class="line">  ip-&gt;inum = inum;</span><br><span class="line">  ip-&gt;ref = <span class="number">1</span>;</span><br><span class="line">  ip-&gt;valid = <span class="number">0</span>;</span><br><span class="line">  release(&amp;icache.lock);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ†é…inode-ialloc"><a href="#åˆ†é…inode-ialloc" class="headerlink" title="åˆ†é…inode ialloc"></a>åˆ†é…inode ialloc</h4><p>åœ¨è®¾å¤‡devä¸Šåˆ†é…inodeï¼šé€šè¿‡ç»™å®ƒç±»å‹ç±»å‹å°†å…¶æ ‡è®°ä¸ºå·²åˆ†é…ï¼Œè¿”å›æœªé”å®šä½†å·²åˆ†é…å’Œå¼•ç”¨çš„inodeã€‚è¿™é‡Œä¸<code>balloc</code>ç›¸ä¼¼ï¼Œå¯å‚ç…§å‰æ–‡ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">ialloc</span>(<span class="title">uint</span> <span class="title">dev</span>, <span class="title">short</span> <span class="title">type</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="keyword">int</span> inum;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> *<span class="title">dip</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(inum = <span class="number">1</span>; inum &lt; sb.ninodes; inum++)&#123;</span><br><span class="line">    bp = bread(dev, IBLOCK(inum, sb));</span><br><span class="line">    dip = (struct dinode*)bp-&gt;data + inum%IPB;</span><br><span class="line">    <span class="keyword">if</span>(dip-&gt;type == <span class="number">0</span>)&#123;  <span class="comment">// inodeæœªåˆ†é…</span></span><br><span class="line">      <span class="built_in">memset</span>(dip, <span class="number">0</span>, <span class="keyword">sizeof</span>(*dip)); <span class="comment">// åˆ†é…ç©ºé—´</span></span><br><span class="line">      dip-&gt;type = type;</span><br><span class="line">      log_write(bp);</span><br><span class="line">      brelse(bp);</span><br><span class="line">      <span class="keyword">return</span> iget(dev, inum);</span><br><span class="line">    &#125;</span><br><span class="line">    brelse(bp);</span><br><span class="line">  &#125;</span><br><span class="line">  panic(<span class="string">"ialloc: no inodes"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é”inode-ilock"><a href="#é”inode-ilock" class="headerlink" title="é”inode ilock"></a>é”inode ilock</h4><p>é”å®šç»™å®šçš„inodeã€‚å¦‚æœ‰å¿…è¦ï¼Œä»ç£ç›˜è¯»å–inodeã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">ilock(struct inode *ip)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">buf</span> *<span class="title">bp</span>;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dinode</span> *<span class="title">dip</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(ip == <span class="number">0</span> || ip-&gt;ref &lt; <span class="number">1</span>)</span><br><span class="line">    panic(<span class="string">"ilock"</span>);</span><br><span class="line"></span><br><span class="line">  acquiresleep(&amp;ip-&gt;lock); <span class="comment">// è¯·æ±‚inodeé”</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(ip-&gt;valid == <span class="number">0</span>)&#123; <span class="comment">// inodeå†…å®¹æœªä»ç£ç›˜è¯»å–</span></span><br><span class="line">    bp = bread(ip-&gt;dev, IBLOCK(ip-&gt;inum, sb));</span><br><span class="line">    dip = (struct dinode*)bp-&gt;data + ip-&gt;inum%IPB;</span><br><span class="line">    ip-&gt;type = dip-&gt;type;</span><br><span class="line">    ip-&gt;major = dip-&gt;major;</span><br><span class="line">    ip-&gt;minor = dip-&gt;minor;</span><br><span class="line">    ip-&gt;nlink = dip-&gt;nlink;</span><br><span class="line">    ip-&gt;size = dip-&gt;size;</span><br><span class="line">    memmove(ip-&gt;addrs, dip-&gt;addrs, <span class="keyword">sizeof</span>(ip-&gt;addrs));</span><br><span class="line">    brelse(bp);</span><br><span class="line">    ip-&gt;valid = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;type == <span class="number">0</span>) <span class="comment">// inodeæœªè¢«åˆ†é…ï¼Œå‡ºé”™ï¼Œå¼•å‘ææ…Œ</span></span><br><span class="line">      panic(<span class="string">"ilock: no type"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é‡Šæ”¾å¼•ç”¨-iput"><a href="#é‡Šæ”¾å¼•ç”¨-iput" class="headerlink" title="é‡Šæ”¾å¼•ç”¨ iput"></a>é‡Šæ”¾å¼•ç”¨ iput</h4><p>é‡Šæ”¾å¯¹å†…å­˜ä¸­çš„æŸä¸€inodeçš„å¼•ç”¨ï¼Œå³å¼•ç”¨æ•°å‡ä¸€ã€‚å¯¹iputï¼ˆï¼‰çš„æ‰€æœ‰è°ƒç”¨å¿…é¡»åœ¨ä¼šè¯å†…ï¼Œå› ä¸ºå®ƒå¯èƒ½é‡Šæ”¾inodeã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">iput(struct inode *ip)</span><br><span class="line">&#123;</span><br><span class="line">  acquiresleep(&amp;ip-&gt;lock); <span class="comment">// è¯·æ±‚inodeé”</span></span><br><span class="line">  <span class="comment">// å¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªå¼•ç”¨ï¼Œåˆ™å¯ä»¥å›æ”¶inodeç¼“å­˜æ¡ç›®ã€‚</span></span><br><span class="line">  <span class="keyword">if</span>(ip-&gt;valid &amp;&amp; ip-&gt;nlink == <span class="number">0</span>)&#123;</span><br><span class="line">    acquire(&amp;icache.lock);</span><br><span class="line">    <span class="keyword">int</span> r = ip-&gt;ref;</span><br><span class="line">    release(&amp;icache.lock);</span><br><span class="line">    <span class="keyword">if</span>(r == <span class="number">1</span>)&#123;</span><br><span class="line">      <span class="comment">// inode has no links and no other references: truncate and free.</span></span><br><span class="line">      <span class="comment">// å¦‚æœé‚£æ˜¯æœ€åä¸€ä¸ªå¼•ç”¨å¹¶ä¸”inodeæ²¡æœ‰è¿æ¥ï¼Œé‡Šæ”¾ç£ç›˜ä¸Šçš„inodeï¼ˆåŠå…¶å†…å®¹ï¼‰ã€‚</span></span><br><span class="line">      itrunc(ip);</span><br><span class="line">      ip-&gt;type = <span class="number">0</span>;</span><br><span class="line">      iupdate(ip);</span><br><span class="line">      ip-&gt;valid = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  releasesleep(&amp;ip-&gt;lock); <span class="comment">// é‡Šæ”¾ inode é”</span></span><br><span class="line"></span><br><span class="line">  acquire(&amp;icache.lock);</span><br><span class="line">  ip-&gt;ref--; <span class="comment">// å¼•ç”¨è®¡æ•°å‡ä¸€</span></span><br><span class="line">  release(&amp;icache.lock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…¶ä»–å‡½æ•°"><a href="#å…¶ä»–å‡½æ•°" class="headerlink" title="å…¶ä»–å‡½æ•°"></a>å…¶ä»–å‡½æ•°</h4><ul><li>readsb è¯»è¶…çº§å—</li><li>bzero å°†å—å†…å®¹æ¸…é›¶</li><li>iupdate å°†ä¿®æ”¹åçš„å†…å­˜ä¸­inodeå¤åˆ¶åˆ°ç£ç›˜ï¼›å¿…é¡»åœ¨æ¯æ¬¡æ›´æ”¹ip-&gt; xxxå­—æ®µåè°ƒç”¨ï¼›å®ƒå­˜åœ¨äºç£ç›˜ä¸Šï¼Œå› ä¸ºi-nodeç¼“å­˜æ˜¯ç›´å†™å¼çš„ï¼›è°ƒç”¨è€…å¿…é¡»æŒæœ‰ièŠ‚ç‚¹é”ã€‚</li><li>iunlock å¯¹æŒ‡å®šinodeè§£é”</li><li>iunlockput iunlockå’Œiputçš„ç»“åˆã€‚ç”±äºä¸¤ç§å¸¸å¸¸ä¸€èµ·ä½¿ç”¨ï¼Œæ•…æ•´åˆã€‚</li><li>bmap è¿”å›inodeä¸­ç¬¬nä¸ªå—çš„ç£ç›˜å—åœ°å€ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„å—ï¼Œbmapä¼šåˆ†é…ä¸€ä¸ªã€‚</li><li>stati ä»inodeå¤åˆ¶å±æ€§ä¿¡æ¯ã€‚</li><li>readi ä»inodeè¯»æ•°æ®ï¼Œè°ƒç”¨è€…å¿…é¡»æŒæœ‰ip-&gt; lockã€‚</li><li>writei ç»™inodeå†™å…¥æ•°æ®ï¼Œè°ƒç”¨è€…å¿…é¡»æŒæœ‰ip-&gt; lockã€‚</li></ul><p><em>å…¶ä¸­readiå’Œwriteiå‡è¦æ±‚ç»™å®šçš„åç§»å’Œè¯»å‡ºçš„é‡ä¸è¶…å‡ºæ–‡ä»¶å¤§å°ã€‚</em></p><h3 id="ç›®å½•å±‚"><a href="#ç›®å½•å±‚" class="headerlink" title="ç›®å½•å±‚"></a>ç›®å½•å±‚</h3><h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><p>ç›®å½•çš„ièŠ‚ç‚¹çš„ç±»å‹æ˜¯T_DIR,.ç›®å½•æœ¬èº«æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨åˆ°ç£ç›˜ä¸Šçš„ï¼Œå®ƒçš„æ•°æ®æ˜¯ä¸€ç³»åˆ—çš„ç›®å½•æ¡ç›®ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> &#123;</span></span><br><span class="line">  ushort inum; <span class="comment">// ièŠ‚ç‚¹å·</span></span><br><span class="line">  <span class="keyword">char</span> name[DIRSIZ]; <span class="comment">// ç›®å½•å</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><p>è¯¦ç»†æ³¨é‡Šä½äº<code>fs.c</code>ã€‚</p><ul><li>dirlookup æŸ¥æ‰¾ç›®å½•ä¸­æŒ‡å®šåå­—çš„æ¡ç›®</li><li>dirlink ä¼šå†™å…¥ä¸€ä¸ªæ–°çš„ç›®å½•æ¡ç›®åˆ°æŸä¸€ç›®å½•ä¸‹</li></ul><h3 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h3><h4 id="å‡½æ•°-1"><a href="#å‡½æ•°-1" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><ul><li>namex </li></ul><p>æŸ¥æ‰¾å¹¶è¿”å›inodeä»¥è·å–è·¯å¾„åã€‚å¦‚æœparentï¼= 0ï¼Œåˆ™è¿”å›çˆ¶é¡¹çš„inodeå¹¶å¤åˆ¶æœ€ç»ˆé¡¹ã€‚è·¯å¾„å…ƒç´ åˆ°åç§°ï¼Œå¿…é¡»æœ‰DIRSIZå­—èŠ‚çš„ç©ºé—´ã€‚è¯¥å‡½æ•°å¿…é¡»åœ¨ä¼šè¯å†…éƒ¨è°ƒç”¨ï¼Œå› ä¸ºå®ƒè°ƒç”¨iputï¼ˆï¼‰ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">inode</span>*</span></span><br><span class="line"><span class="class"><span class="title">namex</span>(<span class="title">char</span> *<span class="title">path</span>, <span class="title">int</span> <span class="title">nameiparent</span>, <span class="title">char</span> *<span class="title">name</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>, *<span class="title">next</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(*path == <span class="string">'/'</span>) <span class="comment">// è·¯å¾„ä»¥åæ–œæ å¼€å§‹ï¼Œåˆ™è§£æä»æ ¹ç›®å½•å¼€å§‹</span></span><br><span class="line">    ip = iget(ROOTDEV, ROOTINO);</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">// å…¶ä»–æƒ…å†µä¸‹åˆ™ä»å½“å‰ç›®å½•å¼€å§‹</span></span><br><span class="line">    ip = idup(myproc()-&gt;cwd);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>((path = skipelem(path, name)) != <span class="number">0</span>)&#123; <span class="comment">// è€ƒè™‘è·¯å¾„ä¸­çš„æ¯ä¸€ä¸ªéƒ¨åˆ†</span></span><br><span class="line">    ilock(ip); <span class="comment">// ç¡®ä¿ip-&gt;typeä»ç£ç›˜ä¸­åŠ è½½å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">if</span>(ip-&gt;type != T_DIR)&#123; <span class="comment">// ä¸æ˜¯ç›®å½•ï¼ŒæŸ¥æ‰¾å¤±è´¥</span></span><br><span class="line">      iunlockput(ip);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœ€åä¸€ä¸ªè·¯å¾„å…ƒç´ ï¼Œå¾ªç¯æå‰ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span>(nameiparent &amp;&amp; *path == <span class="string">'\0'</span>)&#123;</span><br><span class="line">      <span class="comment">// Stop one level early. </span></span><br><span class="line">      iunlock(ip);</span><br><span class="line">      <span class="keyword">return</span> ip;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>((next = dirlookup(ip, name, <span class="number">0</span>)) == <span class="number">0</span>)&#123; <span class="comment">// å¯»æ‰¾è·¯å¾„å…ƒç´ å¤±è´¥ï¼ŒæŸ¥æ‰¾å¤±è´¥</span></span><br><span class="line">      iunlockput(ip);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    iunlockput(ip);</span><br><span class="line">    ip = next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(nameiparent)&#123;</span><br><span class="line">    iput(ip);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ip;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>skipelem å°†è·¯å¾„ä¸­çš„ä¸‹ä¸€ä¸ªè·¯å¾„å…ƒç´ å¤åˆ¶åˆ°åç§°ä¸­ï¼Œè¿”å›æŒ‡å‘å¤åˆ¶åçš„å…ƒç´ çš„æŒ‡é’ˆã€‚</li><li>namei è§£æpathå¹¶è¿”å›å¯¹åº”çš„inodeã€‚</li><li>nameiparent è¿”å›ä¸Šçº§ç›®å½•çš„ièŠ‚ç‚¹å¹¶ä¸”æŠŠæœ€åä¸€ä¸ªå…ƒç´ æ‹·è´åˆ°nameä¸­ã€‚</li></ul><p><em>å‡½æ•°çš„è¯¦ç»†å†…å®¹ä½äº<code>fs.c</code></em></p><h3 id="æ–‡ä»¶æè¿°ç¬¦å±‚"><a href="#æ–‡ä»¶æè¿°ç¬¦å±‚" class="headerlink" title="æ–‡ä»¶æè¿°ç¬¦å±‚"></a>æ–‡ä»¶æè¿°ç¬¦å±‚</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">file</span> &#123;</span></span><br><span class="line">  <span class="keyword">enum</span> &#123; FD_NONE, FD_PIPE, FD_INODE &#125; type; <span class="comment">// æ–‡ä»¶åˆ†ä¸ºç®¡é“æ–‡ä»¶å’Œæ™®é€šæ–‡ä»¶ç­‰ï¼ŒFD_NONEè¡¨ç¤ºæ–‡ä»¶æœªä½¿ç”¨</span></span><br><span class="line">  <span class="keyword">int</span> ref; <span class="comment">// reference count å¼•ç”¨è®¡æ•°</span></span><br><span class="line">  <span class="keyword">char</span> readable; <span class="comment">// å¯è¯»</span></span><br><span class="line">  <span class="keyword">char</span> writable; <span class="comment">// å¯å†™</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">pipe</span> *<span class="title">pipe</span>;</span> <span class="comment">// ç®¡é“</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode</span> *<span class="title">ip</span>;</span> <span class="comment">// æŒ‡å‘ièŠ‚ç‚¹</span></span><br><span class="line">  uint off;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>xv6ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„æ‰“å¼€æ–‡ä»¶è¡¨ã€‚æ¯ä¸ªæ‰“å¼€æ–‡ä»¶å‡ç”±ä¸Šé¢çš„ç»“æ„ä½“è¡¨ç¤ºï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹ièŠ‚ç‚¹æˆ–è€…ç®¡é“å’Œæ–‡ä»¶åç§»çš„å°è£…ã€‚æ¯æ¬¡è°ƒç”¨<code>open</code>éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„fileç»“æ„ä½“ã€‚</p><p>å¦‚æœå¤šä¸ªè¿›ç¨‹ç›¸äº’ç‹¬ç«‹åœ°æ‰“å¼€äº†åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¸åŒçš„å®ä¾‹å°†æ‹¥æœ‰ä¸åŒçš„I/Oåç§»ã€‚è€Œä¸”åŒä¸€ä¸ªfileç»“æ„ä½“å¯ä»¥åœ¨ä¸€ä¸ªè¿›ç¨‹çš„æ–‡ä»¶è¡¨ä¸­å¤šæ¬¡å‡ºç°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨å¤šä¸ªè¿›ç¨‹çš„æ–‡ä»¶è¡¨ä¸­å‡ºç°ã€‚å¯¹æ¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥è¢«æ‰“å¼€ç”¨äºè¯»ã€å†™æˆ–è€…äºŒè€…ã€‚</p><p>ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ‰“å¼€æ–‡ä»¶éƒ½å­˜åœ¨äºä¸€ä¸ªå…¨å±€çš„æ–‡ä»¶è¡¨<code>ftable</code>ä¸­ã€‚</p><h4 id="å‡½æ•°-2"><a href="#å‡½æ•°-2" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><p>è¯¥å±‚çš„å‡½æ•°ä½äº<code>file.c</code>ï¼Œè¯¦ç»†æ³¨é‡Šè§ä»£ç æ–‡ä»¶ã€‚</p><ul><li>filealloc åˆ†é…æ–‡ä»¶ï¼Œæ‰«ææ•´ä¸ªæ–‡ä»¶è¡¨å¯»æ‰¾æ²¡æœ‰è¢«å¼•ç”¨çš„æ–‡ä»¶å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å¼•ç”¨ã€‚</li><li>filedup é‡å¤å¼•ç”¨æ–‡ä»¶ï¼Œå¢åŠ å¼•ç”¨è®¡æ•°ã€‚</li><li>fileclose é‡Šæ”¾å¯¹æ–‡ä»¶å¼•ç”¨çš„å‡½æ•°ï¼Œå‡å°‘å¼•ç”¨è®¡æ•°ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶çš„å¼•ç”¨è®¡æ•°å˜ä¸º0çš„æ—¶å€™ï¼Œæ ¹æ®æ–‡ä»¶ç±»å‹çš„ä¸åŒ,é‡Šæ”¾æ‰å½“å‰çš„ç®¡é“æˆ–è€…ièŠ‚ç‚¹ã€‚</li><li>fileread è¯»æ–‡ä»¶ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>read</code>æ“ä½œ</li><li>filewrite å†™æ–‡ä»¶ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>write</code>æ“ä½œã€‚</li><li>filestat è·å–æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œå®ç°å¯¹æ–‡ä»¶çš„<code>stat</code>æ“ä½œï¼ˆåªå…è®¸ä½œç”¨åœ¨inodeï¼‰ã€‚</li></ul><h3 id="ç³»ç»Ÿè°ƒç”¨"><a href="#ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨"></a>ç³»ç»Ÿè°ƒç”¨</h3><p>æš‚æ— å†…å®¹ã€‚</p><h2 id="æ–‡ä»¶ç³»ç»Ÿä¸­xv6å¯æ”¹è¿›ä¹‹å¤„"><a href="#æ–‡ä»¶ç³»ç»Ÿä¸­xv6å¯æ”¹è¿›ä¹‹å¤„" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿä¸­xv6å¯æ”¹è¿›ä¹‹å¤„"></a>æ–‡ä»¶ç³»ç»Ÿä¸­xv6å¯æ”¹è¿›ä¹‹å¤„</h2><h3 id="cache"><a href="#cache" class="headerlink" title="cache"></a>cache</h3><ol><li>ä½¿ç”¨çš„æ›¿æ¢ç­–ç•¥ä¸ºLRUï¼Œç®—æ³•è¾ƒä¸ºç®€å•ã€‚</li><li>é“¾è¡¨çš„ä½¿ç”¨è™½ç„¶å®ç°ç®€å•ï¼Œä½†æŸ¥æ‰¾æ•ˆç‡ä½ï¼Œæ—¶é—´å¤æ‚åº¦é«˜ã€‚è‹¥èƒ½ä½¿ç”¨å“ˆå¸Œè¡¨ç­‰å®ç°æŸ¥æ‰¾å¯æé«˜æ•ˆç‡ã€‚</li></ol><h3 id="ç›®å½•æŸ¥æ‰¾"><a href="#ç›®å½•æŸ¥æ‰¾" class="headerlink" title="ç›®å½•æŸ¥æ‰¾"></a>ç›®å½•æŸ¥æ‰¾</h3><p>ç›®å½•æŸ¥æ‰¾ä¸ºçº¿æ€§æŸ¥æ‰¾ï¼Œåœ¨ç›®å½•æ•°é‡è¾ƒå¤šçš„æƒ…å†µä¸‹è€—æ—¶å·¨å¤§ã€‚è‹¥èƒ½ä½¿ç”¨æ ‘ç­‰ç»“æ„ï¼Œä¾¿èƒ½å¤§å¤§å‡å°æ—¶é—´å¤æ‚åº¦ã€‚</p><h3 id="å¤§å°å›ºå®š"><a href="#å¤§å°å›ºå®š" class="headerlink" title="å¤§å°å›ºå®š"></a>å¤§å°å›ºå®š</h3><p>æ–‡ä»¶ç³»ç»Ÿçš„å¤§å°åœ¨xv6ä¸­æ˜¯ä¸æ”¹å˜çš„ï¼Œå›ºå®šåœ¨ä¸€ä¸ªç£ç›˜è®¾å¤‡ä¸Šã€‚è¿™ä¸€ç‚¹å¯¹äºä¸ªäººPCå½±å“ä¸å¤§ï¼Œä½†åœ¨éœ€è¦å­˜å‚¨å¤§é‡æ–‡ä»¶æˆ–è¶…å¤§æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œä¾¿æœ‰äº›æ‰è¥Ÿè§è‚˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      xv6æ“ä½œç³»ç»Ÿä¹‹æ–‡ä»¶ç³»ç»Ÿæºç é˜…è¯»ä¸åˆ†æ
    
    </summary>
    
      <category term="æ“ä½œç³»ç»Ÿ" scheme="http://rootreturn0.github.io/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="å­¦ä¹ " scheme="http://rootreturn0.github.io/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>GG</title>
    <link href="http://rootreturn0.github.io/2019/08/27/GG/"/>
    <id>http://rootreturn0.github.io/2019/08/27/GG/</id>
    <published>2019-08-26T18:12:49.000Z</published>
    <updated>2019-10-18T17:10:25.516Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚">    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      What is that?
    
    </summary>
    
      <category term="Me" scheme="http://rootreturn0.github.io/categories/Me/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>ä¸–ç•Œ</title>
    <link href="http://rootreturn0.github.io/2019/08/06/HK/"/>
    <id>http://rootreturn0.github.io/2019/08/06/HK/</id>
    <published>2019-08-06T10:41:51.000Z</published>
    <updated>2019-10-18T17:11:47.476Z</updated>
    
    <content type="html"><![CDATA[<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="è¯·è¾“å…¥å¯†ç ã€‚">    <label for="pass">è¯·è¾“å…¥å¯†ç ã€‚</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      å¼±åŠ¿ç¾¤ä½“çš„å’Œå¹³æŠ—äº‰
    
    </summary>
    
      <category term="Thinking" scheme="http://rootreturn0.github.io/categories/Thinking/"/>
    
    
      <category term="éšç¬”" scheme="http://rootreturn0.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>å»ºç«™åˆå§‹æ—¥å¿—</title>
    <link href="http://rootreturn0.github.io/2019/07/26/%E5%BB%BA%E7%AB%99%E5%88%9D%E5%A7%8B%E6%97%A5%E5%BF%97/"/>
    <id>http://rootreturn0.github.io/2019/07/26/å»ºç«™åˆå§‹æ—¥å¿—/</id>
    <published>2019-07-26T06:00:02.000Z</published>
    <updated>2019-10-18T17:48:45.597Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸»é¢˜Next"><a href="#ä¸»é¢˜Next" class="headerlink" title="ä¸»é¢˜Next"></a>ä¸»é¢˜Next</h1><p>ä¸€å¼€å§‹é€‰ç”¨çš„æ˜¯<a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">Yilia</a>,ä½†ç”±äº<a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">Yilia</a>å¼€å‘ä½¿ç”¨çš„webpackç‰ˆæœ¬è¾ƒè€ï¼Œå®šåˆ¶æ—¶æ˜“è¸©å‘ï¼Œæ•…æ”¹ç”¨<a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">Next</a>ã€‚æœ¬æ–‡æ ¹æ®å®˜æ–¹æ–‡æ¡£æ•´ç†ï¼Œå¹¶æ ¹æ®è‡ªå·±å–œå¥½åŠ å…¥äº†ä¸€äº›ç¬¬ä¸‰æ–¹æ’ä»¶å’Œä¿®æ”¹ã€‚æ‰€æœ‰ä¿®æ”¹å°†ä¼šé€æ­¥ç»™å‡ºï¼ŒNextçš„é…ç½®å®Œæ•´è¯´æ˜å¯å‚ç…§<a href="http://theme-next.iissnan.com" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><a id="more"></a><h2 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><h3 id="å¯ç”¨"><a href="#å¯ç”¨" class="headerlink" title="å¯ç”¨"></a>å¯ç”¨</h3><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ›´æ”¹ <code>theme</code> ä¸º <code>next</code> ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br></pre></td></tr></table></figure><h3 id="é€‰æ‹©Scheme"><a href="#é€‰æ‹©Scheme" class="headerlink" title="é€‰æ‹©Scheme"></a>é€‰æ‹©Scheme</h3><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œé€‰æ‹© <code>Muse</code> ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br></pre></td></tr></table></figure><h3 id="åˆ‡æ¢è¯­è¨€"><a href="#åˆ‡æ¢è¯­è¨€" class="headerlink" title="åˆ‡æ¢è¯­è¨€"></a>åˆ‡æ¢è¯­è¨€</h3><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,è®¾ç½® <code>language</code> ä¸º <code>zh-Hans</code> ã€‚</p><h2 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h2><h3 id="ä¸»é¡µæ–‡ç« é˜´å½±æ•ˆæœ"><a href="#ä¸»é¡µæ–‡ç« é˜´å½±æ•ˆæœ" class="headerlink" title="ä¸»é¡µæ–‡ç« é˜´å½±æ•ˆæœ"></a>ä¸»é¡µæ–‡ç« é˜´å½±æ•ˆæœ</h3><p>æ‰“å¼€ <code>themes/next/source/css/_custom/custom.styl</code> ,å¢åŠ </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// ä¸»é¡µæ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ</span><br><span class="line"> <span class="selector-class">.post</span> &#123;</span><br><span class="line">   <span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line">   <span class="attribute">margin-bottom</span>: <span class="number">60px</span>;</span><br><span class="line">   <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">   <span class="attribute">-webkit-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 203, .5);</span><br><span class="line">   <span class="attribute">-moz-box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(202, 203, 204, .5);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ ‡ç­¾"><a href="#ä¿®æ”¹æ ‡ç­¾" class="headerlink" title="ä¿®æ”¹æ ‡ç­¾"></a>ä¿®æ”¹æ ‡ç­¾</h3><p>æ‰“å¼€ <code>themes/next/layout/_macro/post.swig</code> ï¼Œæœç´¢ <code>rel=&quot;tag&quot;&gt;#</code>ï¼Œå°† <code>#</code> æ¢æˆ <code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code> ã€‚</p><h3 id="åŠ¨æ€èƒŒæ™¯"><a href="#åŠ¨æ€èƒŒæ™¯" class="headerlink" title="åŠ¨æ€èƒŒæ™¯"></a>åŠ¨æ€èƒŒæ™¯</h3><p>æ‰“å¼€ <code>theme/next/layout/_layout.swig</code> ï¼Œåœ¨ &lt; /body&gt;ä¹‹å‰æ·»åŠ ä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.canvas_nest %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,å°† <code>canvas_next</code> ç½®ä¸º <code>true</code> ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">canvas_nest:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="çœ‹æ¿ç‹—"><a href="#çœ‹æ¿ç‹—" class="headerlink" title="çœ‹æ¿ç‹—"></a>çœ‹æ¿ç‹—</h3><p>å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-helper-live2d --save</span><br><span class="line">npm install live2d-widget-model-wanko</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,å¢åŠ ä»¥ä¸‹ä»£ç ã€‚å…¶ä¸­å¯¹ <code>display</code> éƒ¨åˆ†åšäº†ä¿®æ”¹ï¼Œä»¥é€‚åº”ç½‘é¡µå¸ƒå±€ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line"><span class="attr">live2d:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># enable: false</span></span><br><span class="line"><span class="attr">  scriptFrom:</span> <span class="string">local</span> <span class="comment"># é»˜è®¤</span></span><br><span class="line"><span class="attr">  pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># æ’ä»¶åœ¨ç«™ç‚¹ä¸Šçš„æ ¹ç›®å½•(ç›¸å¯¹è·¯å¾„)</span></span><br><span class="line"><span class="attr">  pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># è„šæœ¬æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line"><span class="attr">  pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># æ¨¡å‹æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="comment"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line"><span class="attr">  tagMode:</span> <span class="literal">false</span> <span class="comment"># æ ‡ç­¾æ¨¡å¼, æ˜¯å¦ä»…æ›¿æ¢ live2d tagæ ‡ç­¾è€Œéæ’å…¥åˆ°æ‰€æœ‰é¡µé¢ä¸­</span></span><br><span class="line"><span class="attr">  debug:</span> <span class="literal">false</span> <span class="comment"># è°ƒè¯•, æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—</span></span><br><span class="line"><span class="attr">  model:</span></span><br><span class="line"><span class="attr">    use:</span> <span class="string">live2d-widget-model-wanko</span> <span class="comment"># npm-module package name</span></span><br><span class="line">    <span class="comment"># use: wanko # åšå®¢æ ¹ç›®å½•/live2d_models/ ä¸‹çš„ç›®å½•å</span></span><br><span class="line">    <span class="comment"># use: ./wives/wanko # ç›¸å¯¹äºåšå®¢æ ¹ç›®å½•çš„è·¯å¾„</span></span><br><span class="line">    <span class="comment"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # ä½ çš„è‡ªå®šä¹‰ url</span></span><br><span class="line"><span class="attr">  display:</span></span><br><span class="line"><span class="attr">    position:</span> <span class="string">right</span></span><br><span class="line"><span class="attr">    width:</span> <span class="number">200</span></span><br><span class="line"><span class="attr">    height:</span> <span class="number">400</span></span><br><span class="line">    <span class="comment"># æ°´å¹³ä½ç½®</span></span><br><span class="line"><span class="attr">    hOffset:</span> <span class="number">40</span></span><br><span class="line">    <span class="comment"># å‚ç›´ä½ç½®</span></span><br><span class="line"><span class="attr">    vOffset:</span> <span class="bullet">-80</span></span><br><span class="line"><span class="attr">  mobile:</span></span><br><span class="line"><span class="attr">    show:</span> <span class="literal">true</span> <span class="comment"># æ‰‹æœºä¸­æ˜¯å¦å±•ç¤º</span></span><br></pre></td></tr></table></figure><h3 id="Github-Corners"><a href="#Github-Corners" class="headerlink" title="Github Corners"></a>Github Corners</h3><p>æ‰“å¼€<a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">Github Corners</a>,å¤åˆ¶ä»£ç å¹¶ç²˜è´´ä»£ç åˆ° <code>themes/next/layout/_layout.swig</code> æ–‡ä»¶ä¸­(æ”¾åœ¨ <code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code> çš„ä¸‹é¢)ï¼Œå¹¶æŠŠ <code>href</code> æ”¹ä¸ºæ­£ç¡®çš„githubåœ°å€ã€‚</p><p>ç”±äºæ¯”è¾ƒå–œæ¬¢è¿™ä¸ªå°å®¶ä¼™ä¸€ç›´å‡ºç°ï¼Œæ•…æ›´æ”¹ä»£ç ä¸­çš„ <code>position: absolute</code> ä¸º <code>position: fixed</code> ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"headband"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;a href=<span class="string">"https://github.com/RootReturn0"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"github-corner"</span> aria-label=<span class="string">"View source on GitHub"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"80"</span> <span class="attr">height</span>=<span class="string">"80"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 250 250"</span> <span class="attr">style</span>=<span class="string">"fill:#151513; color:#fff; position: fixed; top: 0; border: 0; right: 0;"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"</span> <span class="attr">fill</span>=<span class="string">"currentColor"</span> <span class="attr">style</span>=<span class="string">"transform-origin: 130px 106px;"</span> <span class="attr">class</span>=<span class="string">"octo-arm"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"</span> <span class="attr">fill</span>=<span class="string">"currentColor"</span> <span class="attr">class</span>=<span class="string">"octo-body"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;@<span class="keyword">keyframes</span> octocat-wave&#123;0%,100%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(0)&#125;20%,60%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(-25deg)&#125;40%,80%&#123;<span class="attribute">transform</span>:<span class="built_in">rotate</span>(10deg)&#125;&#125;@<span class="keyword">media</span> (max-width:<span class="number">500px</span>)&#123;<span class="selector-class">.github-corner</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:none&#125;<span class="selector-class">.github-corner</span> <span class="selector-class">.octo-arm</span>&#123;<span class="attribute">animation</span>:octocat-wave <span class="number">560ms</span> ease-in-out&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="RSS"><a href="#RSS" class="headerlink" title="RSS"></a>RSS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">npm install hexo-generator-feed --save</span><br></pre></td></tr></table></figure><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ·»åŠ </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: http://hexo.io/plugins/</span></span><br><span class="line"><span class="attr">plugins:</span> <span class="string">hexo-generate-feed</span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€ <code>theme/next</code> ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,åœ¨ <code>rss</code> åæ·»åŠ  <code>/atom.xml</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Set rss to false to disable feed link.</span></span><br><span class="line"><span class="comment"># Leave rss as empty to use site's feed link.</span></span><br><span class="line"><span class="comment"># Set rss to specific value if you have burned your feed already.</span></span><br><span class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span></span><br></pre></td></tr></table></figure><h2 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h2><p>æœ‰æ—¶å†™åšå®¢å¹¶ä¸å¸Œæœ›è®©æ‰€æœ‰äººçœ‹åˆ°ï¼Œæ•…åŠ å…¥äº†åŠ å¯†åŠŸèƒ½ã€‚Hexoæ˜¯ä¸€ä¸ªé™æ€åšå®¢ï¼Œè‡ªå·±å†™ä¸€ä¸ªjsè¿›è¡ŒåŠ å¯†è™½ä¸å›°éš¾ï¼Œä½†æ ·å¼å®åœ¨ä¸å¯æ­ç»´ã€‚è¿™é‡Œé‡‡ç”¨å¤§ç¥åšå‡ºçš„<a href="https://github.com/MikeCoder/hexo-blog-encrypt/blob/master/ReadMe.zh.md" target="_blank" rel="noopener">hexo-blog-encrypt</a>è¿›è¡ŒåŠ å¯†ã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> åšå®¢æ ¹ç›®å½•</span><br><span class="line">npm install hexo-blog-encrypt --save</span><br></pre></td></tr></table></figure><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><h4 id="æ ¹æœ¬é…ç½®"><a href="#æ ¹æœ¬é…ç½®" class="headerlink" title="æ ¹æœ¬é…ç½®"></a>æ ¹æœ¬é…ç½®</h4><p>æ‰“å¼€æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶,æ·»åŠ </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">encrypt:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h4><p>ç„¶ååœ¨blogçš„å¤´éƒ¨æ·»åŠ ä¸Šå¯¹åº”çš„å­—æ®µï¼Œå¦‚password, abstract, messageã€‚</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ–‡ç« åŠ å¯†</span><br><span class="line">date: 2019-08-06 19:00:02</span><br><span class="line">password: ä½ çš„å¯†ç </span><br><span class="line">abstract: æ˜¾ç¤ºåœ¨ç›®å½•é¡µæˆ–é¦–é¡µçš„å†…å®¹ç®€ä»‹ã€‚</span><br><span class="line">message:  æ­¤å¤„ä¸ºè¾“å…¥å¯†ç æ—¶çš„æç¤ºå†…å®¹ã€‚</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h4 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h4><p>å¸Œæœ›ä¿®æ”¹é»˜è®¤çš„æç¤ºå’Œæ‘˜è¦å†…å®¹æ—¶ï¼Œä½ å¯ä»¥æ·»åŠ å¦‚ä¸‹é…ç½®åœ¨æ ¹ç›®å½•ä¸­çš„ <code>_config.yml</code> æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">encrypt:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  default_abstract:</span> <span class="string">è¿™æ˜¯ä¸€ç¯‡åŠ å¯†æ–‡ç« ï¼Œå†…å®¹å¯èƒ½æ˜¯xxx</span></span><br><span class="line"><span class="attr">  default_message:</span> <span class="string">è¾“å…¥å¯†ç ï¼ŒæŸ¥çœ‹æ–‡ç« ã€‚</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸»é¢˜Next&quot;&gt;&lt;a href=&quot;#ä¸»é¢˜Next&quot; class=&quot;headerlink&quot; title=&quot;ä¸»é¢˜Next&quot;&gt;&lt;/a&gt;ä¸»é¢˜Next&lt;/h1&gt;&lt;p&gt;ä¸€å¼€å§‹é€‰ç”¨çš„æ˜¯&lt;a href=&quot;https://github.com/litten/hexo-theme-yilia&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Yilia&lt;/a&gt;,ä½†ç”±äº&lt;a href=&quot;https://github.com/litten/hexo-theme-yilia&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Yilia&lt;/a&gt;å¼€å‘ä½¿ç”¨çš„webpackç‰ˆæœ¬è¾ƒè€ï¼Œå®šåˆ¶æ—¶æ˜“è¸©å‘ï¼Œæ•…æ”¹ç”¨&lt;a href=&quot;https://github.com/iissnan/hexo-theme-next&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Next&lt;/a&gt;ã€‚æœ¬æ–‡æ ¹æ®å®˜æ–¹æ–‡æ¡£æ•´ç†ï¼Œå¹¶æ ¹æ®è‡ªå·±å–œå¥½åŠ å…¥äº†ä¸€äº›ç¬¬ä¸‰æ–¹æ’ä»¶å’Œä¿®æ”¹ã€‚æ‰€æœ‰ä¿®æ”¹å°†ä¼šé€æ­¥ç»™å‡ºï¼ŒNextçš„é…ç½®å®Œæ•´è¯´æ˜å¯å‚ç…§&lt;a href=&quot;http://theme-next.iissnan.com&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="å»ºç«™æ—¥å¿—" scheme="http://rootreturn0.github.io/categories/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="æ—¥å¿—" scheme="http://rootreturn0.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>hello world</title>
    <link href="http://rootreturn0.github.io/2019/07/25/hello-world/"/>
    <id>http://rootreturn0.github.io/2019/07/25/hello-world/</id>
    <published>2019-07-25T12:43:01.000Z</published>
    <updated>2019-07-26T14:28:49.946Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"Hello world!"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    <span class="title">print</span><span class="params">(<span class="string">'Hello world!'</span>)</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
      
    
    </summary>
    
    
  </entry>
  
</feed>
